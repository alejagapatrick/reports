<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - total_coverage.info - src/wallet/rpcdump.cpp</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">src/wallet</a> - rpcdump.cpp<span style="font-size: 80%;"> (source / <a href="rpcdump.cpp.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">total_coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">756</td>
            <td class="headerCovTableEntry">844</td>
            <td class="headerCovTableEntryMed">89.6 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2000-01-01 12:00:00</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">22</td>
            <td class="headerCovTableEntry">22</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">2862</td>
            <td class="headerCovTableEntry">6924</td>
            <td class="headerCovTableEntryLo">41.3 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : // Copyright (c) 2009-2019 The Bitcoin Core developers</a>
<a name="2"><span class="lineNum">       2 </span>                :            : // Distributed under the MIT software license, see the accompanying</a>
<a name="3"><span class="lineNum">       3 </span>                :            : // file COPYING or http://www.opensource.org/licenses/mit-license.php.</a>
<a name="4"><span class="lineNum">       4 </span>                :            : </a>
<a name="5"><span class="lineNum">       5 </span>                :            : #include &lt;chain.h&gt;</a>
<a name="6"><span class="lineNum">       6 </span>                :            : #include &lt;core_io.h&gt;</a>
<a name="7"><span class="lineNum">       7 </span>                :            : #include &lt;interfaces/chain.h&gt;</a>
<a name="8"><span class="lineNum">       8 </span>                :            : #include &lt;key_io.h&gt;</a>
<a name="9"><span class="lineNum">       9 </span>                :            : #include &lt;merkleblock.h&gt;</a>
<a name="10"><span class="lineNum">      10 </span>                :            : #include &lt;rpc/server.h&gt;</a>
<a name="11"><span class="lineNum">      11 </span>                :            : #include &lt;rpc/util.h&gt;</a>
<a name="12"><span class="lineNum">      12 </span>                :            : #include &lt;script/descriptor.h&gt;</a>
<a name="13"><span class="lineNum">      13 </span>                :            : #include &lt;script/script.h&gt;</a>
<a name="14"><span class="lineNum">      14 </span>                :            : #include &lt;script/standard.h&gt;</a>
<a name="15"><span class="lineNum">      15 </span>                :            : #include &lt;sync.h&gt;</a>
<a name="16"><span class="lineNum">      16 </span>                :            : #include &lt;util/bip32.h&gt;</a>
<a name="17"><span class="lineNum">      17 </span>                :            : #include &lt;util/system.h&gt;</a>
<a name="18"><span class="lineNum">      18 </span>                :            : #include &lt;util/time.h&gt;</a>
<a name="19"><span class="lineNum">      19 </span>                :            : #include &lt;wallet/wallet.h&gt;</a>
<a name="20"><span class="lineNum">      20 </span>                :            : </a>
<a name="21"><span class="lineNum">      21 </span>                :            : #include &lt;wallet/rpcwallet.h&gt;</a>
<a name="22"><span class="lineNum">      22 </span>                :            : </a>
<a name="23"><span class="lineNum">      23 </span>                :            : #include &lt;stdint.h&gt;</a>
<a name="24"><span class="lineNum">      24 </span>                :            : #include &lt;tuple&gt;</a>
<a name="25"><span class="lineNum">      25 </span>                :            : </a>
<a name="26"><span class="lineNum">      26 </span>                :            : #include &lt;boost/algorithm/string.hpp&gt;</a>
<a name="27"><span class="lineNum">      27 </span>                :            : #include &lt;boost/date_time/posix_time/posix_time.hpp&gt;</a>
<a name="28"><span class="lineNum">      28 </span>                :            : </a>
<a name="29"><span class="lineNum">      29 </span>                :            : #include &lt;univalue.h&gt;</a>
<a name="30"><span class="lineNum">      30 </span>                :            : </a>
<a name="31"><span class="lineNum">      31 </span>                :            : </a>
<a name="32"><span class="lineNum">      32 </span>                :<span class="lineCov">       1687 : int64_t static DecodeDumpTime(const std::string &amp;str) {</span></a>
<a name="33"><span class="lineNum">      33 </span>[<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchCov" title="Branch 1 was taken 1682 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       1687 :     static const boost::posix_time::ptime epoch = boost::posix_time::from_time_t(0);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 6 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="34"><span class="lineNum">      34 </span>                :<span class="lineCov">       1687 :     static const std::locale loc(std::locale::classic(),</span></a>
<a name="35"><span class="lineNum">      35 </span>[<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchCov" title="Branch 1 was taken 1682 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       1687 :         new boost::posix_time::time_input_facet(&quot;%Y-%m-%dT%H:%M:%SZ&quot;));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 25 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>][<span class="branchNoExec" title="Branch 28 was not executed"> # </span><span class="branchNoExec" title="Branch 29 was not executed"> # </span>]
<a name="36"><span class="lineNum">      36 </span>                :<span class="lineCov">       3374 :     std::istringstream iss(str);</span></a>
<a name="37"><span class="lineNum">      37 </span>        [<span class="branchCov" title="Branch 1 was taken 1687 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">       1687 :     iss.imbue(loc);</span></a>
<a name="38"><span class="lineNum">      38 </span>        [<span class="branchCov" title="Branch 1 was taken 1687 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">       1687 :     boost::posix_time::ptime ptime(boost::date_time::not_a_date_time);</span></a>
<a name="39"><span class="lineNum">      39 </span>        [<span class="branchCov" title="Branch 1 was taken 1687 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">       1687 :     iss &gt;&gt; ptime;</span></a>
<a name="40"><span class="lineNum">      40 </span>[<span class="branchCov" title="Branch 0 was taken 843 times"> + </span><span class="branchCov" title="Branch 1 was taken 844 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 843 times"> + </span><span class="branchCov" title="Branch 3 was taken 844 times"> + </span>]:<span class="lineCov">       3374 :     if (ptime.is_not_a_date_time())</span></a>
<a name="41"><span class="lineNum">      41 </span>                :            :         return 0;</a>
<a name="42"><span class="lineNum">      42 </span>                :<span class="lineCov">        843 :     return (ptime - epoch).total_seconds();</span></a>
<a name="43"><span class="lineNum">      43 </span>                :            : }</a>
<a name="44"><span class="lineNum">      44 </span>                :            : </a>
<a name="45"><span class="lineNum">      45 </span>                :<span class="lineCov">         84 : std::string static EncodeDumpString(const std::string &amp;str) {</span></a>
<a name="46"><span class="lineNum">      46 </span>                :<span class="lineCov">         84 :     std::stringstream ret;</span></a>
<a name="47"><span class="lineNum">      47 </span>[<span class="branchCov" title="Branch 0 was taken 72 times"> + </span><span class="branchCov" title="Branch 1 was taken 84 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 72 times"> + </span><span class="branchCov" title="Branch 3 was taken 84 times"> + </span>]:<span class="lineCov">        324 :     for (const unsigned char c : str) {</span></a>
<a name="48"><span class="lineNum">      48 </span>[<span class="branchCov" title="Branch 0 was taken 72 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 72 times"> + </span>]:<span class="lineCov">         72 :         if (c &lt;= 32 || c &gt;= 128 || c == '%') {</span></a>
<a name="49"><span class="lineNum">      49 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineNoCov">          0 :             ret &lt;&lt; '%' &lt;&lt; HexStr(&amp;c, &amp;c + 1);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 9 was not executed"> # </span><span class="branchNoExec" title="Branch 10 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>]
<a name="50"><span class="lineNum">      50 </span>                :            :         } else {</a>
<a name="51"><span class="lineNum">      51 </span>        [<span class="branchCov" title="Branch 1 was taken 72 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         72 :             ret &lt;&lt; c;</span></a>
<a name="52"><span class="lineNum">      52 </span>                :            :         }</a>
<a name="53"><span class="lineNum">      53 </span>                :            :     }</a>
<a name="54"><span class="lineNum">      54 </span>        [<span class="branchCov" title="Branch 1 was taken 84 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         84 :     return ret.str();</span></a>
<a name="55"><span class="lineNum">      55 </span>                :            : }</a>
<a name="56"><span class="lineNum">      56 </span>                :            : </a>
<a name="57"><span class="lineNum">      57 </span>                :<span class="lineCov">         48 : static std::string DecodeDumpString(const std::string &amp;str) {</span></a>
<a name="58"><span class="lineNum">      58 </span>                :<span class="lineNoCov">          0 :     std::stringstream ret;</span></a>
<a name="59"><span class="lineNum">      59 </span>[<span class="branchCov" title="Branch 1 was taken 24 times"> + </span><span class="branchCov" title="Branch 2 was taken 48 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 24 times"> + </span><span class="branchCov" title="Branch 4 was taken 48 times"> + </span>]:<span class="lineCov">         96 :     for (unsigned int pos = 0; pos &lt; str.length(); pos++) {</span></a>
<a name="60"><span class="lineNum">      60 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 24 times"> + </span>]:<span class="lineCov">         24 :         unsigned char c = str[pos];</span></a>
<a name="61"><span class="lineNum">      61 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 24 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">         24 :         if (c == '%' &amp;&amp; pos+2 &lt; str.length()) {</span></a>
<a name="62"><span class="lineNum">      62 </span>                :<span class="lineNoCov">          0 :             c = (((str[pos+1]&gt;&gt;6)*9+((str[pos+1]-'0')&amp;15)) &lt;&lt; 4) |</span></a>
<a name="63"><span class="lineNum">      63 </span>                :<span class="lineNoCov">          0 :                 ((str[pos+2]&gt;&gt;6)*9+((str[pos+2]-'0')&amp;15));</span></a>
<a name="64"><span class="lineNum">      64 </span>                :<span class="lineNoCov">          0 :             pos += 2;</span></a>
<a name="65"><span class="lineNum">      65 </span>                :            :         }</a>
<a name="66"><span class="lineNum">      66 </span>        [<span class="branchCov" title="Branch 1 was taken 24 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         24 :         ret &lt;&lt; c;</span></a>
<a name="67"><span class="lineNum">      67 </span>                :            :     }</a>
<a name="68"><span class="lineNum">      68 </span>        [<span class="branchCov" title="Branch 1 was taken 48 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         48 :     return ret.str();</span></a>
<a name="69"><span class="lineNum">      69 </span>                :            : }</a>
<a name="70"><span class="lineNum">      70 </span>                :            : </a>
<a name="71"><span class="lineNum">      71 </span>                :<span class="lineCov">       1235 : static bool GetWalletAddressesForKey(CWallet* const pwallet, const CKeyID&amp; keyid, std::string&amp; strAddr, std::string&amp; strLabel) EXCLUSIVE_LOCKS_REQUIRED(pwallet-&gt;cs_wallet)</span></a>
<a name="72"><span class="lineNum">      72 </span>                :            : {</a>
<a name="73"><span class="lineNum">      73 </span>                :<span class="lineCov">       1235 :     bool fLabelFound = false;</span></a>
<a name="74"><span class="lineNum">      74 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineCov">       1235 :     CKey key;</span></a>
<a name="75"><span class="lineNum">      75 </span>        [<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">       1235 :     pwallet-&gt;GetKey(keyid, key);</span></a>
<a name="76"><span class="lineNum">      76 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       4940 :     for (const auto&amp; dest : GetAllDestinationsForKey(key.GetPubKey())) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 3705 times"> + </span><span class="branchCov" title="Branch 7 was taken 1235 times"> + </span>][<span class="branchCov" title="Branch 8 was taken 3705 times"> + </span><span class="branchCov" title="Branch 9 was taken 1235 times"> + </span>]
<a name="77"><span class="lineNum">      77 </span>                :<span class="lineCov">       3705 :         if (pwallet-&gt;mapAddressBook.count(dest)) {</span></a>
<a name="78"><span class="lineNum">      78 </span>[<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchCov" title="Branch 1 was taken 78 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 78 times"> + </span>]:<span class="lineCov">        168 :             if (!strAddr.empty()) {</span></a>
<a name="79"><span class="lineNum">      79 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :                 strAddr += &quot;,&quot;;</span></a>
<a name="80"><span class="lineNum">      80 </span>                :            :             }</a>
<a name="81"><span class="lineNum">      81 </span>[<span class="branchCov" title="Branch 1 was taken 84 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 84 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         84 :             strAddr += EncodeDestination(dest);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 84 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>]
<a name="82"><span class="lineNum">      82 </span>[<span class="branchCov" title="Branch 1 was taken 84 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 84 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         84 :             strLabel = EncodeDumpString(pwallet-&gt;mapAddressBook[dest].name);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 84 times"> + </span>]
<a name="83"><span class="lineNum">      83 </span>                :<span class="lineCov">         84 :             fLabelFound = true;</span></a>
<a name="84"><span class="lineNum">      84 </span>                :            :         }</a>
<a name="85"><span class="lineNum">      85 </span>                :            :     }</a>
<a name="86"><span class="lineNum">      86 </span>        [<span class="branchCov" title="Branch 0 was taken 1157 times"> + </span><span class="branchCov" title="Branch 1 was taken 78 times"> + </span>]:<span class="lineCov">       1235 :     if (!fLabelFound) {</span></a>
<a name="87"><span class="lineNum">      87 </span>[<span class="branchCov" title="Branch 1 was taken 1157 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1157 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1157 :         strAddr = EncodeDestination(GetDestinationForKey(key.GetPubKey(), pwallet-&gt;m_default_address_type));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 1157 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 10 was not taken"> - </span><span class="branchCov" title="Branch 11 was taken 1157 times"> + </span>]
<a name="88"><span class="lineNum">      88 </span>                :            :     }</a>
<a name="89"><span class="lineNum">      89 </span>        [<span class="branchCov" title="Branch 0 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2470 :     return fLabelFound;</span></a>
<a name="90"><span class="lineNum">      90 </span>                :            : }</a>
<a name="91"><span class="lineNum">      91 </span>                :            : </a>
<a name="92"><span class="lineNum">      92 </span>                :            : static const int64_t TIMESTAMP_MIN = 0;</a>
<a name="93"><span class="lineNum">      93 </span>                :            : </a>
<a name="94"><span class="lineNum">      94 </span>                :<span class="lineCov">        275 : static void RescanWallet(CWallet&amp; wallet, const WalletRescanReserver&amp; reserver, int64_t time_begin = TIMESTAMP_MIN, bool update = true)</span></a>
<a name="95"><span class="lineNum">      95 </span>                :            : {</a>
<a name="96"><span class="lineNum">      96 </span>                :<span class="lineCov">        275 :     int64_t scanned_time = wallet.RescanFromTime(time_begin, reserver, update);</span></a>
<a name="97"><span class="lineNum">      97 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 275 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 275 times"> + </span>]:<span class="lineCov">        550 :     if (wallet.IsAbortingRescan()) {</span></a>
<a name="98"><span class="lineNum">      98 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_MISC_ERROR, &quot;Rescan aborted by user.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="99"><span class="lineNum">      99 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 275 times"> + </span>]:<span class="lineCov">        275 :     } else if (scanned_time &gt; time_begin) {</span></a>
<a name="100"><span class="lineNum">     100 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Rescan was unable to fully rescan the blockchain. Some transactions may be missing.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="101"><span class="lineNum">     101 </span>                :            :     }</a>
<a name="102"><span class="lineNum">     102 </span>                :<span class="lineCov">        275 : }</span></a>
<a name="103"><span class="lineNum">     103 </span>                :            : </a>
<a name="104"><span class="lineNum">     104 </span>                :<span class="lineCov">        257 : UniValue importprivkey(const JSONRPCRequest&amp; request)</span></a>
<a name="105"><span class="lineNum">     105 </span>                :            : {</a>
<a name="106"><span class="lineNum">     106 </span>[<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        765 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="107"><span class="lineNum">     107 </span>        [<span class="branchCov" title="Branch 1 was taken 257 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        257 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="108"><span class="lineNum">     108 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 257 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 257 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        257 :     if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {</span></a>
<a name="109"><span class="lineNum">     109 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="110"><span class="lineNum">     110 </span>                :            :     }</a>
<a name="111"><span class="lineNum">     111 </span>                :            : </a>
<a name="112"><span class="lineNum">     112 </span>[<span class="branchCov" title="Branch 0 was taken 254 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 254 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        257 :     if (request.fHelp || request.params.size() &lt; 1 || request.params.size() &gt; 3)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 254 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 254 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 254 times"> + </span>]
<a name="113"><span class="lineNum">     113 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="114"><span class="lineNum">     114 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">         33 :             RPCHelpMan{&quot;importprivkey&quot;,</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 34 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>][<span class="branchCov" title="Branch 37 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 40 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>][<span class="branchCov" title="Branch 43 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 44 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 46 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span>][<span class="branchCov" title="Branch 49 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 50 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 52 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span>][<span class="branchCov" title="Branch 55 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 56 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 58 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span>][<span class="branchCov" title="Branch 61 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 62 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 64 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span>][<span class="branchCov" title="Branch 67 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 68 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 70 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span>][<span class="branchCov" title="Branch 73 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 74 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 76 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span>][<span class="branchCov" title="Branch 79 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 80 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 82 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span>][<span class="branchCov" title="Branch 85 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 86 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 88 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span>][<span class="branchCov" title="Branch 91 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 92 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 94 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span>][<span class="branchCov" title="Branch 97 was taken 9 times"> + </span><span class="branchCov" title="Branch 98 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 100 was not taken"> - </span><span class="branchCov" title="Branch 101 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 102 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 104 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span>][<span class="branchNoCov" title="Branch 108 was not taken"> - </span><span class="branchCov" title="Branch 109 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 112 was not taken"> - </span><span class="branchCov" title="Branch 113 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 114 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 115 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 116 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 117 was not taken"> - </span>][<span class="branchNoCov" title="Branch 120 was not taken"> - </span><span class="branchCov" title="Branch 121 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 124 was not taken"> - </span><span class="branchCov" title="Branch 125 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 126 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 127 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 128 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 129 was not taken"> - </span>][<span class="branchNoCov" title="Branch 132 was not taken"> - </span><span class="branchCov" title="Branch 133 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 134 was not taken"> - </span><span class="branchCov" title="Branch 135 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 136 was not taken"> - </span><span class="branchCov" title="Branch 137 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 138 was not taken"> - </span><span class="branchCov" title="Branch 139 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 140 was not taken"> - </span><span class="branchCov" title="Branch 141 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 145 was not executed"> # </span><span class="branchNoExec" title="Branch 146 was not executed"> # </span>][<span class="branchNoExec" title="Branch 148 was not executed"> # </span><span class="branchNoExec" title="Branch 149 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 150 was not executed"> # </span><span class="branchNoExec" title="Branch 151 was not executed"> # </span>][<span class="branchNoExec" title="Branch 152 was not executed"> # </span><span class="branchNoExec" title="Branch 153 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 156 was not executed"> # </span><span class="branchNoExec" title="Branch 157 was not executed"> # </span>][<span class="branchNoExec" title="Branch 159 was not executed"> # </span><span class="branchNoExec" title="Branch 160 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 161 was not executed"> # </span><span class="branchNoExec" title="Branch 162 was not executed"> # </span>][<span class="branchNoExec" title="Branch 163 was not executed"> # </span><span class="branchNoExec" title="Branch 164 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 167 was not executed"> # </span><span class="branchNoExec" title="Branch 168 was not executed"> # </span>][<span class="branchNoExec" title="Branch 170 was not executed"> # </span><span class="branchNoExec" title="Branch 171 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 172 was not executed"> # </span><span class="branchNoExec" title="Branch 173 was not executed"> # </span>][<span class="branchNoExec" title="Branch 174 was not executed"> # </span><span class="branchNoExec" title="Branch 175 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 178 was not executed"> # </span><span class="branchNoExec" title="Branch 179 was not executed"> # </span>][<span class="branchNoExec" title="Branch 180 was not executed"> # </span><span class="branchNoExec" title="Branch 181 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 182 was not executed"> # </span><span class="branchNoExec" title="Branch 183 was not executed"> # </span>][<span class="branchNoExec" title="Branch 184 was not executed"> # </span><span class="branchNoExec" title="Branch 185 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 186 was not executed"> # </span><span class="branchNoExec" title="Branch 187 was not executed"> # </span>][<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="115"><span class="lineNum">     115 </span>                :            :                 &quot;\nAdds a private key (as returned by dumpprivkey) to your wallet. Requires a new wallet backup.\n&quot;</a>
<a name="116"><span class="lineNum">     116 </span>                :            :                 &quot;Hint: use importmulti to import more than one private key.\n&quot;</a>
<a name="117"><span class="lineNum">     117 </span>                :            :             &quot;\nNote: This call can take over an hour to complete if rescan is true, during that time, other rpc calls\n&quot;</a>
<a name="118"><span class="lineNum">     118 </span>                :            :             &quot;may report that the imported key exists but related transactions are still missing, leading to temporarily incorrect/bogus balances and unspent outputs until rescan completes.\n&quot;</a>
<a name="119"><span class="lineNum">     119 </span>                :            :             &quot;Note: Use \&quot;getwalletinfo\&quot; to query the scanning progress.\n&quot;,</a>
<a name="120"><span class="lineNum">     120 </span>                :            :                 {</a>
<a name="121"><span class="lineNum">     121 </span>                :            :                     {&quot;privkey&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The private key (see dumpprivkey)&quot;},</a>
<a name="122"><span class="lineNum">     122 </span>                :            :                     {&quot;label&quot;, RPCArg::Type::STR, /* default */ &quot;current label if address exists, otherwise \&quot;\&quot;&quot;, &quot;An optional label&quot;},</a>
<a name="123"><span class="lineNum">     123 </span>                :            :                     {&quot;rescan&quot;, RPCArg::Type::BOOL, /* default */ &quot;true&quot;, &quot;Rescan the wallet for transactions&quot;},</a>
<a name="124"><span class="lineNum">     124 </span>                :            :                 },</a>
<a name="125"><span class="lineNum">     125 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :                 RPCResults{},</span></a>
<a name="126"><span class="lineNum">     126 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">          9 :                 RPCExamples{</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="127"><span class="lineNum">     127 </span>                :            :             &quot;\nDump a private key\n&quot;</a>
<a name="128"><span class="lineNum">     128 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :             + HelpExampleCli(&quot;dumpprivkey&quot;, &quot;\&quot;myaddress\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>][<span class="branchNoExec" title="Branch 33 was not executed"> # </span><span class="branchNoExec" title="Branch 34 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<a name="129"><span class="lineNum">     129 </span>                :            :             &quot;\nImport the private key with rescan\n&quot;</a>
<a name="130"><span class="lineNum">     130 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :             + HelpExampleCli(&quot;importprivkey&quot;, &quot;\&quot;mykey\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 33 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 34 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 47 was not executed"> # </span><span class="branchNoExec" title="Branch 48 was not executed"> # </span>]
<a name="131"><span class="lineNum">     131 </span>                :            :             &quot;\nImport using a label and without rescan\n&quot;</a>
<a name="132"><span class="lineNum">     132 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         21 :             + HelpExampleCli(&quot;importprivkey&quot;, &quot;\&quot;mykey\&quot; \&quot;testing\&quot; false&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 29 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 30 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>][<span class="branchCov" title="Branch 33 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 34 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 47 was not executed"> # </span><span class="branchNoExec" title="Branch 48 was not executed"> # </span>]
<a name="133"><span class="lineNum">     133 </span>                :            :             &quot;\nImport using default blank label and without rescan\n&quot;</a>
<a name="134"><span class="lineNum">     134 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         21 :             + HelpExampleCli(&quot;importprivkey&quot;, &quot;\&quot;mykey\&quot; \&quot;\&quot; false&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 29 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 30 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>][<span class="branchCov" title="Branch 33 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 34 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 47 was not executed"> # </span><span class="branchNoExec" title="Branch 48 was not executed"> # </span>]
<a name="135"><span class="lineNum">     135 </span>                :            :             &quot;\nAs a JSON-RPC call\n&quot;</a>
<a name="136"><span class="lineNum">     136 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         24 :             + HelpExampleRpc(&quot;importprivkey&quot;, &quot;\&quot;mykey\&quot;, \&quot;testing\&quot;, false&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchCov" title="Branch 21 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 26 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>][<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="137"><span class="lineNum">     137 </span>                :            :                 },</a>
<a name="138"><span class="lineNum">     138 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">         21 :             }.ToString());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="139"><span class="lineNum">     139 </span>                :            : </a>
<a name="140"><span class="lineNum">     140 </span>[<span class="branchCov" title="Branch 1 was taken 254 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 2 times"> + </span><span class="branchCov" title="Branch 4 was taken 252 times"> + </span>]:<span class="lineCov">        254 :     if (pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {</span></a>
<a name="141"><span class="lineNum">     141 </span>  [<span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          6 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Cannot import private keys to a wallet with private keys disabled&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="142"><span class="lineNum">     142 </span>                :            :     }</a>
<a name="143"><span class="lineNum">     143 </span>                :            : </a>
<a name="144"><span class="lineNum">     144 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 252 times"> + </span>]:<span class="lineCov">        504 :     WalletRescanReserver reserver(pwallet);</span></a>
<a name="145"><span class="lineNum">     145 </span>                :<span class="lineCov">        252 :     bool fRescan = true;</span></a>
<a name="146"><span class="lineNum">     146 </span>                :<span class="lineCov">        252 :     {</span></a>
<a name="147"><span class="lineNum">     147 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 252 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        254 :         auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="148"><span class="lineNum">     148 </span>[<span class="branchCov" title="Branch 1 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        505 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="149"><span class="lineNum">     149 </span>                :            : </a>
<a name="150"><span class="lineNum">     150 </span>        [<span class="branchCov" title="Branch 1 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        252 :         EnsureWalletIsUnlocked(pwallet);</span></a>
<a name="151"><span class="lineNum">     151 </span>                :            : </a>
<a name="152"><span class="lineNum">     152 </span>[<span class="branchCov" title="Branch 1 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        504 :         std::string strSecret = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1 time"> + </span>]
<a name="153"><span class="lineNum">     153 </span>[<span class="branchCov" title="Branch 1 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        756 :         std::string strLabel = &quot;&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 1 time"> + </span>]
<a name="154"><span class="lineNum">     154 </span>[<span class="branchCov" title="Branch 1 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 222 times"> + </span><span class="branchCov" title="Branch 4 was taken 30 times"> + </span>]:<span class="lineCov">        252 :         if (!request.params[1].isNull())</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 222 times"> + </span><span class="branchCov" title="Branch 6 was taken 30 times"> + </span>]
<a name="155"><span class="lineNum">     155 </span>[<span class="branchCov" title="Branch 1 was taken 222 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 222 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        222 :             strLabel = request.params[1].get_str();</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 222 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="156"><span class="lineNum">     156 </span>                :            : </a>
<a name="157"><span class="lineNum">     157 </span>                :            :         // Whether to perform rescan after import</a>
<a name="158"><span class="lineNum">     158 </span>[<span class="branchCov" title="Branch 1 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 7 times"> + </span><span class="branchCov" title="Branch 4 was taken 245 times"> + </span>]:<span class="lineCov">        252 :         if (!request.params[2].isNull())</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 7 times"> + </span><span class="branchCov" title="Branch 6 was taken 245 times"> + </span>]
<a name="159"><span class="lineNum">     159 </span>[<span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          7 :             fRescan = request.params[2].get_bool();</span></a>
<a name="160"><span class="lineNum">     160 </span>                :            : </a>
<a name="161"><span class="lineNum">     161 </span>[<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 247 times"> + </span>]:<span class="lineCov">        252 :         if (fRescan &amp;&amp; pwallet-&gt;chain().havePruned()) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 247 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 247 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="162"><span class="lineNum">     162 </span>                :            :             // Exit early and print an error.</a>
<a name="163"><span class="lineNum">     163 </span>                :            :             // If a block is pruned after this check, we will import the key(s),</a>
<a name="164"><span class="lineNum">     164 </span>                :            :             // but fail the rescan with a generic error.</a>
<a name="165"><span class="lineNum">     165 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Rescan is disabled when blocks are pruned&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="166"><span class="lineNum">     166 </span>                :            :         }</a>
<a name="167"><span class="lineNum">     167 </span>                :            : </a>
<a name="168"><span class="lineNum">     168 </span>[<span class="branchCov" title="Branch 0 was taken 247 times"> + </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 247 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        252 :         if (fRescan &amp;&amp; !reserver.reserve()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 247 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="169"><span class="lineNum">     169 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Wallet is currently rescanning. Abort existing rescan or wait.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="170"><span class="lineNum">     170 </span>                :            :         }</a>
<a name="171"><span class="lineNum">     171 </span>                :            : </a>
<a name="172"><span class="lineNum">     172 </span>[<span class="branchCov" title="Branch 1 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        756 :         CKey key = DecodeSecret(strSecret);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 7 times"> + </span><span class="branchCov" title="Branch 6 was taken 244 times"> + </span>][<span class="branchCov" title="Branch 7 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="173"><span class="lineNum">     173 </span>[<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 251 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchCov" title="Branch 3 was taken 251 times"> + </span>]:<span class="lineCov">        506 :         if (!key.IsValid()) throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid private key encoding&quot;);</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 6 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 14 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 18 was not executed"> # </span><span class="branchNoExec" title="Branch 19 was not executed"> # </span>]
<a name="174"><span class="lineNum">     174 </span>                :            : </a>
<a name="175"><span class="lineNum">     175 </span>        [<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        251 :         CPubKey pubkey = key.GetPubKey();</span></a>
<a name="176"><span class="lineNum">     176 </span>[<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 251 times"> + </span>]:<span class="lineCov">        251 :         assert(key.VerifyPubKey(pubkey));</span></a>
<a name="177"><span class="lineNum">     177 </span>        [<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        251 :         CKeyID vchAddress = pubkey.GetID();</span></a>
<a name="178"><span class="lineNum">     178 </span>                :<span class="lineCov">        251 :         {</span></a>
<a name="179"><span class="lineNum">     179 </span>        [<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        251 :             pwallet-&gt;MarkDirty();</span></a>
<a name="180"><span class="lineNum">     180 </span>                :            : </a>
<a name="181"><span class="lineNum">     181 </span>                :            :             // We don't know which corresponding address will be used;</a>
<a name="182"><span class="lineNum">     182 </span>                :            :             // label all new addresses, and label existing addresses if a</a>
<a name="183"><span class="lineNum">     183 </span>                :            :             // label was passed.</a>
<a name="184"><span class="lineNum">     184 </span>[<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 747 times"> + </span><span class="branchCov" title="Branch 4 was taken 251 times"> + </span>]:<span class="lineCov">        998 :             for (const auto&amp; dest : GetAllDestinationsForKey(pubkey)) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 747 times"> + </span><span class="branchCov" title="Branch 6 was taken 251 times"> + </span>]
<a name="185"><span class="lineNum">     185 </span>[<span class="branchCov" title="Branch 1 was taken 747 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 81 times"> + </span><span class="branchCov" title="Branch 4 was taken 666 times"> + </span>]:<span class="lineCov">        747 :                 if (!request.params[1].isNull() || pwallet-&gt;mapAddressBook.count(dest) == 0) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 81 times"> + </span><span class="branchCov" title="Branch 6 was taken 666 times"> + </span>]
<a name="186"><span class="lineNum">     186 </span>[<span class="branchCov" title="Branch 1 was taken 734 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 734 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1468 :                     pwallet-&gt;SetAddressBook(dest, strLabel, &quot;receive&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 734 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 734 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>]
<a name="187"><span class="lineNum">     187 </span>                :            :                 }</a>
<a name="188"><span class="lineNum">     188 </span>                :            :             }</a>
<a name="189"><span class="lineNum">     189 </span>                :            : </a>
<a name="190"><span class="lineNum">     190 </span>                :            :             // Don't throw error in case a key is already there</a>
<a name="191"><span class="lineNum">     191 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 251 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        251 :             if (pwallet-&gt;HaveKey(vchAddress)) {</span></a>
<a name="192"><span class="lineNum">     192 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 return NullUniValue;</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="193"><span class="lineNum">     193 </span>                :            :             }</a>
<a name="194"><span class="lineNum">     194 </span>                :            : </a>
<a name="195"><span class="lineNum">     195 </span>                :            :             // whenever a key is imported, we need to scan the whole chain</a>
<a name="196"><span class="lineNum">     196 </span>        [<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        251 :             pwallet-&gt;UpdateTimeFirstKey(1);</span></a>
<a name="197"><span class="lineNum">     197 </span>        [<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        251 :             pwallet-&gt;mapKeyMetadata[vchAddress].nCreateTime = 1;</span></a>
<a name="198"><span class="lineNum">     198 </span>                :            : </a>
<a name="199"><span class="lineNum">     199 </span>[<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 251 times"> + </span>]:<span class="lineCov">        251 :             if (!pwallet-&gt;AddKeyPubKey(key, pubkey)) {</span></a>
<a name="200"><span class="lineNum">     200 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error adding key to wallet&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="201"><span class="lineNum">     201 </span>                :            :             }</a>
<a name="202"><span class="lineNum">     202 </span>        [<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        251 :             pwallet-&gt;LearnAllRelatedScripts(pubkey);</span></a>
<a name="203"><span class="lineNum">     203 </span>                :            :         }</a>
<a name="204"><span class="lineNum">     204 </span>                :            :     }</a>
<a name="205"><span class="lineNum">     205 </span>        [<span class="branchCov" title="Branch 0 was taken 246 times"> + </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>]:<span class="lineCov">        251 :     if (fRescan) {</span></a>
<a name="206"><span class="lineNum">     206 </span>        [<span class="branchCov" title="Branch 1 was taken 246 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        246 :         RescanWallet(*pwallet, reserver);</span></a>
<a name="207"><span class="lineNum">     207 </span>                :            :     }</a>
<a name="208"><span class="lineNum">     208 </span>                :            : </a>
<a name="209"><span class="lineNum">     209 </span>        [<span class="branchCov" title="Branch 1 was taken 251 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        251 :     return NullUniValue;</span></a>
<a name="210"><span class="lineNum">     210 </span>                :            : }</a>
<a name="211"><span class="lineNum">     211 </span>                :            : </a>
<a name="212"><span class="lineNum">     212 </span>                :<span class="lineCov">          3 : UniValue abortrescan(const JSONRPCRequest&amp; request)</span></a>
<a name="213"><span class="lineNum">     213 </span>                :            : {</a>
<a name="214"><span class="lineNum">     214 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          6 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="215"><span class="lineNum">     215 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          3 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="216"><span class="lineNum">     216 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          3 :     if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {</span></a>
<a name="217"><span class="lineNum">     217 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="218"><span class="lineNum">     218 </span>                :            :     }</a>
<a name="219"><span class="lineNum">     219 </span>                :            : </a>
<a name="220"><span class="lineNum">     220 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">          3 :     if (request.fHelp || request.params.size() &gt; 0)</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="221"><span class="lineNum">     221 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="222"><span class="lineNum">     222 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">          6 :             RPCHelpMan{&quot;abortrescan&quot;,</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 14 was not taken"> - </span><span class="branchCov" title="Branch 15 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchCov" title="Branch 17 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 21 was not executed"> # </span><span class="branchNoExec" title="Branch 22 was not executed"> # </span>][<span class="branchNoExec" title="Branch 23 was not executed"> # </span><span class="branchNoExec" title="Branch 24 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>][<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="223"><span class="lineNum">     223 </span>                :            :                 &quot;\nStops current wallet rescan triggered by an RPC call, e.g. by an importprivkey call.\n&quot;</a>
<a name="224"><span class="lineNum">     224 </span>                :            :                 &quot;Note: Use \&quot;getwalletinfo\&quot; to query the scanning progress.\n&quot;,</a>
<a name="225"><span class="lineNum">     225 </span>                :            :                 {},</a>
<a name="226"><span class="lineNum">     226 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :                 RPCResults{},</span></a>
<a name="227"><span class="lineNum">     227 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span> :<span class="lineCov">         12 :                 RPCExamples{</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 9 was not executed"> # </span><span class="branchNoExec" title="Branch 10 was not executed"> # </span>][<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>]
<a name="228"><span class="lineNum">     228 </span>                :            :             &quot;\nImport a private key\n&quot;</a>
<a name="229"><span class="lineNum">     229 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :             + HelpExampleCli(&quot;importprivkey&quot;, &quot;\&quot;mykey\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>][<span class="branchNoExec" title="Branch 33 was not executed"> # </span><span class="branchNoExec" title="Branch 34 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<a name="230"><span class="lineNum">     230 </span>                :            :             &quot;\nAbort the running wallet rescan\n&quot;</a>
<a name="231"><span class="lineNum">     231 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :             + HelpExampleCli(&quot;abortrescan&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 33 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 34 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 47 was not executed"> # </span><span class="branchNoExec" title="Branch 48 was not executed"> # </span>]
<a name="232"><span class="lineNum">     232 </span>                :            :             &quot;\nAs a JSON-RPC call\n&quot;</a>
<a name="233"><span class="lineNum">     233 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :             + HelpExampleRpc(&quot;abortrescan&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchCov" title="Branch 21 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 28 was not taken"> - </span><span class="branchCov" title="Branch 29 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="234"><span class="lineNum">     234 </span>                :            :                 },</a>
<a name="235"><span class="lineNum">     235 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">         12 :             }.ToString());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="236"><span class="lineNum">     236 </span>                :            : </a>
<a name="237"><span class="lineNum">     237 </span>[<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :     if (!pwallet-&gt;IsScanning() || pwallet-&gt;IsAbortingRescan()) return false;</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>][<span class="branchNoExec" title="Branch 6 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 9 was not executed"> # </span><span class="branchNoExec" title="Branch 10 was not executed"> # </span>]
<a name="238"><span class="lineNum">     238 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :     pwallet-&gt;AbortRescan();</span></a>
<a name="239"><span class="lineNum">     239 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :     return true;</span></a>
<a name="240"><span class="lineNum">     240 </span>                :            : }</a>
<a name="241"><span class="lineNum">     241 </span>                :            : </a>
<a name="242"><span class="lineNum">     242 </span>                :            : static void ImportAddress(CWallet*, const CTxDestination&amp; dest, const std::string&amp; strLabel);</a>
<a name="243"><span class="lineNum">     243 </span>                :<span class="lineCov">        164 : static void ImportScript(CWallet* const pwallet, const CScript&amp; script, const std::string&amp; strLabel, bool isRedeemScript) EXCLUSIVE_LOCKS_REQUIRED(pwallet-&gt;cs_wallet)</span></a>
<a name="244"><span class="lineNum">     244 </span>                :            : {</a>
<a name="245"><span class="lineNum">     245 </span>[<span class="branchCov" title="Branch 0 was taken 122 times"> + </span><span class="branchCov" title="Branch 1 was taken 42 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 11 times"> + </span><span class="branchCov" title="Branch 4 was taken 111 times"> + </span>]:<span class="lineCov">        164 :     if (!isRedeemScript &amp;&amp; ::IsMine(*pwallet, script) == ISMINE_SPENDABLE) {</span></a>
<a name="246"><span class="lineNum">     246 </span>  [<span class="branchCov" title="Branch 2 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">         33 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;The wallet already contains the private key for this address or script&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="247"><span class="lineNum">     247 </span>                :            :     }</a>
<a name="248"><span class="lineNum">     248 </span>                :            : </a>
<a name="249"><span class="lineNum">     249 </span>                :<span class="lineCov">        153 :     pwallet-&gt;MarkDirty();</span></a>
<a name="250"><span class="lineNum">     250 </span>                :            : </a>
<a name="251"><span class="lineNum">     251 </span>[<span class="branchCov" title="Branch 4 was taken 143 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 1 was taken 143 times"> + </span><span class="branchCov" title="Branch 2 was taken 10 times"> + </span>]:<span class="lineCov">        153 :     if (!pwallet-&gt;HaveWatchOnly(script) &amp;&amp; !pwallet-&gt;AddWatchOnly(script, 0 /* nCreateTime */)) {</span></a>
<a name="252"><span class="lineNum">     252 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error adding address to wallet&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="253"><span class="lineNum">     253 </span>                :            :     }</a>
<a name="254"><span class="lineNum">     254 </span>                :            : </a>
<a name="255"><span class="lineNum">     255 </span>        [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchCov" title="Branch 1 was taken 111 times"> + </span>]:<span class="lineCov">        153 :     if (isRedeemScript) {</span></a>
<a name="256"><span class="lineNum">     256 </span>                :<span class="lineCov">         42 :         const CScriptID id(script);</span></a>
<a name="257"><span class="lineNum">     257 </span>[<span class="branchCov" title="Branch 4 was taken 33 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 1 was taken 33 times"> + </span><span class="branchCov" title="Branch 2 was taken 9 times"> + </span>]:<span class="lineCov">         42 :         if (!pwallet-&gt;HaveCScript(id) &amp;&amp; !pwallet-&gt;AddCScript(script)) {</span></a>
<a name="258"><span class="lineNum">     258 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error adding p2sh redeemScript to wallet&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="259"><span class="lineNum">     259 </span>                :            :         }</a>
<a name="260"><span class="lineNum">     260 </span>[<span class="branchCov" title="Branch 1 was taken 31 times"> + </span><span class="branchCov" title="Branch 2 was taken 11 times"> + </span>][<span class="branchCov" title="Branch 4 was taken 31 times"> + </span><span class="branchCov" title="Branch 5 was taken 11 times"> + </span>]:<span class="lineCov">        126 :         ImportAddress(pwallet, ScriptHash(id), strLabel);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 31 times"> + </span><span class="branchCov" title="Branch 8 was taken 11 times"> + </span>]
<a name="261"><span class="lineNum">     261 </span>                :            :     } else {</a>
<a name="262"><span class="lineNum">     262 </span>        [<span class="branchCov" title="Branch 1 was taken 111 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        222 :         CTxDestination destination;</span></a>
<a name="263"><span class="lineNum">     263 </span>[<span class="branchCov" title="Branch 1 was taken 111 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 111 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        111 :         if (ExtractDestination(script, destination)) {</span></a>
<a name="264"><span class="lineNum">     264 </span>[<span class="branchCov" title="Branch 1 was taken 111 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 111 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        222 :             pwallet-&gt;SetAddressBook(destination, strLabel, &quot;receive&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 111 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 111 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>]
<a name="265"><span class="lineNum">     265 </span>                :            :         }</a>
<a name="266"><span class="lineNum">     266 </span>                :            :     }</a>
<a name="267"><span class="lineNum">     267 </span>                :<span class="lineCov">        142 : }</span></a>
<a name="268"><span class="lineNum">     268 </span>                :            : </a>
<a name="269"><span class="lineNum">     269 </span>                :<span class="lineCov">        104 : static void ImportAddress(CWallet* const pwallet, const CTxDestination&amp; dest, const std::string&amp; strLabel) EXCLUSIVE_LOCKS_REQUIRED(pwallet-&gt;cs_wallet)</span></a>
<a name="270"><span class="lineNum">     270 </span>                :            : {</a>
<a name="271"><span class="lineNum">     271 </span>[<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchCov" title="Branch 2 was taken 92 times"> + </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 11 times"> + </span>]:<span class="lineCov">        208 :     CScript script = GetScriptForDestination(dest);</span></a>
<a name="272"><span class="lineNum">     272 </span>        [<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchCov" title="Branch 2 was taken 11 times"> + </span>]:<span class="lineCov">        104 :     ImportScript(pwallet, script, strLabel, false);</span></a>
<a name="273"><span class="lineNum">     273 </span>                :            :     // add to address book or update label</a>
<a name="274"><span class="lineNum">     274 </span>[<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         93 :     if (IsValidDestination(dest))</span></a>
<a name="275"><span class="lineNum">     275 </span>[<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        186 :         pwallet-&gt;SetAddressBook(dest, strLabel, &quot;receive&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 93 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>]
<a name="276"><span class="lineNum">     276 </span>                :<span class="lineCov">         93 : }</span></a>
<a name="277"><span class="lineNum">     277 </span>                :            : </a>
<a name="278"><span class="lineNum">     278 </span>                :<span class="lineCov">         67 : UniValue importaddress(const JSONRPCRequest&amp; request)</span></a>
<a name="279"><span class="lineNum">     279 </span>                :            : {</a>
<a name="280"><span class="lineNum">     280 </span>[<span class="branchCov" title="Branch 1 was taken 51 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        185 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="281"><span class="lineNum">     281 </span>        [<span class="branchCov" title="Branch 1 was taken 67 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         67 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="282"><span class="lineNum">     282 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 67 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 67 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         67 :     if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {</span></a>
<a name="283"><span class="lineNum">     283 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="284"><span class="lineNum">     284 </span>                :            :     }</a>
<a name="285"><span class="lineNum">     285 </span>                :            : </a>
<a name="286"><span class="lineNum">     286 </span>[<span class="branchCov" title="Branch 0 was taken 64 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         67 :     if (request.fHelp || request.params.size() &lt; 1 || request.params.size() &gt; 4)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 64 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 64 times"> + </span>]
<a name="287"><span class="lineNum">     287 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="288"><span class="lineNum">     288 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">         42 :             RPCHelpMan{&quot;importaddress&quot;,</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 34 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>][<span class="branchCov" title="Branch 37 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 40 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>][<span class="branchCov" title="Branch 43 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 44 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 46 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span>][<span class="branchCov" title="Branch 49 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 50 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 52 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span>][<span class="branchCov" title="Branch 55 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 56 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 58 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span>][<span class="branchCov" title="Branch 61 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 62 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 64 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span>][<span class="branchCov" title="Branch 67 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 68 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 70 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span>][<span class="branchCov" title="Branch 73 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 74 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 76 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span>][<span class="branchCov" title="Branch 79 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 80 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 82 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span>][<span class="branchCov" title="Branch 85 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 86 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 88 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span>][<span class="branchCov" title="Branch 91 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 92 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 94 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span>][<span class="branchCov" title="Branch 97 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 98 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 100 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span>][<span class="branchCov" title="Branch 103 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 104 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 106 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span>][<span class="branchCov" title="Branch 109 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 110 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 112 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span>][<span class="branchCov" title="Branch 115 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 116 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 118 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 119 was not taken"> - </span>][<span class="branchCov" title="Branch 121 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 122 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 124 was taken 12 times"> + </span><span class="branchCov" title="Branch 125 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 127 was not taken"> - </span><span class="branchCov" title="Branch 128 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 129 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 130 was not taken"> - </span>][<span class="branchCov" title="Branch 131 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 132 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 135 was not taken"> - </span><span class="branchCov" title="Branch 136 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 139 was not taken"> - </span><span class="branchCov" title="Branch 140 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 141 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 142 was not taken"> - </span>][<span class="branchCov" title="Branch 143 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 144 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 147 was not taken"> - </span><span class="branchCov" title="Branch 148 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 151 was not taken"> - </span><span class="branchCov" title="Branch 152 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 153 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 154 was not taken"> - </span>][<span class="branchCov" title="Branch 155 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 156 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 159 was not taken"> - </span><span class="branchCov" title="Branch 160 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 163 was not taken"> - </span><span class="branchCov" title="Branch 164 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 165 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 166 was not taken"> - </span>][<span class="branchCov" title="Branch 167 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 168 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 171 was not taken"> - </span><span class="branchCov" title="Branch 172 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 173 was not taken"> - </span><span class="branchCov" title="Branch 174 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 175 was not taken"> - </span><span class="branchCov" title="Branch 176 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 177 was not taken"> - </span><span class="branchCov" title="Branch 178 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 179 was not taken"> - </span><span class="branchCov" title="Branch 180 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 184 was not executed"> # </span><span class="branchNoExec" title="Branch 185 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 187 was not executed"> # </span><span class="branchNoExec" title="Branch 188 was not executed"> # </span>][<span class="branchNoExec" title="Branch 189 was not executed"> # </span><span class="branchNoExec" title="Branch 190 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 191 was not executed"> # </span><span class="branchNoExec" title="Branch 192 was not executed"> # </span>][<span class="branchNoExec" title="Branch 195 was not executed"> # </span><span class="branchNoExec" title="Branch 196 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 198 was not executed"> # </span><span class="branchNoExec" title="Branch 199 was not executed"> # </span>][<span class="branchNoExec" title="Branch 200 was not executed"> # </span><span class="branchNoExec" title="Branch 201 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 202 was not executed"> # </span><span class="branchNoExec" title="Branch 203 was not executed"> # </span>][<span class="branchNoExec" title="Branch 206 was not executed"> # </span><span class="branchNoExec" title="Branch 207 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 209 was not executed"> # </span><span class="branchNoExec" title="Branch 210 was not executed"> # </span>][<span class="branchNoExec" title="Branch 211 was not executed"> # </span><span class="branchNoExec" title="Branch 212 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 213 was not executed"> # </span><span class="branchNoExec" title="Branch 214 was not executed"> # </span>][<span class="branchNoExec" title="Branch 217 was not executed"> # </span><span class="branchNoExec" title="Branch 218 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 220 was not executed"> # </span><span class="branchNoExec" title="Branch 221 was not executed"> # </span>][<span class="branchNoExec" title="Branch 222 was not executed"> # </span><span class="branchNoExec" title="Branch 223 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 224 was not executed"> # </span><span class="branchNoExec" title="Branch 225 was not executed"> # </span>][<span class="branchNoExec" title="Branch 228 was not executed"> # </span><span class="branchNoExec" title="Branch 229 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 230 was not executed"> # </span><span class="branchNoExec" title="Branch 231 was not executed"> # </span>][<span class="branchNoExec" title="Branch 232 was not executed"> # </span><span class="branchNoExec" title="Branch 233 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 234 was not executed"> # </span><span class="branchNoExec" title="Branch 235 was not executed"> # </span>][<span class="branchNoExec" title="Branch 236 was not executed"> # </span><span class="branchNoExec" title="Branch 237 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="289"><span class="lineNum">     289 </span>                :            :                 &quot;\nAdds an address or script (in hex) that can be watched as if it were in your wallet but cannot be used to spend. Requires a new wallet backup.\n&quot;</a>
<a name="290"><span class="lineNum">     290 </span>                :            :             &quot;\nNote: This call can take over an hour to complete if rescan is true, during that time, other rpc calls\n&quot;</a>
<a name="291"><span class="lineNum">     291 </span>                :            :             &quot;may report that the imported address exists but related transactions are still missing, leading to temporarily incorrect/bogus balances and unspent outputs until rescan completes.\n&quot;</a>
<a name="292"><span class="lineNum">     292 </span>                :            :             &quot;If you have the full public key, you should call importpubkey instead of this.\n&quot;</a>
<a name="293"><span class="lineNum">     293 </span>                :            :             &quot;Hint: use importmulti to import more than one address.\n&quot;</a>
<a name="294"><span class="lineNum">     294 </span>                :            :             &quot;\nNote: If you import a non-standard raw script in hex form, outputs sending to it will be treated\n&quot;</a>
<a name="295"><span class="lineNum">     295 </span>                :            :             &quot;as change, and not show up in many RPCs.\n&quot;</a>
<a name="296"><span class="lineNum">     296 </span>                :            :             &quot;Note: Use \&quot;getwalletinfo\&quot; to query the scanning progress.\n&quot;,</a>
<a name="297"><span class="lineNum">     297 </span>                :            :                 {</a>
<a name="298"><span class="lineNum">     298 </span>                :            :                     {&quot;address&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The Bitcoin address (or hex-encoded script)&quot;},</a>
<a name="299"><span class="lineNum">     299 </span>                :            :                     {&quot;label&quot;, RPCArg::Type::STR, /* default */ &quot;\&quot;\&quot;&quot;, &quot;An optional label&quot;},</a>
<a name="300"><span class="lineNum">     300 </span>                :            :                     {&quot;rescan&quot;, RPCArg::Type::BOOL, /* default */ &quot;true&quot;, &quot;Rescan the wallet for transactions&quot;},</a>
<a name="301"><span class="lineNum">     301 </span>                :            :                     {&quot;p2sh&quot;, RPCArg::Type::BOOL, /* default */ &quot;false&quot;, &quot;Add the P2SH version of the script as well&quot;},</a>
<a name="302"><span class="lineNum">     302 </span>                :            :                 },</a>
<a name="303"><span class="lineNum">     303 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :                 RPCResults{},</span></a>
<a name="304"><span class="lineNum">     304 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">          9 :                 RPCExamples{</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="305"><span class="lineNum">     305 </span>                :            :             &quot;\nImport an address with rescan\n&quot;</a>
<a name="306"><span class="lineNum">     306 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :             + HelpExampleCli(&quot;importaddress&quot;, &quot;\&quot;myaddress\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>][<span class="branchNoExec" title="Branch 33 was not executed"> # </span><span class="branchNoExec" title="Branch 34 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<a name="307"><span class="lineNum">     307 </span>                :            :             &quot;\nImport using a label without rescan\n&quot;</a>
<a name="308"><span class="lineNum">     308 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         21 :             + HelpExampleCli(&quot;importaddress&quot;, &quot;\&quot;myaddress\&quot; \&quot;testing\&quot; false&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 29 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 30 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>][<span class="branchNoCov" title="Branch 33 was not taken"> - </span><span class="branchCov" title="Branch 34 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 47 was not executed"> # </span><span class="branchNoExec" title="Branch 48 was not executed"> # </span>]
<a name="309"><span class="lineNum">     309 </span>                :            :             &quot;\nAs a JSON-RPC call\n&quot;</a>
<a name="310"><span class="lineNum">     310 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         21 :             + HelpExampleRpc(&quot;importaddress&quot;, &quot;\&quot;myaddress\&quot;, \&quot;testing\&quot;, false&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 20 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 22 was not taken"> - </span><span class="branchCov" title="Branch 23 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 26 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>][<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="311"><span class="lineNum">     311 </span>                :            :                 },</a>
<a name="312"><span class="lineNum">     312 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">         24 :             }.ToString());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="313"><span class="lineNum">     313 </span>                :            : </a>
<a name="314"><span class="lineNum">     314 </span>                :            : </a>
<a name="315"><span class="lineNum">     315 </span>[<span class="branchCov" title="Branch 1 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 13 times"> + </span>]:<span class="lineCov">         77 :     std::string strLabel;</span></a>
<a name="316"><span class="lineNum">     316 </span>[<span class="branchCov" title="Branch 1 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 55 times"> + </span><span class="branchCov" title="Branch 4 was taken 9 times"> + </span>]:<span class="lineCov">         64 :     if (!request.params[1].isNull())</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 55 times"> + </span><span class="branchCov" title="Branch 6 was taken 9 times"> + </span>]
<a name="317"><span class="lineNum">     317 </span>[<span class="branchCov" title="Branch 1 was taken 55 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 55 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         55 :         strLabel = request.params[1].get_str();</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 55 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="318"><span class="lineNum">     318 </span>                :            : </a>
<a name="319"><span class="lineNum">     319 </span>                :            :     // Whether to perform rescan after import</a>
<a name="320"><span class="lineNum">     320 </span>                :<span class="lineCov">         64 :     bool fRescan = true;</span></a>
<a name="321"><span class="lineNum">     321 </span>[<span class="branchCov" title="Branch 1 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 53 times"> + </span><span class="branchCov" title="Branch 4 was taken 11 times"> + </span>]:<span class="lineCov">         64 :     if (!request.params[2].isNull())</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 53 times"> + </span><span class="branchCov" title="Branch 6 was taken 11 times"> + </span>]
<a name="322"><span class="lineNum">     322 </span>[<span class="branchCov" title="Branch 1 was taken 53 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 53 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         53 :         fRescan = request.params[2].get_bool();</span></a>
<a name="323"><span class="lineNum">     323 </span>                :            : </a>
<a name="324"><span class="lineNum">     324 </span>[<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 51 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 13 times"> + </span>]:<span class="lineCov">         64 :     if (fRescan &amp;&amp; pwallet-&gt;chain().havePruned()) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="325"><span class="lineNum">     325 </span>                :            :         // Exit early and print an error.</a>
<a name="326"><span class="lineNum">     326 </span>                :            :         // If a block is pruned after this check, we will import the key(s),</a>
<a name="327"><span class="lineNum">     327 </span>                :            :         // but fail the rescan with a generic error.</a>
<a name="328"><span class="lineNum">     328 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Rescan is disabled when blocks are pruned&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="329"><span class="lineNum">     329 </span>                :            :     }</a>
<a name="330"><span class="lineNum">     330 </span>                :            : </a>
<a name="331"><span class="lineNum">     331 </span>[<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchCov" title="Branch 1 was taken 51 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 8 times"> + </span><span class="branchCov" title="Branch 4 was taken 43 times"> + </span>]:<span class="lineCov">        128 :     WalletRescanReserver reserver(pwallet);</span></a>
<a name="332"><span class="lineNum">     332 </span>[<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchCov" title="Branch 1 was taken 51 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         64 :     if (fRescan &amp;&amp; !reserver.reserve()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="333"><span class="lineNum">     333 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Wallet is currently rescanning. Abort existing rescan or wait.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="334"><span class="lineNum">     334 </span>                :            :     }</a>
<a name="335"><span class="lineNum">     335 </span>                :            : </a>
<a name="336"><span class="lineNum">     336 </span>                :            :     // Whether to import a p2sh version, too</a>
<a name="337"><span class="lineNum">     337 </span>                :<span class="lineCov">         64 :     bool fP2SH = false;</span></a>
<a name="338"><span class="lineNum">     338 </span>[<span class="branchCov" title="Branch 1 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 43 times"> + </span><span class="branchCov" title="Branch 4 was taken 21 times"> + </span>]:<span class="lineCov">         64 :     if (!request.params[3].isNull())</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 43 times"> + </span><span class="branchCov" title="Branch 6 was taken 21 times"> + </span>]
<a name="339"><span class="lineNum">     339 </span>[<span class="branchCov" title="Branch 1 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         43 :         fP2SH = request.params[3].get_bool();</span></a>
<a name="340"><span class="lineNum">     340 </span>                :            : </a>
<a name="341"><span class="lineNum">     341 </span>                :<span class="lineCov">         64 :     {</span></a>
<a name="342"><span class="lineNum">     342 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 64 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         90 :         auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="343"><span class="lineNum">     343 </span>[<span class="branchCov" title="Branch 1 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 51 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        141 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="344"><span class="lineNum">     344 </span>                :            : </a>
<a name="345"><span class="lineNum">     345 </span>[<span class="branchCov" title="Branch 1 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        128 :         CTxDestination dest = DecodeDestination(request.params[0].get_str());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 51 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="346"><span class="lineNum">     346 </span>[<span class="branchCov" title="Branch 1 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 19 times"> + </span><span class="branchCov" title="Branch 4 was taken 45 times"> + </span>]:<span class="lineCov">         64 :         if (IsValidDestination(dest)) {</span></a>
<a name="347"><span class="lineNum">     347 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>]:<span class="lineCov">         19 :             if (fP2SH) {</span></a>
<a name="348"><span class="lineNum">     348 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :                 throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Cannot use the p2sh flag with an address - use a script instead&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="349"><span class="lineNum">     349 </span>                :            :             }</a>
<a name="350"><span class="lineNum">     350 </span>        [<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         18 :             ImportAddress(pwallet, dest, strLabel);</span></a>
<a name="351"><span class="lineNum">     351 </span>[<span class="branchCov" title="Branch 1 was taken 45 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 45 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         45 :         } else if (IsHex(request.params[0].get_str())) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 45 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 44 times"> + </span><span class="branchCov" title="Branch 10 was taken 1 time"> + </span>]
<a name="352"><span class="lineNum">     352 </span>[<span class="branchCov" title="Branch 1 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         66 :             std::vector&lt;unsigned char&gt; data(ParseHex(request.params[0].get_str()));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<a name="353"><span class="lineNum">     353 </span>[<span class="branchCov" title="Branch 6 was taken 33 times"> + </span><span class="branchCov" title="Branch 7 was taken 11 times"> + </span>][<span class="branchCov" title="Branch 8 was taken 23 times"> + </span><span class="branchCov" title="Branch 9 was taken 10 times"> + </span>]:<span class="lineCov">        251 :             ImportScript(pwallet, CScript(data.begin(), data.end()), strLabel, fP2SH);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 33 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 12 was taken 8 times"> + </span><span class="branchCov" title="Branch 13 was taken 3 times"> + </span>]
<a name="354"><span class="lineNum">     354 </span>                :            :         } else {</a>
<a name="355"><span class="lineNum">     355 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid Bitcoin address or script&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="356"><span class="lineNum">     356 </span>                :            :         }</a>
<a name="357"><span class="lineNum">     357 </span>                :            :     }</a>
<a name="358"><span class="lineNum">     358 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 39 times"> + </span>]:<span class="lineCov">         51 :     if (fRescan)</span></a>
<a name="359"><span class="lineNum">     359 </span>                :            :     {</a>
<a name="360"><span class="lineNum">     360 </span>        [<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         12 :         RescanWallet(*pwallet, reserver);</span></a>
<a name="361"><span class="lineNum">     361 </span>                :<span class="lineCov">         12 :         {</span></a>
<a name="362"><span class="lineNum">     362 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         12 :             auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="363"><span class="lineNum">     363 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         36 :             LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="364"><span class="lineNum">     364 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         24 :             pwallet-&gt;ReacceptWalletTransactions(*locked_chain);</span></a>
<a name="365"><span class="lineNum">     365 </span>                :            :         }</a>
<a name="366"><span class="lineNum">     366 </span>                :            :     }</a>
<a name="367"><span class="lineNum">     367 </span>                :            : </a>
<a name="368"><span class="lineNum">     368 </span>        [<span class="branchCov" title="Branch 1 was taken 51 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         51 :     return NullUniValue;</span></a>
<a name="369"><span class="lineNum">     369 </span>                :            : }</a>
<a name="370"><span class="lineNum">     370 </span>                :            : </a>
<a name="371"><span class="lineNum">     371 </span>                :<span class="lineCov">          6 : UniValue importprunedfunds(const JSONRPCRequest&amp; request)</span></a>
<a name="372"><span class="lineNum">     372 </span>                :            : {</a>
<a name="373"><span class="lineNum">     373 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         14 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="374"><span class="lineNum">     374 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="375"><span class="lineNum">     375 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 6 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {</span></a>
<a name="376"><span class="lineNum">     376 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="377"><span class="lineNum">     377 </span>                :            :     }</a>
<a name="378"><span class="lineNum">     378 </span>                :            : </a>
<a name="379"><span class="lineNum">     379 </span>[<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 3 times"> + </span>]:<span class="lineCov">          6 :     if (request.fHelp || request.params.size() != 2)</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span>]
<a name="380"><span class="lineNum">     380 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="381"><span class="lineNum">     381 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">         24 :             RPCHelpMan{&quot;importprunedfunds&quot;,</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 34 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>][<span class="branchCov" title="Branch 37 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 40 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>][<span class="branchCov" title="Branch 43 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 44 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 46 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span>][<span class="branchCov" title="Branch 49 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 50 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 52 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span>][<span class="branchCov" title="Branch 55 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 56 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 58 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span>][<span class="branchCov" title="Branch 61 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 62 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 64 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span>][<span class="branchCov" title="Branch 67 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 68 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 70 was taken 6 times"> + </span><span class="branchCov" title="Branch 71 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 73 was not taken"> - </span><span class="branchCov" title="Branch 74 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 75 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 76 was not taken"> - </span>][<span class="branchCov" title="Branch 77 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 78 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 87 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 88 was not taken"> - </span>][<span class="branchCov" title="Branch 89 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 90 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 93 was not taken"> - </span><span class="branchCov" title="Branch 94 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 106 was not executed"> # </span><span class="branchNoExec" title="Branch 107 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 109 was not executed"> # </span><span class="branchNoExec" title="Branch 110 was not executed"> # </span>][<span class="branchNoExec" title="Branch 111 was not executed"> # </span><span class="branchNoExec" title="Branch 112 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 113 was not executed"> # </span><span class="branchNoExec" title="Branch 114 was not executed"> # </span>][<span class="branchNoExec" title="Branch 117 was not executed"> # </span><span class="branchNoExec" title="Branch 118 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 120 was not executed"> # </span><span class="branchNoExec" title="Branch 121 was not executed"> # </span>][<span class="branchNoExec" title="Branch 122 was not executed"> # </span><span class="branchNoExec" title="Branch 123 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 124 was not executed"> # </span><span class="branchNoExec" title="Branch 125 was not executed"> # </span>][<span class="branchNoExec" title="Branch 128 was not executed"> # </span><span class="branchNoExec" title="Branch 129 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 130 was not executed"> # </span><span class="branchNoExec" title="Branch 131 was not executed"> # </span>][<span class="branchNoExec" title="Branch 132 was not executed"> # </span><span class="branchNoExec" title="Branch 133 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 134 was not executed"> # </span><span class="branchNoExec" title="Branch 135 was not executed"> # </span>][<span class="branchNoExec" title="Branch 136 was not executed"> # </span><span class="branchNoExec" title="Branch 137 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="382"><span class="lineNum">     382 </span>                :            :                 &quot;\nImports funds without rescan. Corresponding address or script must previously be included in wallet. Aimed towards pruned wallets. The end-user is responsible to import additional transactions that subsequently spend the imported outputs or rescan after the point in the blockchain the transaction is included.\n&quot;,</a>
<a name="383"><span class="lineNum">     383 </span>                :            :                 {</a>
<a name="384"><span class="lineNum">     384 </span>                :            :                     {&quot;rawtransaction&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;A raw transaction in hex funding an already-existing address in wallet&quot;},</a>
<a name="385"><span class="lineNum">     385 </span>                :            :                     {&quot;txoutproof&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The hex output from gettxoutproof that contains the transaction&quot;},</a>
<a name="386"><span class="lineNum">     386 </span>                :            :                 },</a>
<a name="387"><span class="lineNum">     387 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :                 RPCResults{},</span></a>
<a name="388"><span class="lineNum">     388 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         12 :                 RPCExamples{&quot;&quot;},</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 6 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 9 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 13 was not taken"> - </span><span class="branchCov" title="Branch 14 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 19 was not executed"> # </span><span class="branchNoExec" title="Branch 20 was not executed"> # </span>]
<a name="389"><span class="lineNum">     389 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         15 :             }.ToString()</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="390"><span class="lineNum">     390 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          9 :         );</span></a>
<a name="391"><span class="lineNum">     391 </span>                :            : </a>
<a name="392"><span class="lineNum">     392 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :     CMutableTransaction tx;</span></a>
<a name="393"><span class="lineNum">     393 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          3 :     if (!DecodeHexTx(tx, request.params[0].get_str()))</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 3 times"> + </span>]
<a name="394"><span class="lineNum">     394 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, &quot;TX decode failed&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="395"><span class="lineNum">     395 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          3 :     uint256 hashTx = tx.GetHash();</span></a>
<a name="396"><span class="lineNum">     396 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span>]:<span class="lineCov">          6 :     CWalletTx wtx(pwallet, MakeTransactionRef(std::move(tx)));</span></a>
<a name="397"><span class="lineNum">     397 </span>                :            : </a>
<a name="398"><span class="lineNum">     398 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :     CDataStream ssMB(ParseHexV(request.params[1], &quot;proof&quot;), SER_NETWORK, PROTOCOL_VERSION);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<a name="399"><span class="lineNum">     399 </span>                :<span class="lineCov">          6 :     CMerkleBlock merkleBlock;</span></a>
<a name="400"><span class="lineNum">     400 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          3 :     ssMB &gt;&gt; merkleBlock;</span></a>
<a name="401"><span class="lineNum">     401 </span>                :            : </a>
<a name="402"><span class="lineNum">     402 </span>                :            :     //Search partial merkle tree in proof for our transaction and index in valid block</a>
<a name="403"><span class="lineNum">     403 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          7 :     std::vector&lt;uint256&gt; vMatch;</span></a>
<a name="404"><span class="lineNum">     404 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          7 :     std::vector&lt;unsigned int&gt; vIndex;</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="405"><span class="lineNum">     405 </span>                :<span class="lineCov">          3 :     unsigned int txnIndex = 0;</span></a>
<a name="406"><span class="lineNum">     406 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          3 :     if (merkleBlock.txn.ExtractMatches(vMatch, vIndex) == merkleBlock.header.hashMerkleRoot) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="407"><span class="lineNum">     407 </span>                :            : </a>
<a name="408"><span class="lineNum">     408 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          3 :         auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="409"><span class="lineNum">     409 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          6 :         if (locked_chain-&gt;getBlockHeight(merkleBlock.header.GetHash()) == nullopt) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 3 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 3 times"> + </span>]
<a name="410"><span class="lineNum">     410 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Block not found in chain&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="411"><span class="lineNum">     411 </span>                :            :         }</a>
<a name="412"><span class="lineNum">     412 </span>                :            : </a>
<a name="413"><span class="lineNum">     413 </span>                :<span class="lineCov">          3 :         std::vector&lt;uint256&gt;::const_iterator it;</span></a>
<a name="414"><span class="lineNum">     414 </span>  [<span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 3 times"> + </span> :<span class="lineCov">         12 :         if ((it = std::find(vMatch.begin(), vMatch.end(), hashTx))==vMatch.end()) {</span></a>
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 3 times"> + </span>]
<a name="415"><span class="lineNum">     415 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Transaction given doesn't exist in proof&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="416"><span class="lineNum">     416 </span>                :            :         }</a>
<a name="417"><span class="lineNum">     417 </span>                :            : </a>
<a name="418"><span class="lineNum">     418 </span>[<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :         txnIndex = vIndex[it - vMatch.begin()];</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 6 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="419"><span class="lineNum">     419 </span>                :            :     }</a>
<a name="420"><span class="lineNum">     420 </span>                :            :     else {</a>
<a name="421"><span class="lineNum">     421 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Something wrong with merkleblock&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="422"><span class="lineNum">     422 </span>                :            :     }</a>
<a name="423"><span class="lineNum">     423 </span>                :            : </a>
<a name="424"><span class="lineNum">     424 </span>                :<span class="lineCov">          3 :     wtx.nIndex = txnIndex;</span></a>
<a name="425"><span class="lineNum">     425 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          3 :     wtx.hashBlock = merkleBlock.header.GetHash();</span></a>
<a name="426"><span class="lineNum">     426 </span>                :            : </a>
<a name="427"><span class="lineNum">     427 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          7 :     auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="428"><span class="lineNum">     428 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          9 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="429"><span class="lineNum">     429 </span>                :            : </a>
<a name="430"><span class="lineNum">     430 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          6 :     if (pwallet-&gt;IsMine(*wtx.tx)) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchCov" title="Branch 7 was taken 1 time"> + </span>]
<a name="431"><span class="lineNum">     431 </span>        [<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          2 :         pwallet-&gt;AddToWallet(wtx, false);</span></a>
<a name="432"><span class="lineNum">     432 </span>        [<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          2 :         return NullUniValue;</span></a>
<a name="433"><span class="lineNum">     433 </span>                :            :     }</a>
<a name="434"><span class="lineNum">     434 </span>                :            : </a>
<a name="435"><span class="lineNum">     435 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :     throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;No addresses in wallet correspond to included transaction&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="436"><span class="lineNum">     436 </span>                :            : }</a>
<a name="437"><span class="lineNum">     437 </span>                :            : </a>
<a name="438"><span class="lineNum">     438 </span>                :<span class="lineCov">          6 : UniValue removeprunedfunds(const JSONRPCRequest&amp; request)</span></a>
<a name="439"><span class="lineNum">     439 </span>                :            : {</a>
<a name="440"><span class="lineNum">     440 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         14 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="441"><span class="lineNum">     441 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="442"><span class="lineNum">     442 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 6 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {</span></a>
<a name="443"><span class="lineNum">     443 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="444"><span class="lineNum">     444 </span>                :            :     }</a>
<a name="445"><span class="lineNum">     445 </span>                :            : </a>
<a name="446"><span class="lineNum">     446 </span>[<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 3 times"> + </span>]:<span class="lineCov">          6 :     if (request.fHelp || request.params.size() != 1)</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span>]
<a name="447"><span class="lineNum">     447 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="448"><span class="lineNum">     448 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">         15 :             RPCHelpMan{&quot;removeprunedfunds&quot;,</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 34 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>][<span class="branchCov" title="Branch 37 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 40 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>][<span class="branchCov" title="Branch 43 was taken 3 times"> + </span><span class="branchCov" title="Branch 44 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 46 was not taken"> - </span><span class="branchCov" title="Branch 47 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 48 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 50 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span>][<span class="branchNoCov" title="Branch 54 was not taken"> - </span><span class="branchCov" title="Branch 55 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 56 was not taken"> - </span><span class="branchCov" title="Branch 57 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 58 was not taken"> - </span><span class="branchCov" title="Branch 59 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 60 was not taken"> - </span><span class="branchCov" title="Branch 61 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 62 was not taken"> - </span><span class="branchCov" title="Branch 63 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 67 was not executed"> # </span><span class="branchNoExec" title="Branch 68 was not executed"> # </span>][<span class="branchNoExec" title="Branch 70 was not executed"> # </span><span class="branchNoExec" title="Branch 71 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 72 was not executed"> # </span><span class="branchNoExec" title="Branch 73 was not executed"> # </span>][<span class="branchNoExec" title="Branch 74 was not executed"> # </span><span class="branchNoExec" title="Branch 75 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 78 was not executed"> # </span><span class="branchNoExec" title="Branch 79 was not executed"> # </span>][<span class="branchNoExec" title="Branch 80 was not executed"> # </span><span class="branchNoExec" title="Branch 81 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 82 was not executed"> # </span><span class="branchNoExec" title="Branch 83 was not executed"> # </span>][<span class="branchNoExec" title="Branch 84 was not executed"> # </span><span class="branchNoExec" title="Branch 85 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 86 was not executed"> # </span><span class="branchNoExec" title="Branch 87 was not executed"> # </span>][<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="449"><span class="lineNum">     449 </span>                :            :                 &quot;\nDeletes the specified transaction from the wallet. Meant for use with pruned wallets and as a companion to importprunedfunds. This will affect wallet balances.\n&quot;,</a>
<a name="450"><span class="lineNum">     450 </span>                :            :                 {</a>
<a name="451"><span class="lineNum">     451 </span>                :            :                     {&quot;txid&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The hex-encoded id of the transaction you are deleting&quot;},</a>
<a name="452"><span class="lineNum">     452 </span>                :            :                 },</a>
<a name="453"><span class="lineNum">     453 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :                 RPCResults{},</span></a>
<a name="454"><span class="lineNum">     454 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">          9 :                 RPCExamples{</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="455"><span class="lineNum">     455 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :                     HelpExampleCli(&quot;removeprunedfunds&quot;, &quot;\&quot;a8d0c0184dde994a09ec054286f1ce581bebf46446a512166eae7628734ea0a5\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 20 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 24 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 28 was not executed"> # </span><span class="branchNoExec" title="Branch 29 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 30 was not executed"> # </span><span class="branchNoExec" title="Branch 31 was not executed"> # </span>][<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>][<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<a name="456"><span class="lineNum">     456 </span>                :            :             &quot;\nAs a JSON-RPC call\n&quot;</a>
<a name="457"><span class="lineNum">     457 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         27 :             + HelpExampleRpc(&quot;removeprunedfunds&quot;, &quot;\&quot;a8d0c0184dde994a09ec054286f1ce581bebf46446a512166eae7628734ea0a5\&quot;&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 20 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 22 was not taken"> - </span><span class="branchCov" title="Branch 23 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 24 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 26 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>][<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="458"><span class="lineNum">     458 </span>                :            :                 },</a>
<a name="459"><span class="lineNum">     459 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">         15 :             }.ToString());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="460"><span class="lineNum">     460 </span>                :            : </a>
<a name="461"><span class="lineNum">     461 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          5 :     auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="462"><span class="lineNum">     462 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          7 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="463"><span class="lineNum">     463 </span>                :            : </a>
<a name="464"><span class="lineNum">     464 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          6 :     uint256 hash(ParseHashV(request.params[0], &quot;txid&quot;));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 15 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="465"><span class="lineNum">     465 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          7 :     std::vector&lt;uint256&gt; vHash;</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="466"><span class="lineNum">     466 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          3 :     vHash.push_back(hash);</span></a>
<a name="467"><span class="lineNum">     467 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          8 :     std::vector&lt;uint256&gt; vHashOut;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1 time"> + </span>]
<a name="468"><span class="lineNum">     468 </span>                :            : </a>
<a name="469"><span class="lineNum">     469 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 3 times"> + </span>]:<span class="lineCov">          3 :     if (pwallet-&gt;ZapSelectTx(vHash, vHashOut) != DBErrors::LOAD_OK) {</span></a>
<a name="470"><span class="lineNum">     470 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Could not properly delete the transaction.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="471"><span class="lineNum">     471 </span>                :            :     }</a>
<a name="472"><span class="lineNum">     472 </span>                :            : </a>
<a name="473"><span class="lineNum">     473 </span>[<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">          6 :     if(vHashOut.empty()) {</span></a>
<a name="474"><span class="lineNum">     474 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Transaction does not exist in wallet.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="475"><span class="lineNum">     475 </span>                :            :     }</a>
<a name="476"><span class="lineNum">     476 </span>                :            : </a>
<a name="477"><span class="lineNum">     477 </span>        [<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          2 :     return NullUniValue;</span></a>
<a name="478"><span class="lineNum">     478 </span>                :            : }</a>
<a name="479"><span class="lineNum">     479 </span>                :            : </a>
<a name="480"><span class="lineNum">     480 </span>                :<span class="lineCov">         21 : UniValue importpubkey(const JSONRPCRequest&amp; request)</span></a>
<a name="481"><span class="lineNum">     481 </span>                :            : {</a>
<a name="482"><span class="lineNum">     482 </span>[<span class="branchCov" title="Branch 1 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         58 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="483"><span class="lineNum">     483 </span>        [<span class="branchCov" title="Branch 1 was taken 21 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         21 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="484"><span class="lineNum">     484 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 21 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 21 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         21 :     if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {</span></a>
<a name="485"><span class="lineNum">     485 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="486"><span class="lineNum">     486 </span>                :            :     }</a>
<a name="487"><span class="lineNum">     487 </span>                :            : </a>
<a name="488"><span class="lineNum">     488 </span>[<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         21 :     if (request.fHelp || request.params.size() &lt; 1 || request.params.size() &gt; 3)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 18 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 18 times"> + </span>]
<a name="489"><span class="lineNum">     489 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="490"><span class="lineNum">     490 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">         33 :             RPCHelpMan{&quot;importpubkey&quot;,</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 34 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>][<span class="branchCov" title="Branch 37 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 40 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>][<span class="branchCov" title="Branch 43 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 44 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 46 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span>][<span class="branchCov" title="Branch 49 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 50 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 52 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span>][<span class="branchCov" title="Branch 55 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 56 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 58 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span>][<span class="branchCov" title="Branch 61 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 62 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 64 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span>][<span class="branchCov" title="Branch 67 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 68 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 70 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span>][<span class="branchCov" title="Branch 73 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 74 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 76 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span>][<span class="branchCov" title="Branch 79 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 80 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 82 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span>][<span class="branchCov" title="Branch 85 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 86 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 88 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span>][<span class="branchCov" title="Branch 91 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 92 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 94 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span>][<span class="branchCov" title="Branch 97 was taken 9 times"> + </span><span class="branchCov" title="Branch 98 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 100 was not taken"> - </span><span class="branchCov" title="Branch 101 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 102 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 104 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span>][<span class="branchNoCov" title="Branch 108 was not taken"> - </span><span class="branchCov" title="Branch 109 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 112 was not taken"> - </span><span class="branchCov" title="Branch 113 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 114 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 115 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 116 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 117 was not taken"> - </span>][<span class="branchNoCov" title="Branch 120 was not taken"> - </span><span class="branchCov" title="Branch 121 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 124 was not taken"> - </span><span class="branchCov" title="Branch 125 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 126 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 127 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 128 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 129 was not taken"> - </span>][<span class="branchNoCov" title="Branch 132 was not taken"> - </span><span class="branchCov" title="Branch 133 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 134 was not taken"> - </span><span class="branchCov" title="Branch 135 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 136 was not taken"> - </span><span class="branchCov" title="Branch 137 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 138 was not taken"> - </span><span class="branchCov" title="Branch 139 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 140 was not taken"> - </span><span class="branchCov" title="Branch 141 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 145 was not executed"> # </span><span class="branchNoExec" title="Branch 146 was not executed"> # </span>][<span class="branchNoExec" title="Branch 148 was not executed"> # </span><span class="branchNoExec" title="Branch 149 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 150 was not executed"> # </span><span class="branchNoExec" title="Branch 151 was not executed"> # </span>][<span class="branchNoExec" title="Branch 152 was not executed"> # </span><span class="branchNoExec" title="Branch 153 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 156 was not executed"> # </span><span class="branchNoExec" title="Branch 157 was not executed"> # </span>][<span class="branchNoExec" title="Branch 159 was not executed"> # </span><span class="branchNoExec" title="Branch 160 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 161 was not executed"> # </span><span class="branchNoExec" title="Branch 162 was not executed"> # </span>][<span class="branchNoExec" title="Branch 163 was not executed"> # </span><span class="branchNoExec" title="Branch 164 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 167 was not executed"> # </span><span class="branchNoExec" title="Branch 168 was not executed"> # </span>][<span class="branchNoExec" title="Branch 170 was not executed"> # </span><span class="branchNoExec" title="Branch 171 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 172 was not executed"> # </span><span class="branchNoExec" title="Branch 173 was not executed"> # </span>][<span class="branchNoExec" title="Branch 174 was not executed"> # </span><span class="branchNoExec" title="Branch 175 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 178 was not executed"> # </span><span class="branchNoExec" title="Branch 179 was not executed"> # </span>][<span class="branchNoExec" title="Branch 180 was not executed"> # </span><span class="branchNoExec" title="Branch 181 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 182 was not executed"> # </span><span class="branchNoExec" title="Branch 183 was not executed"> # </span>][<span class="branchNoExec" title="Branch 184 was not executed"> # </span><span class="branchNoExec" title="Branch 185 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 186 was not executed"> # </span><span class="branchNoExec" title="Branch 187 was not executed"> # </span>][<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="491"><span class="lineNum">     491 </span>                :            :                 &quot;\nAdds a public key (in hex) that can be watched as if it were in your wallet but cannot be used to spend. Requires a new wallet backup.\n&quot;</a>
<a name="492"><span class="lineNum">     492 </span>                :            :                 &quot;Hint: use importmulti to import more than one public key.\n&quot;</a>
<a name="493"><span class="lineNum">     493 </span>                :            :             &quot;\nNote: This call can take over an hour to complete if rescan is true, during that time, other rpc calls\n&quot;</a>
<a name="494"><span class="lineNum">     494 </span>                :            :             &quot;may report that the imported pubkey exists but related transactions are still missing, leading to temporarily incorrect/bogus balances and unspent outputs until rescan completes.\n&quot;</a>
<a name="495"><span class="lineNum">     495 </span>                :            :             &quot;Note: Use \&quot;getwalletinfo\&quot; to query the scanning progress.\n&quot;,</a>
<a name="496"><span class="lineNum">     496 </span>                :            :                 {</a>
<a name="497"><span class="lineNum">     497 </span>                :            :                     {&quot;pubkey&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The hex-encoded public key&quot;},</a>
<a name="498"><span class="lineNum">     498 </span>                :            :                     {&quot;label&quot;, RPCArg::Type::STR, /* default */ &quot;\&quot;\&quot;&quot;, &quot;An optional label&quot;},</a>
<a name="499"><span class="lineNum">     499 </span>                :            :                     {&quot;rescan&quot;, RPCArg::Type::BOOL, /* default */ &quot;true&quot;, &quot;Rescan the wallet for transactions&quot;},</a>
<a name="500"><span class="lineNum">     500 </span>                :            :                 },</a>
<a name="501"><span class="lineNum">     501 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :                 RPCResults{},</span></a>
<a name="502"><span class="lineNum">     502 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">          9 :                 RPCExamples{</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="503"><span class="lineNum">     503 </span>                :            :             &quot;\nImport a public key with rescan\n&quot;</a>
<a name="504"><span class="lineNum">     504 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :             + HelpExampleCli(&quot;importpubkey&quot;, &quot;\&quot;mypubkey\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>][<span class="branchNoExec" title="Branch 33 was not executed"> # </span><span class="branchNoExec" title="Branch 34 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<a name="505"><span class="lineNum">     505 </span>                :            :             &quot;\nImport using a label without rescan\n&quot;</a>
<a name="506"><span class="lineNum">     506 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         21 :             + HelpExampleCli(&quot;importpubkey&quot;, &quot;\&quot;mypubkey\&quot; \&quot;testing\&quot; false&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 29 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 30 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>][<span class="branchNoCov" title="Branch 33 was not taken"> - </span><span class="branchCov" title="Branch 34 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 47 was not executed"> # </span><span class="branchNoExec" title="Branch 48 was not executed"> # </span>]
<a name="507"><span class="lineNum">     507 </span>                :            :             &quot;\nAs a JSON-RPC call\n&quot;</a>
<a name="508"><span class="lineNum">     508 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         21 :             + HelpExampleRpc(&quot;importpubkey&quot;, &quot;\&quot;mypubkey\&quot;, \&quot;testing\&quot;, false&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 20 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 22 was not taken"> - </span><span class="branchCov" title="Branch 23 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 26 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>][<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="509"><span class="lineNum">     509 </span>                :            :                 },</a>
<a name="510"><span class="lineNum">     510 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">         21 :             }.ToString());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="511"><span class="lineNum">     511 </span>                :            : </a>
<a name="512"><span class="lineNum">     512 </span>                :            : </a>
<a name="513"><span class="lineNum">     513 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span>]:<span class="lineCov">         20 :     std::string strLabel;</span></a>
<a name="514"><span class="lineNum">     514 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 7 times"> + </span><span class="branchCov" title="Branch 4 was taken 11 times"> + </span>]:<span class="lineCov">         18 :     if (!request.params[1].isNull())</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 7 times"> + </span><span class="branchCov" title="Branch 6 was taken 11 times"> + </span>]
<a name="515"><span class="lineNum">     515 </span>[<span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          7 :         strLabel = request.params[1].get_str();</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="516"><span class="lineNum">     516 </span>                :            : </a>
<a name="517"><span class="lineNum">     517 </span>                :            :     // Whether to perform rescan after import</a>
<a name="518"><span class="lineNum">     518 </span>                :<span class="lineCov">         18 :     bool fRescan = true;</span></a>
<a name="519"><span class="lineNum">     519 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 7 times"> + </span><span class="branchCov" title="Branch 4 was taken 11 times"> + </span>]:<span class="lineCov">         18 :     if (!request.params[2].isNull())</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 7 times"> + </span><span class="branchCov" title="Branch 6 was taken 11 times"> + </span>]
<a name="520"><span class="lineNum">     520 </span>[<span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          7 :         fRescan = request.params[2].get_bool();</span></a>
<a name="521"><span class="lineNum">     521 </span>                :            : </a>
<a name="522"><span class="lineNum">     522 </span>[<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 14 times"> + </span>]:<span class="lineCov">         18 :     if (fRescan &amp;&amp; pwallet-&gt;chain().havePruned()) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="523"><span class="lineNum">     523 </span>                :            :         // Exit early and print an error.</a>
<a name="524"><span class="lineNum">     524 </span>                :            :         // If a block is pruned after this check, we will import the key(s),</a>
<a name="525"><span class="lineNum">     525 </span>                :            :         // but fail the rescan with a generic error.</a>
<a name="526"><span class="lineNum">     526 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Rescan is disabled when blocks are pruned&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="527"><span class="lineNum">     527 </span>                :            :     }</a>
<a name="528"><span class="lineNum">     528 </span>                :            : </a>
<a name="529"><span class="lineNum">     529 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 10 times"> + </span>]:<span class="lineCov">         36 :     WalletRescanReserver reserver(pwallet);</span></a>
<a name="530"><span class="lineNum">     530 </span>[<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         18 :     if (fRescan &amp;&amp; !reserver.reserve()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="531"><span class="lineNum">     531 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Wallet is currently rescanning. Abort existing rescan or wait.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="532"><span class="lineNum">     532 </span>                :            :     }</a>
<a name="533"><span class="lineNum">     533 </span>                :            : </a>
<a name="534"><span class="lineNum">     534 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :     if (!IsHex(request.params[0].get_str()))</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 1 time"> + </span><span class="branchCov" title="Branch 10 was taken 17 times"> + </span>]
<a name="535"><span class="lineNum">     535 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Pubkey must be a hex string&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="536"><span class="lineNum">     536 </span>[<span class="branchCov" title="Branch 1 was taken 17 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 17 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         51 :     std::vector&lt;unsigned char&gt; data(ParseHex(request.params[0].get_str()));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 17 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 12 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="537"><span class="lineNum">     537 </span>                :<span class="lineCov">         51 :     CPubKey pubKey(data.begin(), data.end());</span></a>
<a name="538"><span class="lineNum">     538 </span>[<span class="branchCov" title="Branch 3 was taken 1 time"> + </span><span class="branchCov" title="Branch 4 was taken 16 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 17 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         17 :     if (!pubKey.IsFullyValid())</span></a>
<a name="539"><span class="lineNum">     539 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Pubkey is not a valid public key&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="540"><span class="lineNum">     540 </span>                :            : </a>
<a name="541"><span class="lineNum">     541 </span>                :<span class="lineCov">         16 :     {</span></a>
<a name="542"><span class="lineNum">     542 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 16 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         16 :         auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="543"><span class="lineNum">     543 </span>[<span class="branchCov" title="Branch 1 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         48 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="544"><span class="lineNum">     544 </span>                :            : </a>
<a name="545"><span class="lineNum">     545 </span>[<span class="branchCov" title="Branch 1 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 44 times"> + </span><span class="branchCov" title="Branch 4 was taken 16 times"> + </span>]:<span class="lineCov">         60 :         for (const auto&amp; dest : GetAllDestinationsForKey(pubKey)) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 44 times"> + </span><span class="branchCov" title="Branch 6 was taken 16 times"> + </span>]
<a name="546"><span class="lineNum">     546 </span>        [<span class="branchCov" title="Branch 1 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         44 :             ImportAddress(pwallet, dest, strLabel);</span></a>
<a name="547"><span class="lineNum">     547 </span>                :            :         }</a>
<a name="548"><span class="lineNum">     548 </span>[<span class="branchCov" title="Branch 4 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 6 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]:<span class="lineCov">         16 :         ImportScript(pwallet, GetScriptForRawPubKey(pubKey), strLabel, false);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchCov" title="Branch 1 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="549"><span class="lineNum">     549 </span>        [<span class="branchCov" title="Branch 1 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         16 :         pwallet-&gt;LearnAllRelatedScripts(pubKey);</span></a>
<a name="550"><span class="lineNum">     550 </span>                :            :     }</a>
<a name="551"><span class="lineNum">     551 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">         16 :     if (fRescan)</span></a>
<a name="552"><span class="lineNum">     552 </span>                :            :     {</a>
<a name="553"><span class="lineNum">     553 </span>        [<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         12 :         RescanWallet(*pwallet, reserver);</span></a>
<a name="554"><span class="lineNum">     554 </span>                :<span class="lineCov">         12 :         {</span></a>
<a name="555"><span class="lineNum">     555 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         12 :             auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="556"><span class="lineNum">     556 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         36 :             LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="557"><span class="lineNum">     557 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         24 :             pwallet-&gt;ReacceptWalletTransactions(*locked_chain);</span></a>
<a name="558"><span class="lineNum">     558 </span>                :            :         }</a>
<a name="559"><span class="lineNum">     559 </span>                :            :     }</a>
<a name="560"><span class="lineNum">     560 </span>                :            : </a>
<a name="561"><span class="lineNum">     561 </span>        [<span class="branchCov" title="Branch 1 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         16 :     return NullUniValue;</span></a>
<a name="562"><span class="lineNum">     562 </span>                :            : }</a>
<a name="563"><span class="lineNum">     563 </span>                :            : </a>
<a name="564"><span class="lineNum">     564 </span>                :            : </a>
<a name="565"><span class="lineNum">     565 </span>                :<span class="lineCov">          8 : UniValue importwallet(const JSONRPCRequest&amp; request)</span></a>
<a name="566"><span class="lineNum">     566 </span>                :            : {</a>
<a name="567"><span class="lineNum">     567 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         21 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="568"><span class="lineNum">     568 </span>        [<span class="branchCov" title="Branch 1 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          8 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="569"><span class="lineNum">     569 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 8 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          8 :     if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {</span></a>
<a name="570"><span class="lineNum">     570 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="571"><span class="lineNum">     571 </span>                :            :     }</a>
<a name="572"><span class="lineNum">     572 </span>                :            : </a>
<a name="573"><span class="lineNum">     573 </span>[<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 5 times"> + </span>]:<span class="lineCov">          8 :     if (request.fHelp || request.params.size() != 1)</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 5 times"> + </span>]
<a name="574"><span class="lineNum">     574 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="575"><span class="lineNum">     575 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">          9 :             RPCHelpMan{&quot;importwallet&quot;,</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 34 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>][<span class="branchCov" title="Branch 37 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 40 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>][<span class="branchCov" title="Branch 43 was taken 3 times"> + </span><span class="branchCov" title="Branch 44 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 46 was not taken"> - </span><span class="branchCov" title="Branch 47 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 48 was not taken"> - </span><span class="branchCov" title="Branch 49 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 50 was not taken"> - </span><span class="branchCov" title="Branch 51 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 54 was not taken"> - </span><span class="branchCov" title="Branch 55 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 56 was not taken"> - </span><span class="branchCov" title="Branch 57 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 58 was not taken"> - </span><span class="branchCov" title="Branch 59 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 60 was not taken"> - </span><span class="branchCov" title="Branch 61 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 62 was not taken"> - </span><span class="branchCov" title="Branch 63 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 67 was not executed"> # </span><span class="branchNoExec" title="Branch 68 was not executed"> # </span>][<span class="branchNoExec" title="Branch 70 was not executed"> # </span><span class="branchNoExec" title="Branch 71 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 72 was not executed"> # </span><span class="branchNoExec" title="Branch 73 was not executed"> # </span>][<span class="branchNoExec" title="Branch 74 was not executed"> # </span><span class="branchNoExec" title="Branch 75 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 78 was not executed"> # </span><span class="branchNoExec" title="Branch 79 was not executed"> # </span>][<span class="branchNoExec" title="Branch 80 was not executed"> # </span><span class="branchNoExec" title="Branch 81 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 82 was not executed"> # </span><span class="branchNoExec" title="Branch 83 was not executed"> # </span>][<span class="branchNoExec" title="Branch 84 was not executed"> # </span><span class="branchNoExec" title="Branch 85 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 86 was not executed"> # </span><span class="branchNoExec" title="Branch 87 was not executed"> # </span>][<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="576"><span class="lineNum">     576 </span>                :            :                 &quot;\nImports keys from a wallet dump file (see dumpwallet). Requires a new wallet backup to include imported keys.\n&quot;</a>
<a name="577"><span class="lineNum">     577 </span>                :            :                 &quot;Note: Use \&quot;getwalletinfo\&quot; to query the scanning progress.\n&quot;,</a>
<a name="578"><span class="lineNum">     578 </span>                :            :                 {</a>
<a name="579"><span class="lineNum">     579 </span>                :            :                     {&quot;filename&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The wallet file&quot;},</a>
<a name="580"><span class="lineNum">     580 </span>                :            :                 },</a>
<a name="581"><span class="lineNum">     581 </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :                 RPCResults{},</span></a>
<a name="582"><span class="lineNum">     582 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">          9 :                 RPCExamples{</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="583"><span class="lineNum">     583 </span>                :            :             &quot;\nDump the wallet\n&quot;</a>
<a name="584"><span class="lineNum">     584 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :             + HelpExampleCli(&quot;dumpwallet&quot;, &quot;\&quot;test\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>][<span class="branchNoExec" title="Branch 33 was not executed"> # </span><span class="branchNoExec" title="Branch 34 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<a name="585"><span class="lineNum">     585 </span>                :            :             &quot;\nImport the wallet\n&quot;</a>
<a name="586"><span class="lineNum">     586 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :             + HelpExampleCli(&quot;importwallet&quot;, &quot;\&quot;test\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 33 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 34 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>][<span class="branchNoExec" title="Branch 37 was not executed"> # </span><span class="branchNoExec" title="Branch 38 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 39 was not executed"> # </span><span class="branchNoExec" title="Branch 40 was not executed"> # </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 47 was not executed"> # </span><span class="branchNoExec" title="Branch 48 was not executed"> # </span>]
<a name="587"><span class="lineNum">     587 </span>                :            :             &quot;\nImport using the json rpc call\n&quot;</a>
<a name="588"><span class="lineNum">     588 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :             + HelpExampleRpc(&quot;importwallet&quot;, &quot;\&quot;test\&quot;&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchCov" title="Branch 21 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 28 was not taken"> - </span><span class="branchCov" title="Branch 29 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="589"><span class="lineNum">     589 </span>                :            :                 },</a>
<a name="590"><span class="lineNum">     590 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">         15 :             }.ToString());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="591"><span class="lineNum">     591 </span>                :            : </a>
<a name="592"><span class="lineNum">     592 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          5 :     if (pwallet-&gt;chain().havePruned()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 5 times"> + </span>]
<a name="593"><span class="lineNum">     593 </span>                :            :         // Exit early and print an error.</a>
<a name="594"><span class="lineNum">     594 </span>                :            :         // If a block is pruned after this check, we will import the key(s),</a>
<a name="595"><span class="lineNum">     595 </span>                :            :         // but fail the rescan with a generic error.</a>
<a name="596"><span class="lineNum">     596 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Importing wallets is disabled when blocks are pruned&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="597"><span class="lineNum">     597 </span>                :            :     }</a>
<a name="598"><span class="lineNum">     598 </span>                :            : </a>
<a name="599"><span class="lineNum">     599 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         10 :     WalletRescanReserver reserver(pwallet);</span></a>
<a name="600"><span class="lineNum">     600 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 5 times"> + </span>]:<span class="lineCov">          5 :     if (!reserver.reserve()) {</span></a>
<a name="601"><span class="lineNum">     601 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Wallet is currently rescanning. Abort existing rescan or wait.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="602"><span class="lineNum">     602 </span>                :            :     }</a>
<a name="603"><span class="lineNum">     603 </span>                :            : </a>
<a name="604"><span class="lineNum">     604 </span>                :<span class="lineCov">          5 :     int64_t nTimeBegin = 0;</span></a>
<a name="605"><span class="lineNum">     605 </span>                :<span class="lineCov">          5 :     bool fGood = true;</span></a>
<a name="606"><span class="lineNum">     606 </span>                :<span class="lineCov">          5 :     {</span></a>
<a name="607"><span class="lineNum">     607 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          5 :         auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="608"><span class="lineNum">     608 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         10 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="609"><span class="lineNum">     609 </span>                :            : </a>
<a name="610"><span class="lineNum">     610 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :         EnsureWalletIsUnlocked(pwallet);</span></a>
<a name="611"><span class="lineNum">     611 </span>                :            : </a>
<a name="612"><span class="lineNum">     612 </span>  [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         10 :         fsbridge::ifstream file;</span></a>
<a name="613"><span class="lineNum">     613 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          5 :         file.open(request.params[0].get_str(), std::ios::in | std::ios::ate);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="614"><span class="lineNum">     614 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 5 times"> + </span>]:<span class="lineCov">         10 :         if (!file.is_open()) {</span></a>
<a name="615"><span class="lineNum">     615 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Cannot open wallet dump file&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="616"><span class="lineNum">     616 </span>                :            :         }</a>
<a name="617"><span class="lineNum">     617 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         10 :         Optional&lt;int&gt; tip_height = locked_chain-&gt;getHeight();</span></a>
<a name="618"><span class="lineNum">     618 </span>[<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         10 :         nTimeBegin = tip_height ? locked_chain-&gt;getBlockTime(*tip_height) : 0;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 8 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 11 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>]
<a name="619"><span class="lineNum">     619 </span>                :            : </a>
<a name="620"><span class="lineNum">     620 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          5 :         int64_t nFilesize = std::max((int64_t)1, (int64_t)file.tellg());</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="621"><span class="lineNum">     621 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :         file.seekg(0, file.beg);</span></a>
<a name="622"><span class="lineNum">     622 </span>                :            : </a>
<a name="623"><span class="lineNum">     623 </span>                :            :         // Use uiInterface.ShowProgress instead of pwallet.ShowProgress because pwallet.ShowProgress has a cancel button tied to AbortRescan which</a>
<a name="624"><span class="lineNum">     624 </span>                :            :         // we don't want for this progress bar showing the import progress. uiInterface.ShowProgress does not have a cancel button.</a>
<a name="625"><span class="lineNum">     625 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         10 :         pwallet-&gt;chain().showProgress(strprintf(&quot;%s &quot; + _(&quot;Importing...&quot;), pwallet-&gt;GetDisplayName()), 0, false); // show progress dialog in GUI</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 17 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span>][<span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 5 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 23 was taken 4 times"> + </span><span class="branchCov" title="Branch 24 was taken 1 time"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>][<span class="branchNoExec" title="Branch 27 was not executed"> # </span><span class="branchNoExec" title="Branch 28 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 29 was not executed"> # </span><span class="branchNoExec" title="Branch 30 was not executed"> # </span>][<span class="branchNoExec" title="Branch 31 was not executed"> # </span><span class="branchNoExec" title="Branch 32 was not executed"> # </span>]
<a name="626"><span class="lineNum">     626 </span>                :<span class="lineCov">         10 :         std::vector&lt;std::tuple&lt;CKey, int64_t, bool, std::string&gt;&gt; keys;</span></a>
<a name="627"><span class="lineNum">     627 </span>                :<span class="lineCov">         10 :         std::vector&lt;std::pair&lt;CScript, int64_t&gt;&gt; scripts;</span></a>
<a name="628"><span class="lineNum">     628 </span>[<span class="branchCov" title="Branch 0 was taken 1740 times"> + </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1740 times"> + </span><span class="branchCov" title="Branch 3 was taken 5 times"> + </span>]:<span class="lineCov">       3490 :         while (file.good()) {</span></a>
<a name="629"><span class="lineNum">     629 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1740 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 1740 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       5856 :             pwallet-&gt;chain().showProgress(&quot;&quot;, std::max(1, std::min(50, (int)(((double)file.tellg() / (double)nFilesize) * 100))), false);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 734 times"> + </span><span class="branchCov" title="Branch 6 was taken 1006 times"> + </span>][<span class="branchCov" title="Branch 7 was taken 734 times"> + </span><span class="branchCov" title="Branch 8 was taken 1006 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 9 was taken 1691 times"> + </span><span class="branchCov" title="Branch 10 was taken 49 times"> + </span>][<span class="branchCov" title="Branch 12 was taken 1740 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 15 was taken 1740 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>][<span class="branchCov" title="Branch 18 was taken 1740 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchCov" title="Branch 21 was taken 1740 times"> + </span>][<span class="branchCov" title="Branch 23 was taken 1740 times"> + </span><span class="branchNoCov" title="Branch 24 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>]
<a name="630"><span class="lineNum">     630 </span>[<span class="branchCov" title="Branch 1 was taken 1740 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineCov">       1740 :             std::string line;</span></a>
<a name="631"><span class="lineNum">     631 </span>        [<span class="branchCov" title="Branch 1 was taken 1740 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">       1740 :             std::getline(file, line);</span></a>
<a name="632"><span class="lineNum">     632 </span>[<span class="branchCov" title="Branch 0 was taken 1716 times"> + </span><span class="branchCov" title="Branch 1 was taken 24 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1716 times"> + </span><span class="branchCov" title="Branch 3 was taken 24 times"> + </span>]:<span class="lineCov">       3480 :             if (line.empty() || line[0] == '#')</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 1687 times"> + </span><span class="branchCov" title="Branch 5 was taken 29 times"> + </span>][<span class="branchCov" title="Branch 6 was taken 1687 times"> + </span><span class="branchCov" title="Branch 7 was taken 29 times"> + </span>]
<a name="633"><span class="lineNum">     633 </span>        [<span class="branchCov" title="Branch 0 was taken 24 times"> + </span><span class="branchCov" title="Branch 1 was taken 29 times"> + </span>]:<span class="lineCov">         53 :                 continue;</span></a>
<a name="634"><span class="lineNum">     634 </span>                :            : </a>
<a name="635"><span class="lineNum">     635 </span>  [<span class="branchCov" title="Branch 1 was taken 1687 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 1687 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       3374 :             std::vector&lt;std::string&gt; vstr;</span></a>
<a name="636"><span class="lineNum">     636 </span>[<span class="branchCov" title="Branch 1 was taken 1687 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1687 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1687 :             boost::split(vstr, line, boost::is_any_of(&quot; &quot;));</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 1687 times"> + </span>][<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>]
<a name="637"><span class="lineNum">     637 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1687 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 1687 times"> + </span>]:<span class="lineCov">       3374 :             if (vstr.size() &lt; 2)</span></a>
<a name="638"><span class="lineNum">     638 </span>                :<span class="lineNoCov">          0 :                 continue;</span></a>
<a name="639"><span class="lineNum">     639 </span>[<span class="branchCov" title="Branch 1 was taken 1687 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1687 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       5061 :             CKey key = DecodeSecret(vstr[0]);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 6 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span>]
<a name="640"><span class="lineNum">     640 </span>[<span class="branchCov" title="Branch 0 was taken 843 times"> + </span><span class="branchCov" title="Branch 1 was taken 844 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 843 times"> + </span><span class="branchCov" title="Branch 3 was taken 844 times"> + </span>]:<span class="lineCov">       3374 :             if (key.IsValid()) {</span></a>
<a name="641"><span class="lineNum">     641 </span>[<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1686 :                 int64_t nTime = DecodeDumpTime(vstr[1]);</span></a>
<a name="642"><span class="lineNum">     642 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineCov">        843 :                 std::string strLabel;</span></a>
<a name="643"><span class="lineNum">     643 </span>                :<span class="lineCov">        843 :                 bool fLabel = true;</span></a>
<a name="644"><span class="lineNum">     644 </span>[<span class="branchCov" title="Branch 0 was taken 1686 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 1686 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1686 :                 for (unsigned int nStr = 2; nStr &lt; vstr.size(); nStr++) {</span></a>
<a name="645"><span class="lineNum">     645 </span>[<span class="branchCov" title="Branch 0 was taken 843 times"> + </span><span class="branchCov" title="Branch 1 was taken 843 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 843 times"> + </span><span class="branchCov" title="Branch 3 was taken 843 times"> + </span>]:<span class="lineCov">       5058 :                     if (vstr[nStr].front() == '#')</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 4 was taken 843 times"> + </span><span class="branchCov" title="Branch 5 was taken 843 times"> + </span>]
<a name="646"><span class="lineNum">     646 </span>                :            :                         break;</a>
<a name="647"><span class="lineNum">     647 </span>        [<span class="branchCov" title="Branch 1 was taken 14 times"> + </span><span class="branchCov" title="Branch 2 was taken 829 times"> + </span>]:<span class="lineCov">        843 :                     if (vstr[nStr] == &quot;change=1&quot;)</span></a>
<a name="648"><span class="lineNum">     648 </span>                :<span class="lineCov">         14 :                         fLabel = false;</span></a>
<a name="649"><span class="lineNum">     649 </span>        [<span class="branchCov" title="Branch 2 was taken 777 times"> + </span><span class="branchCov" title="Branch 3 was taken 66 times"> + </span>]:<span class="lineCov">       1686 :                     if (vstr[nStr] == &quot;reserve=1&quot;)</span></a>
<a name="650"><span class="lineNum">     650 </span>                :<span class="lineCov">        777 :                         fLabel = false;</span></a>
<a name="651"><span class="lineNum">     651 </span>[<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1686 :                     if (vstr[nStr].substr(0,6) == &quot;label=&quot;) {</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 843 times"> + </span>][<span class="branchCov" title="Branch 9 was taken 48 times"> + </span><span class="branchCov" title="Branch 10 was taken 795 times"> + </span>]
<a name="652"><span class="lineNum">     652 </span>[<span class="branchCov" title="Branch 1 was taken 48 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 48 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         96 :                         strLabel = DecodeDumpString(vstr[nStr].substr(6));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 48 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 10 was not taken"> - </span><span class="branchCov" title="Branch 11 was taken 48 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 48 times"> + </span>][<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="653"><span class="lineNum">     653 </span>                :<span class="lineCov">         48 :                         fLabel = true;</span></a>
<a name="654"><span class="lineNum">     654 </span>                :            :                     }</a>
<a name="655"><span class="lineNum">     655 </span>                :            :                 }</a>
<a name="656"><span class="lineNum">     656 </span>[<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        843 :                 keys.push_back(std::make_tuple(key, nTime, fLabel, strLabel));</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 843 times"> + </span>]
<a name="657"><span class="lineNum">     657 </span>[<span class="branchCov" title="Branch 1 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1688 :             } else if(IsHex(vstr[0])) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 6 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="658"><span class="lineNum">     658 </span>[<span class="branchCov" title="Branch 1 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1688 :                 std::vector&lt;unsigned char&gt; vData(ParseHex(vstr[0]));</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 6 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span>]
<a name="659"><span class="lineNum">     659 </span>[<span class="branchCov" title="Branch 5 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]:<span class="lineCov">       5064 :                 CScript script = CScript(vData.begin(), vData.end());</span></a>
<a name="660"><span class="lineNum">     660 </span>  [<span class="branchCov" title="Branch 1 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1688 :                 int64_t birth_time = DecodeDumpTime(vstr[1]);</span></a>
<a name="661"><span class="lineNum">     661 </span>[<span class="branchCov" title="Branch 2 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 844 times"> + </span>]:<span class="lineCov">        844 :                 scripts.push_back(std::pair&lt;CScript, int64_t&gt;(script, birth_time));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 1 time"> + </span><span class="branchCov" title="Branch 7 was taken 843 times"> + </span>][<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>]
<a name="662"><span class="lineNum">     662 </span>                :            :             }</a>
<a name="663"><span class="lineNum">     663 </span>                :            :         }</a>
<a name="664"><span class="lineNum">     664 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :         file.close();</span></a>
<a name="665"><span class="lineNum">     665 </span>                :            :         // We now know whether we are importing private keys, so we can error if private keys are disabled</a>
<a name="666"><span class="lineNum">     666 </span>[<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         10 :         if (keys.size() &gt; 0 &amp;&amp; pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="667"><span class="lineNum">     667 </span>[<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineNoCov">          0 :             pwallet-&gt;chain().showProgress(&quot;&quot;, 100, false); // hide progress dialog in GUI</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 6 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span>][<span class="branchNoExec" title="Branch 9 was not executed"> # </span><span class="branchNoExec" title="Branch 10 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>][<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="668"><span class="lineNum">     668 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Importing wallets is disabled when private keys are disabled&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="669"><span class="lineNum">     669 </span>                :            :         }</a>
<a name="670"><span class="lineNum">     670 </span>                :<span class="lineCov">         10 :         double total = (double)(keys.size() + scripts.size());</span></a>
<a name="671"><span class="lineNum">     671 </span>                :<span class="lineCov">          5 :         double progress = 0;</span></a>
<a name="672"><span class="lineNum">     672 </span>[<span class="branchCov" title="Branch 0 was taken 843 times"> + </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 843 times"> + </span><span class="branchCov" title="Branch 3 was taken 5 times"> + </span>]:<span class="lineCov">        858 :         for (const auto&amp; key_tuple : keys) {</span></a>
<a name="673"><span class="lineNum">     673 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 843 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 424 times"> + </span><span class="branchCov" title="Branch 3 was taken 419 times"> + </span>]:<span class="lineCov">       2911 :             pwallet-&gt;chain().showProgress(&quot;&quot;, std::max(50, std::min(75, (int)((progress / total) * 100) + 50)), false);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 822 times"> + </span><span class="branchCov" title="Branch 5 was taken 21 times"> + </span>][<span class="branchCov" title="Branch 7 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 843 times"> + </span>][<span class="branchCov" title="Branch 18 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 20 was not executed"> # </span><span class="branchNoExec" title="Branch 21 was not executed"> # </span>]
<a name="674"><span class="lineNum">     674 </span>        [<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        843 :             const CKey&amp; key = std::get&lt;0&gt;(key_tuple);</span></a>
<a name="675"><span class="lineNum">     675 </span>        [<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        843 :             int64_t time = std::get&lt;1&gt;(key_tuple);</span></a>
<a name="676"><span class="lineNum">     676 </span>        [<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        843 :             bool has_label = std::get&lt;2&gt;(key_tuple);</span></a>
<a name="677"><span class="lineNum">     677 </span>[<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1686 :             std::string label = std::get&lt;3&gt;(key_tuple);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 6 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span>]
<a name="678"><span class="lineNum">     678 </span>                :            : </a>
<a name="679"><span class="lineNum">     679 </span>        [<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        843 :             CPubKey pubkey = key.GetPubKey();</span></a>
<a name="680"><span class="lineNum">     680 </span>[<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 843 times"> + </span>]:<span class="lineCov">        843 :             assert(key.VerifyPubKey(pubkey));</span></a>
<a name="681"><span class="lineNum">     681 </span>        [<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        843 :             CKeyID keyid = pubkey.GetID();</span></a>
<a name="682"><span class="lineNum">     682 </span>[<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 843 times"> + </span>]:<span class="lineCov">        843 :             if (pwallet-&gt;HaveKey(keyid)) {</span></a>
<a name="683"><span class="lineNum">     683 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 pwallet-&gt;WalletLogPrintf(&quot;Skipping import of %s (key already present)\n&quot;, EncodeDestination(PKHash(keyid)));</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>][<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 18 was not executed"> # </span><span class="branchNoExec" title="Branch 19 was not executed"> # </span>][<span class="branchNoExec" title="Branch 20 was not executed"> # </span><span class="branchNoExec" title="Branch 21 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 22 was not executed"> # </span><span class="branchNoExec" title="Branch 23 was not executed"> # </span>][<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 27 was not executed"> # </span><span class="branchNoExec" title="Branch 28 was not executed"> # </span>][<span class="branchNoExec" title="Branch 29 was not executed"> # </span><span class="branchNoExec" title="Branch 30 was not executed"> # </span>]
<a name="684"><span class="lineNum">     684 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 continue;</span></a>
<a name="685"><span class="lineNum">     685 </span>                :            :             }</a>
<a name="686"><span class="lineNum">     686 </span>[<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       5058 :             pwallet-&gt;WalletLogPrintf(&quot;Importing %s...\n&quot;, EncodeDestination(PKHash(keyid)));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 20 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 27 was not executed"> # </span><span class="branchNoExec" title="Branch 28 was not executed"> # </span>][<span class="branchNoExec" title="Branch 29 was not executed"> # </span><span class="branchNoExec" title="Branch 30 was not executed"> # </span>]
<a name="687"><span class="lineNum">     687 </span>[<span class="branchCov" title="Branch 3 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>][<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        843 :             if (!pwallet-&gt;AddKeyPubKey(key, pubkey)) {</span></a>
<a name="688"><span class="lineNum">     688 </span>                :            :                 fGood = false;</a>
<a name="689"><span class="lineNum">     689 </span>                :            :                 continue;</a>
<a name="690"><span class="lineNum">     690 </span>                :            :             }</a>
<a name="691"><span class="lineNum">     691 </span>        [<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        843 :             pwallet-&gt;mapKeyMetadata[keyid].nCreateTime = time;</span></a>
<a name="692"><span class="lineNum">     692 </span>        [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchCov" title="Branch 1 was taken 791 times"> + </span>]:<span class="lineCov">        843 :             if (has_label)</span></a>
<a name="693"><span class="lineNum">     693 </span>[<span class="branchCov" title="Branch 1 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        104 :                 pwallet-&gt;SetAddressBook(PKHash(keyid), label, &quot;receive&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchCov" title="Branch 17 was taken 52 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 19 was not executed"> # </span><span class="branchNoExec" title="Branch 20 was not executed"> # </span>]
<a name="694"><span class="lineNum">     694 </span>        [<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchCov" title="Branch 1 was taken 840 times"> + </span>]:<span class="lineCov">        843 :             nTimeBegin = std::min(nTimeBegin, time);</span></a>
<a name="695"><span class="lineNum">     695 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 843 times"> + </span>]:<span class="lineCov">        843 :             progress++;</span></a>
<a name="696"><span class="lineNum">     696 </span>                :            :         }</a>
<a name="697"><span class="lineNum">     697 </span>[<span class="branchCov" title="Branch 0 was taken 844 times"> + </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 844 times"> + </span><span class="branchCov" title="Branch 3 was taken 5 times"> + </span>]:<span class="lineCov">        859 :         for (const auto&amp; script_pair : scripts) {</span></a>
<a name="698"><span class="lineNum">     698 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 844 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 844 times"> + </span>]:<span class="lineCov">       2532 :             pwallet-&gt;chain().showProgress(&quot;&quot;, std::max(50, std::min(75, (int)((progress / total) * 100) + 50)), false);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 844 times"> + </span>][<span class="branchCov" title="Branch 18 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 20 was not executed"> # </span><span class="branchNoExec" title="Branch 21 was not executed"> # </span>]
<a name="699"><span class="lineNum">     699 </span>                :<span class="lineCov">        844 :             const CScript&amp; script = script_pair.first;</span></a>
<a name="700"><span class="lineNum">     700 </span>                :<span class="lineCov">        844 :             int64_t time = script_pair.second;</span></a>
<a name="701"><span class="lineNum">     701 </span>        [<span class="branchCov" title="Branch 1 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        844 :             CScriptID id(script);</span></a>
<a name="702"><span class="lineNum">     702 </span>[<span class="branchCov" title="Branch 1 was taken 844 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 843 times"> + </span><span class="branchCov" title="Branch 4 was taken 1 time"> + </span>]:<span class="lineCov">        844 :             if (pwallet-&gt;HaveCScript(id)) {</span></a>
<a name="703"><span class="lineNum">     703 </span>[<span class="branchCov" title="Branch 1 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       2529 :                 pwallet-&gt;WalletLogPrintf(&quot;Skipping import of %s (script already present)\n&quot;, HexStr(script));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 14 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 843 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchNoExec" title="Branch 18 was not executed"> # </span><span class="branchNoExec" title="Branch 19 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 20 was not executed"> # </span><span class="branchNoExec" title="Branch 21 was not executed"> # </span>][<span class="branchNoExec" title="Branch 22 was not executed"> # </span><span class="branchNoExec" title="Branch 23 was not executed"> # </span>]
<a name="704"><span class="lineNum">     704 </span>                :<span class="lineCov">        843 :                 continue;</span></a>
<a name="705"><span class="lineNum">     705 </span>                :            :             }</a>
<a name="706"><span class="lineNum">     706 </span>[<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 1 time"> + </span>]:<span class="lineCov">          1 :             if(!pwallet-&gt;AddCScript(script)) {</span></a>
<a name="707"><span class="lineNum">     707 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 pwallet-&gt;WalletLogPrintf(&quot;Error importing script %s\n&quot;, HexStr(script));</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>][<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>][<span class="branchNoExec" title="Branch 18 was not executed"> # </span><span class="branchNoExec" title="Branch 19 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 20 was not executed"> # </span><span class="branchNoExec" title="Branch 21 was not executed"> # </span>][<span class="branchNoExec" title="Branch 22 was not executed"> # </span><span class="branchNoExec" title="Branch 23 was not executed"> # </span>]
<a name="708"><span class="lineNum">     708 </span>                :<span class="lineNoCov">          0 :                 fGood = false;</span></a>
<a name="709"><span class="lineNum">     709 </span>                :<span class="lineNoCov">          0 :                 continue;</span></a>
<a name="710"><span class="lineNum">     710 </span>                :            :             }</a>
<a name="711"><span class="lineNum">     711 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>]:<span class="lineCov">          1 :             if (time &gt; 0) {</span></a>
<a name="712"><span class="lineNum">     712 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 pwallet-&gt;m_script_metadata[id].nCreateTime = time;</span></a>
<a name="713"><span class="lineNum">     713 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 nTimeBegin = std::min(nTimeBegin, time);</span></a>
<a name="714"><span class="lineNum">     714 </span>                :            :             }</a>
<a name="715"><span class="lineNum">     715 </span>                :<span class="lineCov">          1 :             progress++;</span></a>
<a name="716"><span class="lineNum">     716 </span>                :            :         }</a>
<a name="717"><span class="lineNum">     717 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          5 :         pwallet-&gt;chain().showProgress(&quot;&quot;, 100, false); // hide progress dialog in GUI</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 14 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<a name="718"><span class="lineNum">     718 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :         pwallet-&gt;UpdateTimeFirstKey(nTimeBegin);</span></a>
<a name="719"><span class="lineNum">     719 </span>                :            :     }</a>
<a name="720"><span class="lineNum">     720 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          5 :     pwallet-&gt;chain().showProgress(&quot;&quot;, 100, false); // hide progress dialog in GUI</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 14 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<a name="721"><span class="lineNum">     721 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :     RescanWallet(*pwallet, reserver, nTimeBegin, false /* update */);</span></a>
<a name="722"><span class="lineNum">     722 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :     pwallet-&gt;MarkDirty();</span></a>
<a name="723"><span class="lineNum">     723 </span>                :            : </a>
<a name="724"><span class="lineNum">     724 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>]:<span class="lineCov">          5 :     if (!fGood)</span></a>
<a name="725"><span class="lineNum">     725 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error adding some keys/scripts to wallet&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="726"><span class="lineNum">     726 </span>                :            : </a>
<a name="727"><span class="lineNum">     727 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :     return NullUniValue;</span></a>
<a name="728"><span class="lineNum">     728 </span>                :            : }</a>
<a name="729"><span class="lineNum">     729 </span>                :            : </a>
<a name="730"><span class="lineNum">     730 </span>                :<span class="lineCov">        180 : UniValue dumpprivkey(const JSONRPCRequest&amp; request)</span></a>
<a name="731"><span class="lineNum">     731 </span>                :            : {</a>
<a name="732"><span class="lineNum">     732 </span>[<span class="branchCov" title="Branch 1 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        532 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="733"><span class="lineNum">     733 </span>        [<span class="branchCov" title="Branch 1 was taken 180 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        180 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="734"><span class="lineNum">     734 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 180 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 180 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        180 :     if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {</span></a>
<a name="735"><span class="lineNum">     735 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="736"><span class="lineNum">     736 </span>                :            :     }</a>
<a name="737"><span class="lineNum">     737 </span>                :            : </a>
<a name="738"><span class="lineNum">     738 </span>[<span class="branchCov" title="Branch 0 was taken 177 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 177 times"> + </span>]:<span class="lineCov">        180 :     if (request.fHelp || request.params.size() != 1)</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 177 times"> + </span>]
<a name="739"><span class="lineNum">     739 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="740"><span class="lineNum">     740 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">         18 :             RPCHelpMan{&quot;dumpprivkey&quot;,</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 34 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>][<span class="branchCov" title="Branch 37 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span>]
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 40 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 43 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 44 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 46 was taken 3 times"> + </span><span class="branchCov" title="Branch 47 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 51 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 52 was not taken"> - </span>][<span class="branchCov" title="Branch 53 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 54 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 63 was not taken"> - </span><span class="branchCov" title="Branch 64 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 69 was not executed"> # </span><span class="branchNoExec" title="Branch 70 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 72 was not executed"> # </span><span class="branchNoExec" title="Branch 73 was not executed"> # </span>][<span class="branchNoExec" title="Branch 74 was not executed"> # </span><span class="branchNoExec" title="Branch 75 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 76 was not executed"> # </span><span class="branchNoExec" title="Branch 77 was not executed"> # </span>][<span class="branchNoExec" title="Branch 80 was not executed"> # </span><span class="branchNoExec" title="Branch 81 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 82 was not executed"> # </span><span class="branchNoExec" title="Branch 83 was not executed"> # </span>][<span class="branchNoExec" title="Branch 84 was not executed"> # </span><span class="branchNoExec" title="Branch 85 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 86 was not executed"> # </span><span class="branchNoExec" title="Branch 87 was not executed"> # </span>][<span class="branchNoExec" title="Branch 88 was not executed"> # </span><span class="branchNoExec" title="Branch 89 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="741"><span class="lineNum">     741 </span>                :            :                 &quot;\nReveals the private key corresponding to 'address'.\n&quot;</a>
<a name="742"><span class="lineNum">     742 </span>                :            :                 &quot;Then the importprivkey can be used with this output\n&quot;,</a>
<a name="743"><span class="lineNum">     743 </span>                :            :                 {</a>
<a name="744"><span class="lineNum">     744 </span>                :            :                     {&quot;address&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The bitcoin address for the private key&quot;},</a>
<a name="745"><span class="lineNum">     745 </span>                :            :                 },</a>
<a name="746"><span class="lineNum">     746 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :                 RPCResult{</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>]
<a name="747"><span class="lineNum">     747 </span>                :            :             &quot;\&quot;key\&quot;                (string) The private key\n&quot;</a>
<a name="748"><span class="lineNum">     748 </span>                :            :                 },</a>
<a name="749"><span class="lineNum">     749 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">          9 :                 RPCExamples{</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="750"><span class="lineNum">     750 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :                     HelpExampleCli(&quot;dumpprivkey&quot;, &quot;\&quot;myaddress\&quot;&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 21 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>][<span class="branchNoExec" title="Branch 23 was not executed"> # </span><span class="branchNoExec" title="Branch 24 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>][<span class="branchNoExec" title="Branch 27 was not executed"> # </span><span class="branchNoExec" title="Branch 28 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 29 was not executed"> # </span><span class="branchNoExec" title="Branch 30 was not executed"> # </span>][<span class="branchNoExec" title="Branch 31 was not executed"> # </span><span class="branchNoExec" title="Branch 32 was not executed"> # </span>]
<a name="751"><span class="lineNum">     751 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :             + HelpExampleCli(&quot;importprivkey&quot;, &quot;\&quot;mykey\&quot;&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 20 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 22 was not taken"> - </span><span class="branchCov" title="Branch 23 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 30 was not executed"> # </span><span class="branchNoExec" title="Branch 31 was not executed"> # </span>][<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>][<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>][<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="752"><span class="lineNum">     752 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :             + HelpExampleRpc(&quot;dumpprivkey&quot;, &quot;\&quot;myaddress\&quot;&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchCov" title="Branch 21 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 28 was not taken"> - </span><span class="branchCov" title="Branch 29 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="753"><span class="lineNum">     753 </span>                :            :                 },</a>
<a name="754"><span class="lineNum">     754 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">         15 :             }.ToString());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="755"><span class="lineNum">     755 </span>                :            : </a>
<a name="756"><span class="lineNum">     756 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 177 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 177 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        187 :     auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="757"><span class="lineNum">     757 </span>[<span class="branchCov" title="Branch 1 was taken 177 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        359 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="758"><span class="lineNum">     758 </span>                :            : </a>
<a name="759"><span class="lineNum">     759 </span>        [<span class="branchCov" title="Branch 1 was taken 174 times"> + </span><span class="branchCov" title="Branch 2 was taken 3 times"> + </span>]:<span class="lineCov">        177 :     EnsureWalletIsUnlocked(pwallet);</span></a>
<a name="760"><span class="lineNum">     760 </span>                :            : </a>
<a name="761"><span class="lineNum">     761 </span>[<span class="branchCov" title="Branch 1 was taken 174 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 174 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        349 :     std::string strAddress = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 174 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 11 was taken 1 time"> + </span><span class="branchCov" title="Branch 12 was taken 1 time"> + </span>]
<a name="762"><span class="lineNum">     762 </span>  [<span class="branchCov" title="Branch 1 was taken 174 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        348 :     CTxDestination dest = DecodeDestination(strAddress);</span></a>
<a name="763"><span class="lineNum">     763 </span>[<span class="branchCov" title="Branch 1 was taken 174 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1 time"> + </span><span class="branchCov" title="Branch 4 was taken 173 times"> + </span>]:<span class="lineCov">        174 :     if (!IsValidDestination(dest)) {</span></a>
<a name="764"><span class="lineNum">     764 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid Bitcoin address&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="765"><span class="lineNum">     765 </span>                :            :     }</a>
<a name="766"><span class="lineNum">     766 </span>        [<span class="branchCov" title="Branch 1 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        173 :     auto keyid = GetKeyForDestination(*pwallet, dest);</span></a>
<a name="767"><span class="lineNum">     767 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 172 times"> + </span>]:<span class="lineCov">        173 :     if (keyid.IsNull()) {</span></a>
<a name="768"><span class="lineNum">     768 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :         throw JSONRPCError(RPC_TYPE_ERROR, &quot;Address does not refer to a key&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="769"><span class="lineNum">     769 </span>                :            :     }</a>
<a name="770"><span class="lineNum">     770 </span>[<span class="branchCov" title="Branch 1 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        344 :     CKey vchSecret;</span></a>
<a name="771"><span class="lineNum">     771 </span>[<span class="branchCov" title="Branch 1 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 172 times"> + </span>]:<span class="lineCov">        172 :     if (!pwallet-&gt;GetKey(keyid, vchSecret)) {</span></a>
<a name="772"><span class="lineNum">     772 </span>[<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>][<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Private key for address &quot; + strAddress + &quot; is not known&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>][<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="773"><span class="lineNum">     773 </span>                :            :     }</a>
<a name="774"><span class="lineNum">     774 </span>[<span class="branchCov" title="Branch 1 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        344 :     return EncodeSecret(vchSecret);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 8 was taken 172 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<a name="775"><span class="lineNum">     775 </span>                :            : }</a>
<a name="776"><span class="lineNum">     776 </span>                :            : </a>
<a name="777"><span class="lineNum">     777 </span>                :            : </a>
<a name="778"><span class="lineNum">     778 </span>                :<span class="lineCov">         10 : UniValue dumpwallet(const JSONRPCRequest&amp; request)</span></a>
<a name="779"><span class="lineNum">     779 </span>                :            : {</a>
<a name="780"><span class="lineNum">     780 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         26 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="781"><span class="lineNum">     781 </span>        [<span class="branchCov" title="Branch 1 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         10 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="782"><span class="lineNum">     782 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 10 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         10 :     if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {</span></a>
<a name="783"><span class="lineNum">     783 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="784"><span class="lineNum">     784 </span>                :            :     }</a>
<a name="785"><span class="lineNum">     785 </span>                :            : </a>
<a name="786"><span class="lineNum">     786 </span>[<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 7 times"> + </span>]:<span class="lineCov">         10 :     if (request.fHelp || request.params.size() != 1)</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 7 times"> + </span>]
<a name="787"><span class="lineNum">     787 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="788"><span class="lineNum">     788 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">         18 :             RPCHelpMan{&quot;dumpwallet&quot;,</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 34 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>][<span class="branchCov" title="Branch 37 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span>]
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 40 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 43 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 44 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 46 was taken 3 times"> + </span><span class="branchCov" title="Branch 47 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 51 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 52 was not taken"> - </span>][<span class="branchCov" title="Branch 53 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 54 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 63 was not taken"> - </span><span class="branchCov" title="Branch 64 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 69 was not executed"> # </span><span class="branchNoExec" title="Branch 70 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 72 was not executed"> # </span><span class="branchNoExec" title="Branch 73 was not executed"> # </span>][<span class="branchNoExec" title="Branch 74 was not executed"> # </span><span class="branchNoExec" title="Branch 75 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 76 was not executed"> # </span><span class="branchNoExec" title="Branch 77 was not executed"> # </span>][<span class="branchNoExec" title="Branch 80 was not executed"> # </span><span class="branchNoExec" title="Branch 81 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 82 was not executed"> # </span><span class="branchNoExec" title="Branch 83 was not executed"> # </span>][<span class="branchNoExec" title="Branch 84 was not executed"> # </span><span class="branchNoExec" title="Branch 85 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 86 was not executed"> # </span><span class="branchNoExec" title="Branch 87 was not executed"> # </span>][<span class="branchNoExec" title="Branch 88 was not executed"> # </span><span class="branchNoExec" title="Branch 89 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="789"><span class="lineNum">     789 </span>                :            :                 &quot;\nDumps all wallet keys in a human-readable format to a server-side file. This does not allow overwriting existing files.\n&quot;</a>
<a name="790"><span class="lineNum">     790 </span>                :            :                 &quot;Imported scripts are included in the dumpfile, but corresponding BIP173 addresses, etc. may not be added automatically by importwallet.\n&quot;</a>
<a name="791"><span class="lineNum">     791 </span>                :            :                 &quot;Note that if your wallet contains keys which are not derived from your HD seed (e.g. imported keys), these are not covered by\n&quot;</a>
<a name="792"><span class="lineNum">     792 </span>                :            :                 &quot;only backing up the seed itself, and must be backed up too (e.g. ensure you back up the whole dumpfile).\n&quot;,</a>
<a name="793"><span class="lineNum">     793 </span>                :            :                 {</a>
<a name="794"><span class="lineNum">     794 </span>                :            :                     {&quot;filename&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The filename with path (either absolute or relative to bitcoind)&quot;},</a>
<a name="795"><span class="lineNum">     795 </span>                :            :                 },</a>
<a name="796"><span class="lineNum">     796 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :                 RPCResult{</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>]
<a name="797"><span class="lineNum">     797 </span>                :            :             &quot;{                           (json object)\n&quot;</a>
<a name="798"><span class="lineNum">     798 </span>                :            :             &quot;  \&quot;filename\&quot; : {        (string) The filename with full absolute path\n&quot;</a>
<a name="799"><span class="lineNum">     799 </span>                :            :             &quot;}\n&quot;</a>
<a name="800"><span class="lineNum">     800 </span>                :            :                 },</a>
<a name="801"><span class="lineNum">     801 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">          9 :                 RPCExamples{</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="802"><span class="lineNum">     802 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :                     HelpExampleCli(&quot;dumpwallet&quot;, &quot;\&quot;test\&quot;&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 21 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>][<span class="branchNoExec" title="Branch 23 was not executed"> # </span><span class="branchNoExec" title="Branch 24 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>][<span class="branchNoExec" title="Branch 27 was not executed"> # </span><span class="branchNoExec" title="Branch 28 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 29 was not executed"> # </span><span class="branchNoExec" title="Branch 30 was not executed"> # </span>][<span class="branchNoExec" title="Branch 31 was not executed"> # </span><span class="branchNoExec" title="Branch 32 was not executed"> # </span>]
<a name="803"><span class="lineNum">     803 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :             + HelpExampleRpc(&quot;dumpwallet&quot;, &quot;\&quot;test\&quot;&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchCov" title="Branch 21 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 28 was not taken"> - </span><span class="branchCov" title="Branch 29 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="804"><span class="lineNum">     804 </span>                :            :                 },</a>
<a name="805"><span class="lineNum">     805 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">         15 :             }.ToString());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="806"><span class="lineNum">     806 </span>                :            : </a>
<a name="807"><span class="lineNum">     807 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 7 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          9 :     auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="808"><span class="lineNum">     808 </span>[<span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         15 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="809"><span class="lineNum">     809 </span>                :            : </a>
<a name="810"><span class="lineNum">     810 </span>        [<span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          7 :     EnsureWalletIsUnlocked(pwallet);</span></a>
<a name="811"><span class="lineNum">     811 </span>                :            : </a>
<a name="812"><span class="lineNum">     812 </span>[<span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         15 :     fs::path filepath = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 11 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>]
<a name="813"><span class="lineNum">     813 </span>[<span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         14 :     filepath = fs::absolute(filepath);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>]
<a name="814"><span class="lineNum">     814 </span>                :            : </a>
<a name="815"><span class="lineNum">     815 </span>                :            :     /* Prevent arbitrary files from being overwritten. There have been reports</a>
<a name="816"><span class="lineNum">     816 </span>                :            :      * that users have overwritten wallet files this way:</a>
<a name="817"><span class="lineNum">     817 </span>                :            :      * https://github.com/bitcoin/bitcoin/issues/9934</a>
<a name="818"><span class="lineNum">     818 </span>                :            :      * It may also avoid other security issues.</a>
<a name="819"><span class="lineNum">     819 </span>                :            :      */</a>
<a name="820"><span class="lineNum">     820 </span>        [<span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          7 :     if (fs::exists(filepath)) {</span></a>
<a name="821"><span class="lineNum">     821 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          2 :         throw JSONRPCError(RPC_INVALID_PARAMETER, filepath.string() + &quot; already exists. If you are sure this is what you want, move it out of the way first&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>]
<a name="822"><span class="lineNum">     822 </span>                :            :     }</a>
<a name="823"><span class="lineNum">     823 </span>                :            : </a>
<a name="824"><span class="lineNum">     824 </span>  [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         12 :     fsbridge::ofstream file;</span></a>
<a name="825"><span class="lineNum">     825 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     file.open(filepath);</span></a>
<a name="826"><span class="lineNum">     826 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">         12 :     if (!file.is_open())</span></a>
<a name="827"><span class="lineNum">     827 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Cannot open wallet dump file&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="828"><span class="lineNum">     828 </span>                :            : </a>
<a name="829"><span class="lineNum">     829 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         12 :     std::map&lt;CKeyID, int64_t&gt; mapKeyBirth;</span></a>
<a name="830"><span class="lineNum">     830 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     const std::map&lt;CKeyID, int64_t&gt;&amp; mapKeyPool = pwallet-&gt;GetAllReserveKeys();</span></a>
<a name="831"><span class="lineNum">     831 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         12 :     pwallet-&gt;GetKeyBirthTimes(*locked_chain, mapKeyBirth);</span></a>
<a name="832"><span class="lineNum">     832 </span>                :            : </a>
<a name="833"><span class="lineNum">     833 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         12 :     std::set&lt;CScriptID&gt; scripts = pwallet-&gt;GetCScripts();</span></a>
<a name="834"><span class="lineNum">     834 </span>                :            : </a>
<a name="835"><span class="lineNum">     835 </span>                :            :     // sort time/key pairs</a>
<a name="836"><span class="lineNum">     836 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineCov">         12 :     std::vector&lt;std::pair&lt;int64_t, CKeyID&gt; &gt; vKeyBirth;</span></a>
<a name="837"><span class="lineNum">     837 </span>[<span class="branchCov" title="Branch 0 was taken 1235 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1235 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">       2488 :     for (const auto&amp; entry : mapKeyBirth) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="838"><span class="lineNum">     838 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       2470 :         vKeyBirth.push_back(std::make_pair(entry.second, entry.first));</span></a>
<a name="839"><span class="lineNum">     839 </span>                :            :     }</a>
<a name="840"><span class="lineNum">     840 </span>                :<span class="lineCov">          6 :     mapKeyBirth.clear();</span></a>
<a name="841"><span class="lineNum">     841 </span>                :<span class="lineCov">         18 :     std::sort(vKeyBirth.begin(), vKeyBirth.end());</span></a>
<a name="842"><span class="lineNum">     842 </span>                :            : </a>
<a name="843"><span class="lineNum">     843 </span>                :            :     // produce output</a>
<a name="844"><span class="lineNum">     844 </span>[<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 6 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]:<span class="lineCov">          6 :     file &lt;&lt; strprintf(&quot;# Wallet dump created by Bitcoin %s\n&quot;, CLIENT_BUILD);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="845"><span class="lineNum">     845 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         12 :     file &lt;&lt; strprintf(&quot;# * Created on %s\n&quot;, FormatISO8601DateTime(GetTime()));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 14 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>][<span class="branchNoExec" title="Branch 18 was not executed"> # </span><span class="branchNoExec" title="Branch 19 was not executed"> # </span>]
<a name="846"><span class="lineNum">     846 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         12 :     const Optional&lt;int&gt; tip_height = locked_chain-&gt;getHeight();</span></a>
<a name="847"><span class="lineNum">     847 </span>[<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         24 :     file &lt;&lt; strprintf(&quot;# * Best block at time of backup was %i (%s),\n&quot;, tip_height.get_value_or(-1), tip_height ? locked_chain-&gt;getBlockHash(*tip_height).ToString() : &quot;(missing block hash)&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 8 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>][<span class="branchCov" title="Branch 14 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>][<span class="branchNoExec" title="Branch 20 was not executed"> # </span><span class="branchNoExec" title="Branch 21 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 30 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 32 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>]
<a name="848"><span class="lineNum">     848 </span>[<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         18 :     file &lt;&lt; strprintf(&quot;#   mined on %s\n&quot;, tip_height ? FormatISO8601DateTime(locked_chain-&gt;getBlockTime(*tip_height)) : &quot;(missing block time)&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 8 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>][<span class="branchCov" title="Branch 14 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>][<span class="branchNoExec" title="Branch 20 was not executed"> # </span><span class="branchNoExec" title="Branch 21 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 23 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 24 was not taken"> - </span>][<span class="branchCov" title="Branch 26 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 30 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<a name="849"><span class="lineNum">     849 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     file &lt;&lt; &quot;\n&quot;;</span></a>
<a name="850"><span class="lineNum">     850 </span>                :            : </a>
<a name="851"><span class="lineNum">     851 </span>                :            :     // add the base58check encoded extended master if the wallet uses HD</a>
<a name="852"><span class="lineNum">     852 </span>                :<span class="lineCov">          6 :     CKeyID seed_id = pwallet-&gt;GetHDChain().seed_id;</span></a>
<a name="853"><span class="lineNum">     853 </span>        [<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>]:<span class="lineCov">         12 :     if (!seed_id.IsNull())</span></a>
<a name="854"><span class="lineNum">     854 </span>                :            :     {</a>
<a name="855"><span class="lineNum">     855 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         10 :         CKey seed;</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="856"><span class="lineNum">     856 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          5 :         if (pwallet-&gt;GetKey(seed_id, seed)) {</span></a>
<a name="857"><span class="lineNum">     857 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineCov">          5 :             CExtKey masterKey;</span></a>
<a name="858"><span class="lineNum">     858 </span>[<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         15 :             masterKey.SetSeed(seed.begin(), seed.size());</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 6 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="859"><span class="lineNum">     859 </span>                :            : </a>
<a name="860"><span class="lineNum">     860 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         10 :             file &lt;&lt; &quot;# extended private masterkey: &quot; &lt;&lt; EncodeExtKey(masterKey) &lt;&lt; &quot;\n\n&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 14 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<a name="861"><span class="lineNum">     861 </span>                :            :         }</a>
<a name="862"><span class="lineNum">     862 </span>                :            :     }</a>
<a name="863"><span class="lineNum">     863 </span>[<span class="branchCov" title="Branch 0 was taken 1235 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1235 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">       3717 :     for (std::vector&lt;std::pair&lt;int64_t, CKeyID&gt; &gt;::const_iterator it = vKeyBirth.begin(); it != vKeyBirth.end(); it++) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 4 was taken 1235 times"> + </span><span class="branchCov" title="Branch 5 was taken 6 times"> + </span>]
<a name="864"><span class="lineNum">     864 </span>                :<span class="lineCov">       1235 :         const CKeyID &amp;keyid = it-&gt;second;</span></a>
<a name="865"><span class="lineNum">     865 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineCov">       2470 :         std::string strTime = FormatISO8601DateTime(it-&gt;first);</span></a>
<a name="866"><span class="lineNum">     866 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       2470 :         std::string strAddr;</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="867"><span class="lineNum">     867 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       2470 :         std::string strLabel;</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="868"><span class="lineNum">     868 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       3705 :         CKey key;</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1235 times"> + </span>][<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="869"><span class="lineNum">     869 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       1235 :         if (pwallet-&gt;GetKey(keyid, key)) {</span></a>
<a name="870"><span class="lineNum">     870 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       2470 :             file &lt;&lt; strprintf(&quot;%s %s &quot;, EncodeSecret(key), strTime);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>][<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="871"><span class="lineNum">     871 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 78 times"> + </span><span class="branchCov" title="Branch 4 was taken 1157 times"> + </span>]:<span class="lineCov">       1235 :             if (GetWalletAddressesForKey(pwallet, keyid, strAddr, strLabel)) {</span></a>
<a name="872"><span class="lineNum">     872 </span>[<span class="branchCov" title="Branch 1 was taken 78 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 78 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         78 :                file &lt;&lt; strprintf(&quot;label=%s&quot;, strLabel);</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 78 times"> + </span>][<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>]
<a name="873"><span class="lineNum">     873 </span>[<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchCov" title="Branch 1 was taken 1152 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 5 times"> + </span><span class="branchCov" title="Branch 3 was taken 1152 times"> + </span>]:<span class="lineCov">       2314 :             } else if (keyid == seed_id) {</span></a>
<a name="874"><span class="lineNum">     874 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :                 file &lt;&lt; &quot;hdseed=1&quot;;</span></a>
<a name="875"><span class="lineNum">     875 </span>                :<span class="lineCov">       1152 :             } else if (mapKeyPool.count(keyid)) {</span></a>
<a name="876"><span class="lineNum">     876 </span>        [<span class="branchCov" title="Branch 1 was taken 957 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        957 :                 file &lt;&lt; &quot;reserve=1&quot;;</span></a>
<a name="877"><span class="lineNum">     877 </span>[<span class="branchCov" title="Branch 1 was taken 195 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchCov" title="Branch 5 was taken 194 times"> + </span>]:<span class="lineCov">        195 :             } else if (pwallet-&gt;mapKeyMetadata[keyid].hdKeypath == &quot;s&quot;) {</span></a>
<a name="878"><span class="lineNum">     878 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :                 file &lt;&lt; &quot;inactivehdseed=1&quot;;</span></a>
<a name="879"><span class="lineNum">     879 </span>                :            :             } else {</a>
<a name="880"><span class="lineNum">     880 </span>        [<span class="branchCov" title="Branch 1 was taken 194 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        194 :                 file &lt;&lt; &quot;change=1&quot;;</span></a>
<a name="881"><span class="lineNum">     881 </span>                :            :             }</a>
<a name="882"><span class="lineNum">     882 </span>[<span class="branchCov" title="Branch 1 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1225 times"> + </span><span class="branchCov" title="Branch 4 was taken 10 times"> + </span>]:<span class="lineCov">       3695 :             file &lt;&lt; strprintf(&quot; # addr=%s%s\n&quot;, strAddr, (pwallet-&gt;mapKeyMetadata[keyid].has_key_origin ? &quot; hdkeypath=&quot;+WriteHDKeypath(pwallet-&gt;mapKeyMetadata[keyid].key_origin.path) : &quot;&quot;));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 1225 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 1225 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 1225 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 24 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>][<span class="branchCov" title="Branch 26 was taken 1235 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 1225 times"> + </span><span class="branchCov" title="Branch 29 was taken 10 times"> + </span>][<span class="branchCov" title="Branch 30 was taken 1225 times"> + </span><span class="branchCov" title="Branch 31 was taken 10 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 32 was not taken"> - </span><span class="branchCov" title="Branch 33 was taken 1225 times"> + </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 40 was not executed"> # </span><span class="branchNoExec" title="Branch 41 was not executed"> # </span>]
<a name="883"><span class="lineNum">     883 </span>                :            :         }</a>
<a name="884"><span class="lineNum">     884 </span>                :            :     }</a>
<a name="885"><span class="lineNum">     885 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     file &lt;&lt; &quot;\n&quot;;</span></a>
<a name="886"><span class="lineNum">     886 </span>[<span class="branchCov" title="Branch 0 was taken 1237 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1237 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">       2492 :     for (const CScriptID &amp;scriptid : scripts) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="887"><span class="lineNum">     887 </span>[<span class="branchCov" title="Branch 1 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineCov">       2474 :         CScript script;</span></a>
<a name="888"><span class="lineNum">     888 </span>[<span class="branchCov" title="Branch 1 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       3711 :         std::string create_time = &quot;0&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchCov" title="Branch 7 was taken 1235 times"> + </span>][<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>]
<a name="889"><span class="lineNum">     889 </span>[<span class="branchCov" title="Branch 1 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       6185 :         std::string address = EncodeDestination(ScriptHash(scriptid));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1237 times"> + </span>][<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>]
<a name="890"><span class="lineNum">     890 </span>                :            :         // get birth times for scripts with metadata</a>
<a name="891"><span class="lineNum">     891 </span>                :<span class="lineCov">       1237 :         auto it = pwallet-&gt;m_script_metadata.find(scriptid);</span></a>
<a name="892"><span class="lineNum">     892 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 1237 times"> + </span> :<span class="lineCov">       3711 :         if (it != pwallet-&gt;m_script_metadata.end()) {</span></a>
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1237 times"> + </span>]
<a name="893"><span class="lineNum">     893 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineNoCov">          0 :             create_time = FormatISO8601DateTime(it-&gt;second.nCreateTime);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="894"><span class="lineNum">     894 </span>                :            :         }</a>
<a name="895"><span class="lineNum">     895 </span>[<span class="branchCov" title="Branch 1 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">       1237 :         if(pwallet-&gt;GetCScript(scriptid, script)) {</span></a>
<a name="896"><span class="lineNum">     896 </span>[<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 1235 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 1235 times"> + </span>]:<span class="lineCov">       3713 :             file &lt;&lt; strprintf(&quot;%s %s script=1&quot;, HexStr(script.begin(), script.end()), create_time);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 8 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 15 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>][<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 19 was not executed"> # </span><span class="branchNoExec" title="Branch 20 was not executed"> # </span>]
<a name="897"><span class="lineNum">     897 </span>[<span class="branchCov" title="Branch 1 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1237 :             file &lt;&lt; strprintf(&quot; # addr=%s\n&quot;, address);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 1237 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>]
<a name="898"><span class="lineNum">     898 </span>                :            :         }</a>
<a name="899"><span class="lineNum">     899 </span>                :            :     }</a>
<a name="900"><span class="lineNum">     900 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     file &lt;&lt; &quot;\n&quot;;</span></a>
<a name="901"><span class="lineNum">     901 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     file &lt;&lt; &quot;# End of dump\n&quot;;</span></a>
<a name="902"><span class="lineNum">     902 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     file.close();</span></a>
<a name="903"><span class="lineNum">     903 </span>                :            : </a>
<a name="904"><span class="lineNum">     904 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :     UniValue reply(UniValue::VOBJ);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="905"><span class="lineNum">     905 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :     reply.pushKV(&quot;filename&quot;, filepath.string());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 6 times"> + </span>][<span class="branchCov" title="Branch 15 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="906"><span class="lineNum">     906 </span>                :            : </a>
<a name="907"><span class="lineNum">     907 </span>        [<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          6 :     return reply;</span></a>
<a name="908"><span class="lineNum">     908 </span>                :            : }</a>
<a name="909"><span class="lineNum">     909 </span>                :            : </a>
<a name="910"><span class="lineNum">     910 </span>[<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        388 : struct ImportData</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="911"><span class="lineNum">     911 </span>                :            : {</a>
<a name="912"><span class="lineNum">     912 </span>                :            :     // Input data</a>
<a name="913"><span class="lineNum">     913 </span>                :            :     std::unique_ptr&lt;CScript&gt; redeemscript; //!&lt; Provided redeemScript; will be moved to `import_scripts` if relevant.</a>
<a name="914"><span class="lineNum">     914 </span>                :            :     std::unique_ptr&lt;CScript&gt; witnessscript; //!&lt; Provided witnessScript; will be moved to `import_scripts` if relevant.</a>
<a name="915"><span class="lineNum">     915 </span>                :            : </a>
<a name="916"><span class="lineNum">     916 </span>                :            :     // Output data</a>
<a name="917"><span class="lineNum">     917 </span>                :            :     std::set&lt;CScript&gt; import_scripts;</a>
<a name="918"><span class="lineNum">     918 </span>                :            :     std::map&lt;CKeyID, bool&gt; used_keys; //!&lt; Import these private keys if available (the value indicates whether if the key is required for solvability)</a>
<a name="919"><span class="lineNum">     919 </span>                :            :     std::map&lt;CKeyID, std::pair&lt;CPubKey, KeyOriginInfo&gt;&gt; key_origins;</a>
<a name="920"><span class="lineNum">     920 </span>                :            : };</a>
<a name="921"><span class="lineNum">     921 </span>                :            : </a>
<a name="922"><span class="lineNum">     922 </span>                :            : enum class ScriptContext</a>
<a name="923"><span class="lineNum">     923 </span>                :            : {</a>
<a name="924"><span class="lineNum">     924 </span>                :            :     TOP, //!&lt; Top-level scriptPubKey</a>
<a name="925"><span class="lineNum">     925 </span>                :            :     P2SH, //!&lt; P2SH redeemScript</a>
<a name="926"><span class="lineNum">     926 </span>                :            :     WITNESS_V0, //!&lt; P2WSH witnessScript</a>
<a name="927"><span class="lineNum">     927 </span>                :            : };</a>
<a name="928"><span class="lineNum">     928 </span>                :            : </a>
<a name="929"><span class="lineNum">     929 </span>                :            : // Analyse the provided scriptPubKey, determining which keys and which redeem scripts from the ImportData struct are needed to spend it, and mark them as used.</a>
<a name="930"><span class="lineNum">     930 </span>                :            : // Returns an error string, or the empty string for success.</a>
<a name="931"><span class="lineNum">     931 </span>                :<span class="lineCov">         54 : static std::string RecurseImportData(const CScript&amp; script, ImportData&amp; import_data, const ScriptContext script_ctx)</span></a>
<a name="932"><span class="lineNum">     932 </span>                :            : {</a>
<a name="933"><span class="lineNum">     933 </span>                :            :     // Use Solver to obtain script type and parsed pubkeys or hashes:</a>
<a name="934"><span class="lineNum">     934 </span>        [<span class="branchCov" title="Branch 1 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        108 :     std::vector&lt;std::vector&lt;unsigned char&gt;&gt; solverdata;</span></a>
<a name="935"><span class="lineNum">     935 </span>        [<span class="branchCov" title="Branch 1 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         54 :     txnouttype script_type = Solver(script, solverdata);</span></a>
<a name="936"><span class="lineNum">     936 </span>                :            : </a>
<a name="937"><span class="lineNum">     937 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 37 times"> + </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 5 times"> + </span> :<span class="lineCov">         54 :     switch (script_type) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchCov" title="Branch 5 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="938"><span class="lineNum">     938 </span>                :<span class="lineNoCov">          0 :     case TX_PUBKEY: {</span></a>
<a name="939"><span class="lineNum">     939 </span>                :<span class="lineNoCov">          0 :         CPubKey pubkey(solverdata[0].begin(), solverdata[0].end());</span></a>
<a name="940"><span class="lineNum">     940 </span>[<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         import_data.used_keys.emplace(pubkey.GetID(), false);</span></a>
<a name="941"><span class="lineNum">     941 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return &quot;&quot;;</span></a>
<a name="942"><span class="lineNum">     942 </span>                :            :     }</a>
<a name="943"><span class="lineNum">     943 </span>                :<span class="lineCov">         37 :     case TX_PUBKEYHASH: {</span></a>
<a name="944"><span class="lineNum">     944 </span>[<span class="branchCov" title="Branch 1 was taken 37 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 37 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         74 :         CKeyID id = CKeyID(uint160(solverdata[0]));</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 37 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="945"><span class="lineNum">     945 </span>        [<span class="branchCov" title="Branch 1 was taken 37 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         37 :         import_data.used_keys[id] = true;</span></a>
<a name="946"><span class="lineNum">     946 </span>[<span class="branchCov" title="Branch 1 was taken 37 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 37 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         74 :         return &quot;&quot;;</span></a>
<a name="947"><span class="lineNum">     947 </span>                :            :     }</a>
<a name="948"><span class="lineNum">     948 </span>                :<span class="lineCov">          6 :     case TX_SCRIPTHASH: {</span></a>
<a name="949"><span class="lineNum">     949 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">          6 :         if (script_ctx == ScriptContext::P2SH) throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Trying to nest P2SH inside another P2SH&quot;);</span></a>
<span class="lineNum">         </span>  [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>][<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<a name="950"><span class="lineNum">     950 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">          6 :         if (script_ctx == ScriptContext::WITNESS_V0) throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Trying to nest P2SH inside a P2WSH&quot;);</span></a>
<span class="lineNum">         </span>  [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>][<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<a name="951"><span class="lineNum">     951 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">          6 :         assert(script_ctx == ScriptContext::TOP);</span></a>
<a name="952"><span class="lineNum">     952 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         12 :         CScriptID id = CScriptID(uint160(solverdata[0]));</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 6 times"> + </span>]
<a name="953"><span class="lineNum">     953 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :         auto subscript = std::move(import_data.redeemscript); // Remove redeemscript from import_data to check for superfluous script later.</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="954"><span class="lineNum">     954 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">         12 :         if (!subscript) return &quot;missing redeemscript&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>][<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>]
<a name="955"><span class="lineNum">     955 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         12 :         if (CScriptID(*subscript) != id) return &quot;redeemScript does not match the scriptPubKey&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 6 times"> + </span>][<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 6 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>][<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="956"><span class="lineNum">     956 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         12 :         import_data.import_scripts.emplace(*subscript);</span></a>
<a name="957"><span class="lineNum">     957 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         12 :         return RecurseImportData(*subscript, import_data, ScriptContext::P2SH);</span></a>
<a name="958"><span class="lineNum">     958 </span>                :            :     }</a>
<a name="959"><span class="lineNum">     959 </span>                :            :     case TX_MULTISIG: {</a>
<a name="960"><span class="lineNum">     960 </span>[<span class="branchCov" title="Branch 0 was taken 15 times"> + </span><span class="branchCov" title="Branch 1 was taken 5 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 15 times"> + </span><span class="branchCov" title="Branch 3 was taken 5 times"> + </span>]:<span class="lineCov">         40 :         for (size_t i = 1; i + 1&lt; solverdata.size(); ++i) {</span></a>
<a name="961"><span class="lineNum">     961 </span>                :<span class="lineCov">         60 :             CPubKey pubkey(solverdata[i].begin(), solverdata[i].end());</span></a>
<a name="962"><span class="lineNum">     962 </span>[<span class="branchCov" title="Branch 4 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         15 :             import_data.used_keys.emplace(pubkey.GetID(), false);</span></a>
<a name="963"><span class="lineNum">     963 </span>                :            :         }</a>
<a name="964"><span class="lineNum">     964 </span>[<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         10 :         return &quot;&quot;;</span></a>
<a name="965"><span class="lineNum">     965 </span>                :            :     }</a>
<a name="966"><span class="lineNum">     966 </span>                :<span class="lineCov">          2 :     case TX_WITNESS_V0_SCRIPTHASH: {</span></a>
<a name="967"><span class="lineNum">     967 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">          2 :         if (script_ctx == ScriptContext::WITNESS_V0) throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Trying to nest P2WSH inside another P2WSH&quot;);</span></a>
<span class="lineNum">         </span>  [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>][<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<a name="968"><span class="lineNum">     968 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          4 :         uint256 fullid(solverdata[0]);</span></a>
<a name="969"><span class="lineNum">     969 </span>        [<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          2 :         CScriptID id;</span></a>
<a name="970"><span class="lineNum">     970 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          2 :         CRIPEMD160().Write(fullid.begin(), fullid.size()).Finalize(id.begin());</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="971"><span class="lineNum">     971 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         auto subscript = std::move(import_data.witnessscript); // Remove redeemscript from import_data to check for superfluous script later.</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="972"><span class="lineNum">     972 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">          4 :         if (!subscript) return &quot;missing witnessscript&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>][<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>]
<a name="973"><span class="lineNum">     973 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          4 :         if (CScriptID(*subscript) != id) return &quot;witnessScript does not match the scriptPubKey or redeemScript&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 2 times"> + </span>][<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 2 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>][<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="974"><span class="lineNum">     974 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>]:<span class="lineCov">          2 :         if (script_ctx == ScriptContext::TOP) {</span></a>
<a name="975"><span class="lineNum">     975 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :             import_data.import_scripts.emplace(script); // Special rule for IsMine: native P2WSH requires the TOP script imported (see script/ismine.cpp)</span></a>
<a name="976"><span class="lineNum">     976 </span>                :            :         }</a>
<a name="977"><span class="lineNum">     977 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          4 :         import_data.import_scripts.emplace(*subscript);</span></a>
<a name="978"><span class="lineNum">     978 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          4 :         return RecurseImportData(*subscript, import_data, ScriptContext::WITNESS_V0);</span></a>
<a name="979"><span class="lineNum">     979 </span>                :            :     }</a>
<a name="980"><span class="lineNum">     980 </span>                :<span class="lineCov">          4 :     case TX_WITNESS_V0_KEYHASH: {</span></a>
<a name="981"><span class="lineNum">     981 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">          4 :         if (script_ctx == ScriptContext::WITNESS_V0) throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Trying to nest P2WPKH inside P2WSH&quot;);</span></a>
<span class="lineNum">         </span>  [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>][<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<a name="982"><span class="lineNum">     982 </span>[<span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          8 :         CKeyID id = CKeyID(uint160(solverdata[0]));</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="983"><span class="lineNum">     983 </span>        [<span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          4 :         import_data.used_keys[id] = true;</span></a>
<a name="984"><span class="lineNum">     984 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">          4 :         if (script_ctx == ScriptContext::TOP) {</span></a>
<a name="985"><span class="lineNum">     985 </span>        [<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          2 :             import_data.import_scripts.emplace(script); // Special rule for IsMine: native P2WPKH requires the TOP script imported (see script/ismine.cpp)</span></a>
<a name="986"><span class="lineNum">     986 </span>                :            :         }</a>
<a name="987"><span class="lineNum">     987 </span>[<span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          8 :         return &quot;&quot;;</span></a>
<a name="988"><span class="lineNum">     988 </span>                :            :     }</a>
<a name="989"><span class="lineNum">     989 </span>                :<span class="lineNoCov">          0 :     case TX_NULL_DATA:</span></a>
<a name="990"><span class="lineNum">     990 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return &quot;unspendable script&quot;;</span></a>
<a name="991"><span class="lineNum">     991 </span>                :<span class="lineNoCov">          0 :     case TX_NONSTANDARD:</span></a>
<a name="992"><span class="lineNum">     992 </span>                :<span class="lineNoCov">          0 :     case TX_WITNESS_UNKNOWN:</span></a>
<a name="993"><span class="lineNum">     993 </span>                :<span class="lineNoCov">          0 :     default:</span></a>
<a name="994"><span class="lineNum">     994 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return &quot;unrecognized script&quot;;</span></a>
<a name="995"><span class="lineNum">     995 </span>                :            :     }</a>
<a name="996"><span class="lineNum">     996 </span>                :            : }</a>
<a name="997"><span class="lineNum">     997 </span>                :            : </a>
<a name="998"><span class="lineNum">     998 </span>                :<span class="lineCov">         71 : static UniValue ProcessImportLegacy(ImportData&amp; import_data, std::map&lt;CKeyID, CPubKey&gt;&amp; pubkey_map, std::map&lt;CKeyID, CKey&gt;&amp; privkey_map, std::set&lt;CScript&gt;&amp; script_pub_keys, bool&amp; have_solving_data, const UniValue&amp; data, std::vector&lt;CKeyID&gt;&amp; ordered_pubkeys)</span></a>
<a name="999"><span class="lineNum">     999 </span>                :            : {</a>
<a name="1000"><span class="lineNum">    1000 </span>[<span class="branchCov" title="Branch 3 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>][<span class="branchCov" title="Branch 6 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]:<span class="lineCov">        213 :     UniValue warnings(UniValue::VARR);</span></a>
<a name="1001"><span class="lineNum">    1001 </span>                :            : </a>
<a name="1002"><span class="lineNum">    1002 </span>                :            :     // First ensure scriptPubKey has either a script or JSON with &quot;address&quot; string</a>
<a name="1003"><span class="lineNum">    1003 </span>[<span class="branchCov" title="Branch 1 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        142 :     const UniValue&amp; scriptPubKey = data[&quot;scriptPubKey&quot;];</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 71 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 43 times"> + </span><span class="branchCov" title="Branch 12 was taken 28 times"> + </span>][<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>]
<a name="1004"><span class="lineNum">    1004 </span>        [<span class="branchCov" title="Branch 0 was taken 43 times"> + </span><span class="branchCov" title="Branch 1 was taken 28 times"> + </span>]:<span class="lineCov">         71 :     bool isScript = scriptPubKey.getType() == UniValue::VSTR;</span></a>
<a name="1005"><span class="lineNum">    1005 </span>[<span class="branchCov" title="Branch 0 was taken 43 times"> + </span><span class="branchCov" title="Branch 1 was taken 28 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        114 :     if (!isScript &amp;&amp; !(scriptPubKey.getType() == UniValue::VOBJ &amp;&amp; scriptPubKey.exists(&quot;address&quot;))) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 43 times"> + </span>][<span class="branchCov" title="Branch 17 was taken 43 times"> + </span><span class="branchCov" title="Branch 18 was taken 28 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 43 times"> + </span>][<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 71 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 23 was not executed"> # </span><span class="branchNoExec" title="Branch 24 was not executed"> # </span>]
<a name="1006"><span class="lineNum">    1006 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;scriptPubKey must be string with script or JSON with address string&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1007"><span class="lineNum">    1007 </span>                :            :     }</a>
<a name="1008"><span class="lineNum">    1008 </span>[<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchCov" title="Branch 1 was taken 43 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         71 :     const std::string&amp; output = isScript ? scriptPubKey.get_str() : scriptPubKey[&quot;address&quot;].get_str();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 17 was taken 43 times"> + </span><span class="branchCov" title="Branch 18 was taken 28 times"> + </span>][<span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 43 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 21 was not executed"> # </span><span class="branchNoExec" title="Branch 22 was not executed"> # </span>]
<a name="1009"><span class="lineNum">    1009 </span>                :            : </a>
<a name="1010"><span class="lineNum">    1010 </span>                :            :     // Optional fields.</a>
<a name="1011"><span class="lineNum">    1011 </span>[<span class="branchCov" title="Branch 1 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        152 :     const std::string&amp; strRedeemScript = data.exists(&quot;redeemscript&quot;) ? data[&quot;redeemscript&quot;].get_str() : &quot;&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 6 times"> + </span><span class="branchCov" title="Branch 10 was taken 65 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 24 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>][<span class="branchCov" title="Branch 27 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 28 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 30 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>][<span class="branchCov" title="Branch 32 was taken 6 times"> + </span><span class="branchCov" title="Branch 33 was taken 65 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchCov" title="Branch 35 was taken 6 times"> + </span>][<span class="branchNoCov" title="Branch 36 was not taken"> - </span><span class="branchCov" title="Branch 37 was taken 71 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 39 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 40 was not taken"> - </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 4 times"> + </span>]
<a name="1012"><span class="lineNum">    1012 </span>[<span class="branchCov" title="Branch 1 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        215 :     const std::string&amp; witness_script_hex = data.exists(&quot;witnessscript&quot;) ? data[&quot;witnessscript&quot;].get_str() : &quot;&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 2 times"> + </span><span class="branchCov" title="Branch 10 was taken 69 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 24 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>][<span class="branchCov" title="Branch 27 was taken 69 times"> + </span><span class="branchNoCov" title="Branch 28 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 30 was taken 69 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>][<span class="branchCov" title="Branch 32 was taken 2 times"> + </span><span class="branchCov" title="Branch 33 was taken 69 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchCov" title="Branch 35 was taken 2 times"> + </span>][<span class="branchNoCov" title="Branch 36 was not taken"> - </span><span class="branchCov" title="Branch 37 was taken 71 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 39 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 40 was not taken"> - </span>][<span class="branchCov" title="Branch 41 was taken 6 times"> + </span><span class="branchCov" title="Branch 42 was taken 61 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 47 was not executed"> # </span><span class="branchNoExec" title="Branch 48 was not executed"> # </span>][<span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 4 times"> + </span>]
<a name="1013"><span class="lineNum">    1013 </span>[<span class="branchCov" title="Branch 1 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        257 :     const UniValue&amp; pubKeys = data.exists(&quot;pubkeys&quot;) ? data[&quot;pubkeys&quot;].get_array() : UniValue();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 44 times"> + </span><span class="branchCov" title="Branch 10 was taken 27 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 24 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>][<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 44 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 28 was not taken"> - </span><span class="branchCov" title="Branch 29 was taken 71 times"> + </span>]
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 31 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span><span class="branchCov" title="Branch 34 was taken 2 times"> + </span><span class="branchCov" title="Branch 35 was taken 65 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>][<span class="branchNoExec" title="Branch 38 was not executed"> # </span><span class="branchNoExec" title="Branch 39 was not executed"> # </span>]
<a name="1014"><span class="lineNum">    1014 </span>[<span class="branchCov" title="Branch 1 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        196 :     const UniValue&amp; keys = data.exists(&quot;keys&quot;) ? data[&quot;keys&quot;].get_array() : UniValue();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 50 times"> + </span><span class="branchCov" title="Branch 10 was taken 21 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 50 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 50 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 50 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 50 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 24 was taken 50 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>][<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 50 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 28 was not taken"> - </span><span class="branchCov" title="Branch 29 was taken 71 times"> + </span>][<span class="branchCov" title="Branch 31 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 33 was not executed"> # </span><span class="branchNoExec" title="Branch 34 was not executed"> # </span>][<span class="branchNoExec" title="Branch 35 was not executed"> # </span><span class="branchNoExec" title="Branch 36 was not executed"> # </span>]
<a name="1015"><span class="lineNum">    1015 </span>[<span class="branchCov" title="Branch 1 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        150 :     const bool internal = data.exists(&quot;internal&quot;) ? data[&quot;internal&quot;].get_bool() : false;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 8 times"> + </span><span class="branchCov" title="Branch 10 was taken 63 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 23 was taken 8 times"> + </span><span class="branchCov" title="Branch 24 was taken 63 times"> + </span>][<span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 8 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 71 times"> + </span>][<span class="branchCov" title="Branch 30 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<a name="1016"><span class="lineNum">    1016 </span>[<span class="branchCov" title="Branch 1 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        180 :     const bool watchOnly = data.exists(&quot;watchonly&quot;) ? data[&quot;watchonly&quot;].get_bool() : false;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 38 times"> + </span><span class="branchCov" title="Branch 10 was taken 33 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 38 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 38 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 38 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 38 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 23 was taken 38 times"> + </span><span class="branchCov" title="Branch 24 was taken 33 times"> + </span>][<span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 38 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 71 times"> + </span>][<span class="branchCov" title="Branch 30 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<a name="1017"><span class="lineNum">    1017 </span>                :            : </a>
<a name="1018"><span class="lineNum">    1018 </span>[<span class="branchCov" title="Branch 1 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        142 :     if (data.exists(&quot;range&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 71 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 71 times"> + </span>][<span class="branchNoCov" title="Branch 13 was not taken"> - </span><span class="branchCov" title="Branch 14 was taken 71 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="1019"><span class="lineNum">    1019 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Range should not be specified for a non-descriptor import&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1020"><span class="lineNum">    1020 </span>                :            :     }</a>
<a name="1021"><span class="lineNum">    1021 </span>                :            : </a>
<a name="1022"><span class="lineNum">    1022 </span>                :            :     // Generate the script and destination for the scriptPubKey provided</a>
<a name="1023"><span class="lineNum">    1023 </span>[<span class="branchCov" title="Branch 0 was taken 43 times"> + </span><span class="branchCov" title="Branch 1 was taken 28 times"> + </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 4 times"> + </span>]:<span class="lineCov">        142 :     CScript script;</span></a>
<a name="1024"><span class="lineNum">    1024 </span>        [<span class="branchCov" title="Branch 0 was taken 43 times"> + </span><span class="branchCov" title="Branch 1 was taken 28 times"> + </span>]:<span class="lineCov">         71 :     if (!isScript) {</span></a>
<a name="1025"><span class="lineNum">    1025 </span>        [<span class="branchCov" title="Branch 1 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         44 :         CTxDestination dest = DecodeDestination(output);</span></a>
<a name="1026"><span class="lineNum">    1026 </span>[<span class="branchCov" title="Branch 1 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1 time"> + </span><span class="branchCov" title="Branch 4 was taken 42 times"> + </span>]:<span class="lineCov">         43 :         if (!IsValidDestination(dest)) {</span></a>
<a name="1027"><span class="lineNum">    1027 </span>[<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          2 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid address \&quot;&quot; + output + &quot;\&quot;&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 1 time"> + </span>][<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="1028"><span class="lineNum">    1028 </span>                :            :         }</a>
<a name="1029"><span class="lineNum">    1029 </span>[<span class="branchCov" title="Branch 1 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 42 times"> + </span>]:<span class="lineCov">         42 :         script = GetScriptForDestination(dest);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 42 times"> + </span>]
<a name="1030"><span class="lineNum">    1030 </span>                :            :     } else {</a>
<a name="1031"><span class="lineNum">    1031 </span>[<span class="branchCov" title="Branch 1 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 28 times"> + </span>]:<span class="lineCov">         28 :         if (!IsHex(output)) {</span></a>
<a name="1032"><span class="lineNum">    1032 </span>[<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>][<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid scriptPubKey \&quot;&quot; + output + &quot;\&quot;&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>][<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="1033"><span class="lineNum">    1033 </span>                :            :         }</a>
<a name="1034"><span class="lineNum">    1034 </span>[<span class="branchCov" title="Branch 1 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         34 :         std::vector&lt;unsigned char&gt; vData(ParseHex(output));</span></a>
<a name="1035"><span class="lineNum">    1035 </span>  [<span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 28 times"> + </span>]:<span class="lineCov">        140 :         script = CScript(vData.begin(), vData.end());</span></a>
<a name="1036"><span class="lineNum">    1036 </span>[<span class="branchCov" title="Branch 1 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         56 :         CTxDestination dest;</span></a>
<a name="1037"><span class="lineNum">    1037 </span>[<span class="branchCov" title="Branch 1 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchCov" title="Branch 4 was taken 25 times"> + </span>]:<span class="lineCov">         28 :         if (!ExtractDestination(script, dest) &amp;&amp; !internal) {</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3 times"> + </span>]
<a name="1038"><span class="lineNum">    1038 </span>  [<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          9 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Internal must be set to true for nonstandard scriptPubKey imports.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1039"><span class="lineNum">    1039 </span>                :            :         }</a>
<a name="1040"><span class="lineNum">    1040 </span>                :            :     }</a>
<a name="1041"><span class="lineNum">    1041 </span>        [<span class="branchCov" title="Branch 1 was taken 67 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         67 :     script_pub_keys.emplace(script);</span></a>
<a name="1042"><span class="lineNum">    1042 </span>                :            : </a>
<a name="1043"><span class="lineNum">    1043 </span>                :            :     // Parse all arguments</a>
<a name="1044"><span class="lineNum">    1044 </span>[<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchCov" title="Branch 1 was taken 61 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 61 times"> + </span>]:<span class="lineCov">        134 :     if (strRedeemScript.size()) {</span></a>
<a name="1045"><span class="lineNum">    1045 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 6 times"> + </span>]:<span class="lineCov">          6 :         if (!IsHex(strRedeemScript)) {</span></a>
<a name="1046"><span class="lineNum">    1046 </span>[<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>][<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid redeem script \&quot;&quot; + strRedeemScript + &quot;\&quot;: must be hex string&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>][<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="1047"><span class="lineNum">    1047 </span>                :            :         }</a>
<a name="1048"><span class="lineNum">    1048 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineCov">          6 :         auto parsed_redeemscript = ParseHex(strRedeemScript);</span></a>
<a name="1049"><span class="lineNum">    1049 </span>[<span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :         import_data.redeemscript = MakeUnique&lt;CScript&gt;(parsed_redeemscript.begin(), parsed_redeemscript.end());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 6 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 6 times"> + </span>][<span class="branchCov" title="Branch 13 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<a name="1050"><span class="lineNum">    1050 </span>                :            :     }</a>
<a name="1051"><span class="lineNum">    1051 </span>[<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 65 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 65 times"> + </span>]:<span class="lineCov">        134 :     if (witness_script_hex.size()) {</span></a>
<a name="1052"><span class="lineNum">    1052 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span>]:<span class="lineCov">          2 :         if (!IsHex(witness_script_hex)) {</span></a>
<a name="1053"><span class="lineNum">    1053 </span>[<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>][<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid witness script \&quot;&quot; + witness_script_hex + &quot;\&quot;: must be hex string&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>][<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="1054"><span class="lineNum">    1054 </span>                :            :         }</a>
<a name="1055"><span class="lineNum">    1055 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineCov">          2 :         auto parsed_witnessscript = ParseHex(witness_script_hex);</span></a>
<a name="1056"><span class="lineNum">    1056 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          6 :         import_data.witnessscript = MakeUnique&lt;CScript&gt;(parsed_witnessscript.begin(), parsed_witnessscript.end());</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2 times"> + </span>][<span class="branchCov" title="Branch 13 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<a name="1057"><span class="lineNum">    1057 </span>                :            :     }</a>
<a name="1058"><span class="lineNum">    1058 </span>[<span class="branchCov" title="Branch 0 was taken 19 times"> + </span><span class="branchCov" title="Branch 1 was taken 67 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 19 times"> + </span><span class="branchCov" title="Branch 3 was taken 67 times"> + </span>]:<span class="lineCov">        172 :     for (size_t i = 0; i &lt; pubKeys.size(); ++i) {</span></a>
<a name="1059"><span class="lineNum">    1059 </span>[<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         19 :         const auto&amp; str = pubKeys[i].get_str();</span></a>
<a name="1060"><span class="lineNum">    1060 </span>[<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 19 times"> + </span>]:<span class="lineCov">         19 :         if (!IsHex(str)) {</span></a>
<a name="1061"><span class="lineNum">    1061 </span>[<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>][<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Pubkey \&quot;&quot; + str + &quot;\&quot; must be a hex string&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>][<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="1062"><span class="lineNum">    1062 </span>                :            :         }</a>
<a name="1063"><span class="lineNum">    1063 </span>[<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineCov">         38 :         auto parsed_pubkey = ParseHex(str);</span></a>
<a name="1064"><span class="lineNum">    1064 </span>                :<span class="lineCov">         57 :         CPubKey pubkey(parsed_pubkey.begin(), parsed_pubkey.end());</span></a>
<a name="1065"><span class="lineNum">    1065 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 19 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         19 :         if (!pubkey.IsFullyValid()) {</span></a>
<a name="1066"><span class="lineNum">    1066 </span>[<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>][<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Pubkey \&quot;&quot; + str + &quot;\&quot; is not a valid public key&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>][<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="1067"><span class="lineNum">    1067 </span>                :            :         }</a>
<a name="1068"><span class="lineNum">    1068 </span>[<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         19 :         pubkey_map.emplace(pubkey.GetID(), pubkey);</span></a>
<a name="1069"><span class="lineNum">    1069 </span>[<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         19 :         ordered_pubkeys.push_back(pubkey.GetID());</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 6 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1070"><span class="lineNum">    1070 </span>                :            :     }</a>
<a name="1071"><span class="lineNum">    1071 </span>[<span class="branchCov" title="Branch 0 was taken 29 times"> + </span><span class="branchCov" title="Branch 1 was taken 67 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 29 times"> + </span><span class="branchCov" title="Branch 3 was taken 67 times"> + </span>]:<span class="lineCov">        192 :     for (size_t i = 0; i &lt; keys.size(); ++i) {</span></a>
<a name="1072"><span class="lineNum">    1072 </span>[<span class="branchCov" title="Branch 1 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         29 :         const auto&amp; str = keys[i].get_str();</span></a>
<a name="1073"><span class="lineNum">    1073 </span>[<span class="branchCov" title="Branch 1 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span>]:<span class="lineCov">         58 :         CKey key = DecodeSecret(str);</span></a>
<a name="1074"><span class="lineNum">    1074 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 29 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 29 times"> + </span>]:<span class="lineCov">         58 :         if (!key.IsValid()) {</span></a>
<a name="1075"><span class="lineNum">    1075 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid private key encoding&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1076"><span class="lineNum">    1076 </span>                :            :         }</a>
<a name="1077"><span class="lineNum">    1077 </span>        [<span class="branchCov" title="Branch 1 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         29 :         CPubKey pubkey = key.GetPubKey();</span></a>
<a name="1078"><span class="lineNum">    1078 </span>        [<span class="branchCov" title="Branch 1 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         29 :         CKeyID id = pubkey.GetID();</span></a>
<a name="1079"><span class="lineNum">    1079 </span>                :<span class="lineCov">         29 :         if (pubkey_map.count(id)) {</span></a>
<a name="1080"><span class="lineNum">    1080 </span>                :<span class="lineNoCov">          0 :             pubkey_map.erase(id);</span></a>
<a name="1081"><span class="lineNum">    1081 </span>                :            :         }</a>
<a name="1082"><span class="lineNum">    1082 </span>[<span class="branchCov" title="Branch 1 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         29 :         privkey_map.emplace(id, key);</span></a>
<a name="1083"><span class="lineNum">    1083 </span>                :            :     }</a>
<a name="1084"><span class="lineNum">    1084 </span>                :            : </a>
<a name="1085"><span class="lineNum">    1085 </span>                :            : </a>
<a name="1086"><span class="lineNum">    1086 </span>                :            :     // Verify and process input data</a>
<a name="1087"><span class="lineNum">    1087 </span>[<span class="branchCov" title="Branch 0 was taken 61 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 61 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">        134 :     have_solving_data = import_data.redeemscript || import_data.witnessscript || pubkey_map.size() || privkey_map.size();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 60 times"> + </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span>][<span class="branchCov" title="Branch 6 was taken 60 times"> + </span><span class="branchCov" title="Branch 7 was taken 1 time"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 42 times"> + </span><span class="branchCov" title="Branch 9 was taken 18 times"> + </span>][<span class="branchCov" title="Branch 10 was taken 42 times"> + </span><span class="branchCov" title="Branch 11 was taken 18 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 21 times"> + </span><span class="branchCov" title="Branch 13 was taken 21 times"> + </span>][<span class="branchCov" title="Branch 14 was taken 21 times"> + </span><span class="branchCov" title="Branch 15 was taken 21 times"> + </span>]
<a name="1088"><span class="lineNum">    1088 </span>        [<span class="branchCov" title="Branch 0 was taken 46 times"> + </span><span class="branchCov" title="Branch 1 was taken 21 times"> + </span>]:<span class="lineCov">         67 :     if (have_solving_data) {</span></a>
<a name="1089"><span class="lineNum">    1089 </span>                :            :         // Match up data in import_data with the scriptPubKey in script.</a>
<a name="1090"><span class="lineNum">    1090 </span>[<span class="branchCov" title="Branch 1 was taken 46 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 4 times"> + </span><span class="branchCov" title="Branch 4 was taken 42 times"> + </span>]:<span class="lineCov">         92 :         auto error = RecurseImportData(script, import_data, ScriptContext::TOP);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="1091"><span class="lineNum">    1091 </span>                :            : </a>
<a name="1092"><span class="lineNum">    1092 </span>                :            :         // Verify whether the watchonly option corresponds to the availability of private keys.</a>
<a name="1093"><span class="lineNum">    1093 </span>                :<span class="lineCov">        188 :         bool spendable = std::all_of(import_data.used_keys.begin(), import_data.used_keys.end(), [&amp;](const std::pair&lt;CKeyID, bool&gt;&amp; used_key){ return privkey_map.count(used_key.first) &gt; 0; });</span></a>
<a name="1094"><span class="lineNum">    1094 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 34 times"> + </span>]:<span class="lineCov">         46 :         if (!watchOnly &amp;&amp; !spendable) {</span></a>
<a name="1095"><span class="lineNum">    1095 </span>        [<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         12 :             warnings.push_back(&quot;Some private keys are missing, outputs will be considered watchonly. If this is intentional, specify the watchonly flag.&quot;);</span></a>
<a name="1096"><span class="lineNum">    1096 </span>                :            :         }</a>
<a name="1097"><span class="lineNum">    1097 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 45 times"> + </span>]:<span class="lineCov">         46 :         if (watchOnly &amp;&amp; spendable) {</span></a>
<a name="1098"><span class="lineNum">    1098 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :             warnings.push_back(&quot;All private keys are provided, outputs will be considered spendable. If this is intentional, do not specify the watchonly flag.&quot;);</span></a>
<a name="1099"><span class="lineNum">    1099 </span>                :            :         }</a>
<a name="1100"><span class="lineNum">    1100 </span>                :            : </a>
<a name="1101"><span class="lineNum">    1101 </span>                :            :         // Check that all required keys for solvability are provided.</a>
<a name="1102"><span class="lineNum">    1102 </span>[<span class="branchCov" title="Branch 0 was taken 46 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 46 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         92 :         if (error.empty()) {</span></a>
<a name="1103"><span class="lineNum">    1103 </span>[<span class="branchCov" title="Branch 0 was taken 56 times"> + </span><span class="branchCov" title="Branch 1 was taken 46 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 56 times"> + </span><span class="branchCov" title="Branch 3 was taken 46 times"> + </span>]:<span class="lineCov">        194 :             for (const auto&amp; require_key : import_data.used_keys) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 4 was taken 41 times"> + </span><span class="branchCov" title="Branch 5 was taken 15 times"> + </span>]
<a name="1104"><span class="lineNum">    1104 </span>        [<span class="branchCov" title="Branch 0 was taken 41 times"> + </span><span class="branchCov" title="Branch 1 was taken 15 times"> + </span>]:<span class="lineCov">         56 :                 if (!require_key.second) continue; // Not a required key</span></a>
<a name="1105"><span class="lineNum">    1105 </span>                :<span class="lineCov">         65 :                 if (pubkey_map.count(require_key.first) == 0 &amp;&amp; privkey_map.count(require_key.first) == 0) {</span></a>
<a name="1106"><span class="lineNum">    1106 </span>        [<span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          4 :                     error = &quot;some required keys are missing&quot;;</span></a>
<a name="1107"><span class="lineNum">    1107 </span>                :            :                 }</a>
<a name="1108"><span class="lineNum">    1108 </span>                :            :             }</a>
<a name="1109"><span class="lineNum">    1109 </span>                :            :         }</a>
<a name="1110"><span class="lineNum">    1110 </span>                :            : </a>
<a name="1111"><span class="lineNum">    1111 </span>[<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 42 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 42 times"> + </span>]:<span class="lineCov">         92 :         if (!error.empty()) {</span></a>
<a name="1112"><span class="lineNum">    1112 </span>[<span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          8 :             warnings.push_back(&quot;Importing as non-solvable: &quot; + error + &quot;. If this is intentional, don't provide any keys, pubkeys, witnessscript, or redeemscript.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 4 times"> + </span>][<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="1113"><span class="lineNum">    1113 </span>                :<span class="lineCov">          8 :             import_data = ImportData();</span></a>
<a name="1114"><span class="lineNum">    1114 </span>                :<span class="lineCov">          4 :             pubkey_map.clear();</span></a>
<a name="1115"><span class="lineNum">    1115 </span>                :<span class="lineCov">          4 :             privkey_map.clear();</span></a>
<a name="1116"><span class="lineNum">    1116 </span>                :<span class="lineCov">          4 :             have_solving_data = false;</span></a>
<a name="1117"><span class="lineNum">    1117 </span>                :            :         } else {</a>
<a name="1118"><span class="lineNum">    1118 </span>                :            :             // RecurseImportData() removes any relevant redeemscript/witnessscript from import_data, so we can use that to discover if a superfluous one was provided.</a>
<a name="1119"><span class="lineNum">    1119 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 42 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 42 times"> + </span>]:<span class="lineCov">         84 :             if (import_data.redeemscript) warnings.push_back(&quot;Ignoring redeemscript as this is not a P2SH script.&quot;);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="1120"><span class="lineNum">    1120 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 42 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 42 times"> + </span>]:<span class="lineCov">         84 :             if (import_data.witnessscript) warnings.push_back(&quot;Ignoring witnessscript as this is not a (P2SH-)P2WSH script.&quot;);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="1121"><span class="lineNum">    1121 </span>[<span class="branchCov" title="Branch 0 was taken 27 times"> + </span><span class="branchCov" title="Branch 1 was taken 42 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 27 times"> + </span><span class="branchCov" title="Branch 3 was taken 42 times"> + </span>]:<span class="lineCov">        291 :             for (auto it = privkey_map.begin(); it != privkey_map.end(); ) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 4 was taken 27 times"> + </span><span class="branchCov" title="Branch 5 was taken 42 times"> + </span>]
<a name="1122"><span class="lineNum">    1122 </span>                :<span class="lineCov">         27 :                 auto oldit = it++;</span></a>
<a name="1123"><span class="lineNum">    1123 </span>                :<span class="lineCov">         54 :                 if (import_data.used_keys.count(oldit-&gt;first) == 0) {</span></a>
<a name="1124"><span class="lineNum">    1124 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :                     warnings.push_back(&quot;Ignoring irrelevant private key.&quot;);</span></a>
<a name="1125"><span class="lineNum">    1125 </span>                :<span class="lineNoCov">          0 :                     privkey_map.erase(oldit);</span></a>
<a name="1126"><span class="lineNum">    1126 </span>                :            :                 }</a>
<a name="1127"><span class="lineNum">    1127 </span>                :            :             }</a>
<a name="1128"><span class="lineNum">    1128 </span>[<span class="branchCov" title="Branch 0 was taken 17 times"> + </span><span class="branchCov" title="Branch 1 was taken 42 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 17 times"> + </span><span class="branchCov" title="Branch 3 was taken 42 times"> + </span>]:<span class="lineCov">        135 :             for (auto it = pubkey_map.begin(); it != pubkey_map.end(); ) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 4 was taken 17 times"> + </span><span class="branchCov" title="Branch 5 was taken 42 times"> + </span>]
<a name="1129"><span class="lineNum">    1129 </span>                :<span class="lineCov">         17 :                 auto oldit = it++;</span></a>
<a name="1130"><span class="lineNum">    1130 </span>                :<span class="lineCov">         34 :                 auto key_data_it = import_data.used_keys.find(oldit-&gt;first);</span></a>
<a name="1131"><span class="lineNum">    1131 </span>[<span class="branchCov" title="Branch 6 was taken 17 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 8 was taken 17 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>]:<span class="lineCov">         51 :                 if (key_data_it == import_data.used_keys.end() || !key_data_it-&gt;second) {</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 0 was taken 17 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 17 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 17 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1132"><span class="lineNum">    1132 </span>[<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineNoCov">          0 :                     warnings.push_back(&quot;Ignoring public key \&quot;&quot; + HexStr(oldit-&gt;first) + &quot;\&quot; as it doesn't appear inside P2PKH or P2WPKH.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>][<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>][<span class="branchNoExec" title="Branch 19 was not executed"> # </span><span class="branchNoExec" title="Branch 20 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 21 was not executed"> # </span><span class="branchNoExec" title="Branch 22 was not executed"> # </span>][<span class="branchNoExec" title="Branch 23 was not executed"> # </span><span class="branchNoExec" title="Branch 24 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>]
<a name="1133"><span class="lineNum">    1133 </span>                :<span class="lineNoCov">          0 :                     pubkey_map.erase(oldit);</span></a>
<a name="1134"><span class="lineNum">    1134 </span>                :            :                 }</a>
<a name="1135"><span class="lineNum">    1135 </span>                :            :             }</a>
<a name="1136"><span class="lineNum">    1136 </span>                :            :         }</a>
<a name="1137"><span class="lineNum">    1137 </span>                :            :     }</a>
<a name="1138"><span class="lineNum">    1138 </span>                :            : </a>
<a name="1139"><span class="lineNum">    1139 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 63 times"> + </span>]:<span class="lineCov">        134 :     return warnings;</span></a>
<a name="1140"><span class="lineNum">    1140 </span>                :            : }</a>
<a name="1141"><span class="lineNum">    1141 </span>                :            : </a>
<a name="1142"><span class="lineNum">    1142 </span>                :<span class="lineCov">         20 : static UniValue ProcessImportDescriptor(ImportData&amp; import_data, std::map&lt;CKeyID, CPubKey&gt;&amp; pubkey_map, std::map&lt;CKeyID, CKey&gt;&amp; privkey_map, std::set&lt;CScript&gt;&amp; script_pub_keys, bool&amp; have_solving_data, const UniValue&amp; data, std::vector&lt;CKeyID&gt;&amp; ordered_pubkeys)</span></a>
<a name="1143"><span class="lineNum">    1143 </span>                :            : {</a>
<a name="1144"><span class="lineNum">    1144 </span>[<span class="branchCov" title="Branch 3 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>][<span class="branchCov" title="Branch 6 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]:<span class="lineCov">         60 :     UniValue warnings(UniValue::VARR);</span></a>
<a name="1145"><span class="lineNum">    1145 </span>                :            : </a>
<a name="1146"><span class="lineNum">    1146 </span>[<span class="branchCov" title="Branch 1 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         40 :     const std::string&amp; descriptor = data[&quot;desc&quot;].get_str();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 20 times"> + </span>][<span class="branchCov" title="Branch 15 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 17 was not executed"> # </span><span class="branchNoExec" title="Branch 18 was not executed"> # </span>]
<a name="1147"><span class="lineNum">    1147 </span>        [<span class="branchCov" title="Branch 1 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         27 :     FlatSigningProvider keys;</span></a>
<a name="1148"><span class="lineNum">    1148 </span>[<span class="branchCov" title="Branch 1 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span>]:<span class="lineCov">         46 :     auto parsed_desc = Parse(descriptor, keys, /* require_checksum = */ true);</span></a>
<a name="1149"><span class="lineNum">    1149 </span>[<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 19 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchCov" title="Branch 3 was taken 19 times"> + </span>]:<span class="lineCov">         40 :     if (!parsed_desc) {</span></a>
<a name="1150"><span class="lineNum">    1150 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Descriptor is invalid&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1151"><span class="lineNum">    1151 </span>                :            :     }</a>
<a name="1152"><span class="lineNum">    1152 </span>                :            : </a>
<a name="1153"><span class="lineNum">    1153 </span>[<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         38 :     have_solving_data = parsed_desc-&gt;IsSolvable();</span></a>
<a name="1154"><span class="lineNum">    1154 </span>[<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         38 :     const bool watch_only = data.exists(&quot;watchonly&quot;) ? data[&quot;watchonly&quot;].get_bool() : false;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 19 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>][<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 18 was not executed"> # </span><span class="branchNoExec" title="Branch 19 was not executed"> # </span>][<span class="branchNoExec" title="Branch 21 was not executed"> # </span><span class="branchNoExec" title="Branch 22 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 19 times"> + </span>][<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 19 times"> + </span>][<span class="branchCov" title="Branch 30 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<a name="1155"><span class="lineNum">    1155 </span>                :            : </a>
<a name="1156"><span class="lineNum">    1156 </span>                :<span class="lineCov">         19 :     int64_t range_start = 0, range_end = 0;</span></a>
<a name="1157"><span class="lineNum">    1157 </span>[<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         60 :     if (!parsed_desc-&gt;IsRange() &amp;&amp; data.exists(&quot;range&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 11 times"> + </span><span class="branchCov" title="Branch 7 was taken 8 times"> + </span>][<span class="branchCov" title="Branch 9 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 17 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 11 times"> + </span><span class="branchCov" title="Branch 20 was taken 8 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 11 times"> + </span>][<span class="branchNoCov" title="Branch 23 was not taken"> - </span><span class="branchCov" title="Branch 24 was taken 19 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>]
<a name="1158"><span class="lineNum">    1158 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Range should not be specified for an un-ranged descriptor&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1159"><span class="lineNum">    1159 </span>[<span class="branchCov" title="Branch 1 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         38 :     } else if (parsed_desc-&gt;IsRange()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 6 was taken 8 times"> + </span><span class="branchCov" title="Branch 7 was taken 11 times"> + </span>]
<a name="1160"><span class="lineNum">    1160 </span>[<span class="branchCov" title="Branch 1 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         16 :         if (!data.exists(&quot;range&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 8 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 1 time"> + </span><span class="branchCov" title="Branch 12 was taken 7 times"> + </span>][<span class="branchCov" title="Branch 13 was taken 1 time"> + </span><span class="branchCov" title="Branch 14 was taken 7 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="1161"><span class="lineNum">    1161 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Descriptor is ranged, please specify the range&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1162"><span class="lineNum">    1162 </span>                :            :         }</a>
<a name="1163"><span class="lineNum">    1163 </span>[<span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         14 :         std::tie(range_start, range_end) = ParseDescriptorRange(data[&quot;range&quot;]);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 2 times"> + </span><span class="branchCov" title="Branch 11 was taken 5 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 2 times"> + </span>][<span class="branchNoCov" title="Branch 14 was not taken"> - </span><span class="branchCov" title="Branch 15 was taken 2 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchCov" title="Branch 17 was taken 2 times"> + </span>][<span class="branchNoCov" title="Branch 18 was not taken"> - </span><span class="branchCov" title="Branch 19 was taken 5 times"> + </span>]
<a name="1164"><span class="lineNum">    1164 </span>                :            :     }</a>
<a name="1165"><span class="lineNum">    1165 </span>                :            : </a>
<a name="1166"><span class="lineNum">    1166 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         40 :     const UniValue&amp; priv_keys = data.exists(&quot;keys&quot;) ? data[&quot;keys&quot;].get_array() : UniValue();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 1 time"> + </span><span class="branchCov" title="Branch 10 was taken 12 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 24 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>][<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 1 time"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 28 was not taken"> - </span><span class="branchCov" title="Branch 29 was taken 13 times"> + </span>][<span class="branchCov" title="Branch 30 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<a name="1167"><span class="lineNum">    1167 </span>                :            : </a>
<a name="1168"><span class="lineNum">    1168 </span>                :            :     // Expand all descriptors to get public keys and scripts, and private keys if available.</a>
<a name="1169"><span class="lineNum">    1169 </span>        [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchCov" title="Branch 1 was taken 13 times"> + </span>]:<span class="lineCov">         31 :     for (int i = range_start; i &lt;= range_end; ++i) {</span></a>
<a name="1170"><span class="lineNum">    1170 </span>        [<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         36 :         FlatSigningProvider out_keys;</span></a>
<a name="1171"><span class="lineNum">    1171 </span>        [<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         18 :         std::vector&lt;CScript&gt; scripts_temp;</span></a>
<a name="1172"><span class="lineNum">    1172 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         36 :         parsed_desc-&gt;Expand(i, keys, scripts_temp, out_keys);</span></a>
<a name="1173"><span class="lineNum">    1173 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         90 :         std::copy(scripts_temp.begin(), scripts_temp.end(), std::inserter(script_pub_keys, script_pub_keys.end()));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 13 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<a name="1174"><span class="lineNum">    1174 </span>[<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 16 times"> + </span><span class="branchCov" title="Branch 3 was taken 18 times"> + </span>]:<span class="lineCov">         70 :         for (const auto&amp; key_pair : out_keys.pubkeys) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="1175"><span class="lineNum">    1175 </span>        [<span class="branchCov" title="Branch 1 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         16 :             ordered_pubkeys.push_back(key_pair.first);</span></a>
<a name="1176"><span class="lineNum">    1176 </span>                :            :         }</a>
<a name="1177"><span class="lineNum">    1177 </span>                :            : </a>
<a name="1178"><span class="lineNum">    1178 </span>[<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 5 times"> + </span><span class="branchCov" title="Branch 3 was taken 18 times"> + </span>]:<span class="lineCov">         64 :         for (const auto&amp; x : out_keys.scripts) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="1179"><span class="lineNum">    1179 </span>        [<span class="branchCov" title="Branch 1 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          5 :             import_data.import_scripts.emplace(x.second);</span></a>
<a name="1180"><span class="lineNum">    1180 </span>                :            :         }</a>
<a name="1181"><span class="lineNum">    1181 </span>                :            : </a>
<a name="1182"><span class="lineNum">    1182 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         36 :         parsed_desc-&gt;ExpandPrivate(i, keys, out_keys);</span></a>
<a name="1183"><span class="lineNum">    1183 </span>                :            : </a>
<a name="1184"><span class="lineNum">    1184 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         90 :         std::copy(out_keys.pubkeys.begin(), out_keys.pubkeys.end(), std::inserter(pubkey_map, pubkey_map.end()));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 13 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<a name="1185"><span class="lineNum">    1185 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         90 :         std::copy(out_keys.keys.begin(), out_keys.keys.end(), std::inserter(privkey_map, privkey_map.end()));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 13 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<a name="1186"><span class="lineNum">    1186 </span>[<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         54 :         import_data.key_origins.insert(out_keys.origins.begin(), out_keys.origins.end());</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="1187"><span class="lineNum">    1187 </span>                :            :     }</a>
<a name="1188"><span class="lineNum">    1188 </span>                :            : </a>
<a name="1189"><span class="lineNum">    1189 </span>[<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 13 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchCov" title="Branch 3 was taken 13 times"> + </span>]:<span class="lineCov">         28 :     for (size_t i = 0; i &lt; priv_keys.size(); ++i) {</span></a>
<a name="1190"><span class="lineNum">    1190 </span>[<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          1 :         const auto&amp; str = priv_keys[i].get_str();</span></a>
<a name="1191"><span class="lineNum">    1191 </span>[<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          3 :         CKey key = DecodeSecret(str);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="1192"><span class="lineNum">    1192 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 1 time"> + </span>]:<span class="lineCov">          2 :         if (!key.IsValid()) {</span></a>
<a name="1193"><span class="lineNum">    1193 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid private key encoding&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1194"><span class="lineNum">    1194 </span>                :            :         }</a>
<a name="1195"><span class="lineNum">    1195 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :         CPubKey pubkey = key.GetPubKey();</span></a>
<a name="1196"><span class="lineNum">    1196 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :         CKeyID id = pubkey.GetID();</span></a>
<a name="1197"><span class="lineNum">    1197 </span>                :            : </a>
<a name="1198"><span class="lineNum">    1198 </span>                :            :         // Check if this private key corresponds to a public key from the descriptor</a>
<a name="1199"><span class="lineNum">    1199 </span>                :<span class="lineCov">          1 :         if (!pubkey_map.count(id)) {</span></a>
<a name="1200"><span class="lineNum">    1200 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :             warnings.push_back(&quot;Ignoring irrelevant private key.&quot;);</span></a>
<a name="1201"><span class="lineNum">    1201 </span>                :            :         } else {</a>
<a name="1202"><span class="lineNum">    1202 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :             privkey_map.emplace(id, key);</span></a>
<a name="1203"><span class="lineNum">    1203 </span>                :            :         }</a>
<a name="1204"><span class="lineNum">    1204 </span>                :            :     }</a>
<a name="1205"><span class="lineNum">    1205 </span>                :            : </a>
<a name="1206"><span class="lineNum">    1206 </span>                :            :     // Check if all the public keys have corresponding private keys in the import for spendability.</a>
<a name="1207"><span class="lineNum">    1207 </span>                :            :     // This does not take into account threshold multisigs which could be spendable without all keys.</a>
<a name="1208"><span class="lineNum">    1208 </span>                :            :     // Thus, threshold multisigs without all keys will be considered not spendable here, even if they are,</a>
<a name="1209"><span class="lineNum">    1209 </span>                :            :     // perhaps triggering a false warning message. This is consistent with the current wallet IsMine check.</a>
<a name="1210"><span class="lineNum">    1210 </span>                :<span class="lineCov">         39 :     bool spendable = std::all_of(pubkey_map.begin(), pubkey_map.end(),</span></a>
<a name="1211"><span class="lineNum">    1211 </span>                :            :         [&amp;](const std::pair&lt;CKeyID, CPubKey&gt;&amp; used_key) {</a>
<a name="1212"><span class="lineNum">    1212 </span>                :<span class="lineCov">         12 :             return privkey_map.count(used_key.first) &gt; 0;</span></a>
<a name="1213"><span class="lineNum">    1213 </span>[<span class="branchCov" title="Branch 3 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>][<span class="branchCov" title="Branch 6 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]:<span class="lineCov">         13 :         }) &amp;&amp; std::all_of(import_data.key_origins.begin(), import_data.key_origins.end(),</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 9 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>][<span class="branchCov" title="Branch 11 was taken 2 times"> + </span><span class="branchCov" title="Branch 12 was taken 4 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchCov" title="Branch 1 was taken 7 times"> + </span>]
<a name="1214"><span class="lineNum">    1214 </span>                :            :         [&amp;](const std::pair&lt;CKeyID, std::pair&lt;CPubKey, KeyOriginInfo&gt;&gt;&amp; entry) {</a>
<a name="1215"><span class="lineNum">    1215 </span>        [<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span>]:<span class="lineCov">         21 :             return privkey_map.count(entry.first) &gt; 0;</span></a>
<a name="1216"><span class="lineNum">    1216 </span>                :<span class="lineCov">         13 :         });</span></a>
<a name="1217"><span class="lineNum">    1217 </span>        [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">         13 :     if (!watch_only &amp;&amp; !spendable) {</span></a>
<a name="1218"><span class="lineNum">    1218 </span>        [<span class="branchCov" title="Branch 1 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          9 :         warnings.push_back(&quot;Some private keys are missing, outputs will be considered watchonly. If this is intentional, specify the watchonly flag.&quot;);</span></a>
<a name="1219"><span class="lineNum">    1219 </span>                :            :     }</a>
<a name="1220"><span class="lineNum">    1220 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 13 times"> + </span>]:<span class="lineCov">         13 :     if (watch_only &amp;&amp; spendable) {</span></a>
<a name="1221"><span class="lineNum">    1221 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         warnings.push_back(&quot;All private keys are provided, outputs will be considered spendable. If this is intentional, do not specify the watchonly flag.&quot;);</span></a>
<a name="1222"><span class="lineNum">    1222 </span>                :            :     }</a>
<a name="1223"><span class="lineNum">    1223 </span>                :            : </a>
<a name="1224"><span class="lineNum">    1224 </span>                :<span class="lineCov">         26 :     return warnings;</span></a>
<a name="1225"><span class="lineNum">    1225 </span>                :            : }</a>
<a name="1226"><span class="lineNum">    1226 </span>                :            : </a>
<a name="1227"><span class="lineNum">    1227 </span>                :<span class="lineCov">         95 : static UniValue ProcessImport(CWallet * const pwallet, const UniValue&amp; data, const int64_t timestamp) EXCLUSIVE_LOCKS_REQUIRED(pwallet-&gt;cs_wallet)</span></a>
<a name="1228"><span class="lineNum">    1228 </span>                :            : {</a>
<a name="1229"><span class="lineNum">    1229 </span>        [<span class="branchCov" title="Branch 3 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        190 :     UniValue warnings(UniValue::VARR);</span></a>
<a name="1230"><span class="lineNum">    1230 </span>[<span class="branchCov" title="Branch 1 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        285 :     UniValue result(UniValue::VOBJ);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="1231"><span class="lineNum">    1231 </span>                :            : </a>
<a name="1232"><span class="lineNum">    1232 </span>                :<span class="lineCov">         95 :     try {</span></a>
<a name="1233"><span class="lineNum">    1233 </span>[<span class="branchCov" title="Branch 1 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        201 :         const bool internal = data.exists(&quot;internal&quot;) ? data[&quot;internal&quot;].get_bool() : false;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 11 times"> + </span><span class="branchCov" title="Branch 10 was taken 84 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 23 was taken 11 times"> + </span><span class="branchCov" title="Branch 24 was taken 84 times"> + </span>][<span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 11 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 95 times"> + </span>][<span class="branchCov" title="Branch 29 was taken 10 times"> + </span><span class="branchCov" title="Branch 30 was taken 85 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 31 was not executed"> # </span><span class="branchNoExec" title="Branch 32 was not executed"> # </span>][<span class="branchNoExec" title="Branch 33 was not executed"> # </span><span class="branchNoExec" title="Branch 34 was not executed"> # </span>]
<a name="1234"><span class="lineNum">    1234 </span>                :            :         // Internal addresses should not have a label</a>
<a name="1235"><span class="lineNum">    1235 </span>[<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchCov" title="Branch 1 was taken 85 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        114 :         if (internal &amp;&amp; data.exists(&quot;label&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 9 times"> + </span><span class="branchCov" title="Branch 12 was taken 1 time"> + </span>][<span class="branchCov" title="Branch 13 was taken 10 times"> + </span><span class="branchCov" title="Branch 14 was taken 85 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 10 times"> + </span>][<span class="branchCov" title="Branch 17 was taken 1 time"> + </span><span class="branchCov" title="Branch 18 was taken 94 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 19 was not executed"> # </span><span class="branchNoExec" title="Branch 20 was not executed"> # </span>]
<a name="1236"><span class="lineNum">    1236 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Internal addresses should not have a label&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1237"><span class="lineNum">    1237 </span>                :            :         }</a>
<a name="1238"><span class="lineNum">    1238 </span>[<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        245 :         const std::string&amp; label = data.exists(&quot;label&quot;) ? data[&quot;label&quot;].get_str() : &quot;&quot;;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 39 times"> + </span><span class="branchCov" title="Branch 10 was taken 55 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 39 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 39 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 39 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 39 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 24 was taken 39 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>][<span class="branchCov" title="Branch 27 was taken 55 times"> + </span><span class="branchNoCov" title="Branch 28 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 30 was taken 55 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>][<span class="branchCov" title="Branch 32 was taken 39 times"> + </span><span class="branchCov" title="Branch 33 was taken 55 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchCov" title="Branch 35 was taken 39 times"> + </span>][<span class="branchNoCov" title="Branch 36 was not taken"> - </span><span class="branchCov" title="Branch 37 was taken 94 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 39 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 40 was not taken"> - </span>][<span class="branchNoExec" title="Branch 41 was not executed"> # </span><span class="branchNoExec" title="Branch 42 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 43 was not executed"> # </span><span class="branchNoExec" title="Branch 44 was not executed"> # </span>][<span class="branchNoExec" title="Branch 45 was not executed"> # </span><span class="branchNoExec" title="Branch 46 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 47 was taken 1 time"> + </span><span class="branchCov" title="Branch 48 was taken 16 times"> + </span>]
<a name="1239"><span class="lineNum">    1239 </span>[<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        195 :         const bool add_keypool = data.exists(&quot;keypool&quot;) ? data[&quot;keypool&quot;].get_bool() : false;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 7 times"> + </span><span class="branchCov" title="Branch 10 was taken 87 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 21 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 23 was taken 7 times"> + </span><span class="branchCov" title="Branch 24 was taken 87 times"> + </span>][<span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 7 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 94 times"> + </span>][<span class="branchCov" title="Branch 29 was taken 7 times"> + </span><span class="branchCov" title="Branch 30 was taken 87 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 31 was not executed"> # </span><span class="branchNoExec" title="Branch 32 was not executed"> # </span>][<span class="branchNoExec" title="Branch 33 was not executed"> # </span><span class="branchNoExec" title="Branch 34 was not executed"> # </span>]
<a name="1240"><span class="lineNum">    1240 </span>                :            : </a>
<a name="1241"><span class="lineNum">    1241 </span>                :            :         // Add to keypool only works with privkeys disabled</a>
<a name="1242"><span class="lineNum">    1242 </span>[<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchCov" title="Branch 1 was taken 87 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         94 :         if (add_keypool &amp;&amp; !pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchCov" title="Branch 6 was taken 6 times"> + </span>]
<a name="1243"><span class="lineNum">    1243 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Keys can only be imported to the keypool when private keys are disabled&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1244"><span class="lineNum">    1244 </span>                :            :         }</a>
<a name="1245"><span class="lineNum">    1245 </span>                :            : </a>
<a name="1246"><span class="lineNum">    1246 </span>  [<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 38 times"> + </span><span class="branchCov" title="Branch 4 was taken 39 times"> + </span>]:<span class="lineCov">        186 :         ImportData import_data;</span></a>
<a name="1247"><span class="lineNum">    1247 </span>        [<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        186 :         std::map&lt;CKeyID, CPubKey&gt; pubkey_map;</span></a>
<a name="1248"><span class="lineNum">    1248 </span>        [<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        186 :         std::map&lt;CKeyID, CKey&gt; privkey_map;</span></a>
<a name="1249"><span class="lineNum">    1249 </span>        [<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        186 :         std::set&lt;CScript&gt; script_pub_keys;</span></a>
<a name="1250"><span class="lineNum">    1250 </span>[<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 16 times"> + </span>]:<span class="lineCov">        186 :         std::vector&lt;CKeyID&gt; ordered_pubkeys;</span></a>
<a name="1251"><span class="lineNum">    1251 </span>                :<span class="lineCov">         93 :         bool have_solving_data;</span></a>
<a name="1252"><span class="lineNum">    1252 </span>                :            : </a>
<a name="1253"><span class="lineNum">    1253 </span>[<span class="branchCov" title="Branch 1 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        329 :         if (data.exists(&quot;scriptPubKey&quot;) &amp;&amp; data.exists(&quot;desc&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 72 times"> + </span><span class="branchCov" title="Branch 10 was taken 21 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 72 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 72 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 18 was taken 72 times"> + </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span>][<span class="branchCov" title="Branch 20 was taken 71 times"> + </span><span class="branchCov" title="Branch 21 was taken 1 time"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 72 times"> + </span><span class="branchCov" title="Branch 23 was taken 21 times"> + </span>][<span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 72 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchCov" title="Branch 27 was taken 93 times"> + </span>][<span class="branchCov" title="Branch 28 was taken 1 time"> + </span><span class="branchCov" title="Branch 29 was taken 92 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 30 was not executed"> # </span><span class="branchNoExec" title="Branch 31 was not executed"> # </span>][<span class="branchNoExec" title="Branch 32 was not executed"> # </span><span class="branchNoExec" title="Branch 33 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>][<span class="branchNoExec" title="Branch 36 was not executed"> # </span><span class="branchNoExec" title="Branch 37 was not executed"> # </span>]
<a name="1254"><span class="lineNum">    1254 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Both a descriptor and a scriptPubKey should not be provided.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1255"><span class="lineNum">    1255 </span>[<span class="branchCov" title="Branch 1 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        184 :         } else if (data.exists(&quot;scriptPubKey&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 92 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 71 times"> + </span><span class="branchCov" title="Branch 12 was taken 21 times"> + </span>][<span class="branchCov" title="Branch 13 was taken 71 times"> + </span><span class="branchCov" title="Branch 14 was taken 21 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="1256"><span class="lineNum">    1256 </span>[<span class="branchCov" title="Branch 1 was taken 67 times"> + </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span>][<span class="branchCov" title="Branch 4 was taken 67 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         71 :             warnings = ProcessImportLegacy(import_data, pubkey_map, privkey_map, script_pub_keys, have_solving_data, data, ordered_pubkeys);</span></a>
<a name="1257"><span class="lineNum">    1257 </span>[<span class="branchCov" title="Branch 1 was taken 21 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 21 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         42 :         } else if (data.exists(&quot;desc&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 21 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 21 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 20 times"> + </span><span class="branchCov" title="Branch 12 was taken 1 time"> + </span>][<span class="branchCov" title="Branch 13 was taken 20 times"> + </span><span class="branchCov" title="Branch 14 was taken 1 time"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="1258"><span class="lineNum">    1258 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchCov" title="Branch 2 was taken 7 times"> + </span>][<span class="branchCov" title="Branch 4 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         20 :             warnings = ProcessImportDescriptor(import_data, pubkey_map, privkey_map, script_pub_keys, have_solving_data, data, ordered_pubkeys);</span></a>
<a name="1259"><span class="lineNum">    1259 </span>                :            :         } else {</a>
<a name="1260"><span class="lineNum">    1260 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Either a descriptor or scriptPubKey must be provided.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1261"><span class="lineNum">    1261 </span>                :            :         }</a>
<a name="1262"><span class="lineNum">    1262 </span>                :            : </a>
<a name="1263"><span class="lineNum">    1263 </span>                :            :         // If private keys are disabled, abort if private keys are being imported</a>
<a name="1264"><span class="lineNum">    1264 </span>[<span class="branchCov" title="Branch 1 was taken 80 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 8 times"> + </span><span class="branchCov" title="Branch 4 was taken 72 times"> + </span>]:<span class="lineCov">         80 :         if (pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS) &amp;&amp; !privkey_map.empty()) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 6 times"> + </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span>][<span class="branchCov" title="Branch 7 was taken 6 times"> + </span><span class="branchCov" title="Branch 8 was taken 2 times"> + </span>]
<a name="1265"><span class="lineNum">    1265 </span>  [<span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          6 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Cannot import private keys to a wallet with private keys disabled&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1266"><span class="lineNum">    1266 </span>                :            :         }</a>
<a name="1267"><span class="lineNum">    1267 </span>                :            : </a>
<a name="1268"><span class="lineNum">    1268 </span>                :            :         // Check whether we have any work to do</a>
<a name="1269"><span class="lineNum">    1269 </span>[<span class="branchCov" title="Branch 0 was taken 83 times"> + </span><span class="branchCov" title="Branch 1 was taken 77 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 83 times"> + </span><span class="branchCov" title="Branch 3 was taken 77 times"> + </span>]:<span class="lineCov">        316 :         for (const CScript&amp; script : script_pub_keys) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 83 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="1270"><span class="lineNum">    1270 </span>[<span class="branchCov" title="Branch 1 was taken 83 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1 time"> + </span><span class="branchCov" title="Branch 4 was taken 82 times"> + </span>]:<span class="lineCov">         83 :             if (::IsMine(*pwallet, script) &amp; ISMINE_SPENDABLE) {</span></a>
<a name="1271"><span class="lineNum">    1271 </span>[<span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span>][<span class="branchCov" title="Branch 3 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          4 :                 throw JSONRPCError(RPC_WALLET_ERROR, &quot;The wallet already contains the private key for this address or script (\&quot;&quot; + HexStr(script.begin(), script.end()) + &quot;\&quot;)&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 6 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>][<span class="branchCov" title="Branch 9 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 17 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span>][<span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1 time"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1 time"> + </span>][<span class="branchNoExec" title="Branch 24 was not executed"> # </span><span class="branchNoExec" title="Branch 25 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 26 was not executed"> # </span><span class="branchNoExec" title="Branch 27 was not executed"> # </span>][<span class="branchNoExec" title="Branch 28 was not executed"> # </span><span class="branchNoExec" title="Branch 29 was not executed"> # </span>]
<a name="1272"><span class="lineNum">    1272 </span>                :            :             }</a>
<a name="1273"><span class="lineNum">    1273 </span>                :            :         }</a>
<a name="1274"><span class="lineNum">    1274 </span>                :            : </a>
<a name="1275"><span class="lineNum">    1275 </span>                :            :         // All good, time to import</a>
<a name="1276"><span class="lineNum">    1276 </span>        [<span class="branchCov" title="Branch 1 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         77 :         pwallet-&gt;MarkDirty();</span></a>
<a name="1277"><span class="lineNum">    1277 </span>[<span class="branchCov" title="Branch 1 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         77 :         if (!pwallet-&gt;ImportScripts(import_data.import_scripts)) {</span></a>
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 77 times"> + </span>]
<a name="1278"><span class="lineNum">    1278 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error adding script to wallet&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1279"><span class="lineNum">    1279 </span>                :            :         }</a>
<a name="1280"><span class="lineNum">    1280 </span>[<span class="branchCov" title="Branch 1 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 77 times"> + </span>]:<span class="lineCov">         77 :         if (!pwallet-&gt;ImportPrivKeys(privkey_map, timestamp)) {</span></a>
<a name="1281"><span class="lineNum">    1281 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error adding key to wallet&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1282"><span class="lineNum">    1282 </span>                :            :         }</a>
<a name="1283"><span class="lineNum">    1283 </span>[<span class="branchCov" title="Branch 1 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 77 times"> + </span>]:<span class="lineCov">         77 :         if (!pwallet-&gt;ImportPubKeys(ordered_pubkeys, pubkey_map, import_data.key_origins, add_keypool, internal, timestamp)) {</span></a>
<a name="1284"><span class="lineNum">    1284 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error adding address to wallet&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1285"><span class="lineNum">    1285 </span>                :            :         }</a>
<a name="1286"><span class="lineNum">    1286 </span>[<span class="branchCov" title="Branch 1 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 77 times"> + </span>]:<span class="lineCov">         77 :         if (!pwallet-&gt;ImportScriptPubKeys(label, script_pub_keys, have_solving_data, internal, timestamp)) {</span></a>
<a name="1287"><span class="lineNum">    1287 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error adding address to wallet&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1288"><span class="lineNum">    1288 </span>                :            :         }</a>
<a name="1289"><span class="lineNum">    1289 </span>                :            : </a>
<a name="1290"><span class="lineNum">    1290 </span>[<span class="branchCov" title="Branch 1 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         77 :         result.pushKV(&quot;success&quot;, UniValue(true));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 77 times"> + </span>][<span class="branchCov" title="Branch 16 was taken 30 times"> + </span><span class="branchCov" title="Branch 17 was taken 47 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 18 was not executed"> # </span><span class="branchNoExec" title="Branch 19 was not executed"> # </span>]
<a name="1291"><span class="lineNum">    1291 </span>                :<span class="lineCov">         18 :     } catch (const UniValue&amp; e) {</span></a>
<a name="1292"><span class="lineNum">    1292 </span>[<span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">         18 :         result.pushKV(&quot;success&quot;, UniValue(false));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 18 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>][<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="1293"><span class="lineNum">    1293 </span>[<span class="branchCov" title="Branch 7 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 18 times"> + </span>]:<span class="lineCov">         36 :         result.pushKV(&quot;error&quot;, e);</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>]
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1294"><span class="lineNum">    1294 </span>                :<span class="lineNoCov">          0 :     } catch (...) {</span></a>
<a name="1295"><span class="lineNum">    1295 </span>[<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>][<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]:<span class="lineNoCov">          0 :         result.pushKV(&quot;success&quot;, UniValue(false));</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>][<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]
<a name="1296"><span class="lineNum">    1296 </span>                :            : </a>
<a name="1297"><span class="lineNum">    1297 </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]:<span class="lineNoCov">          0 :         result.pushKV(&quot;error&quot;, JSONRPCError(RPC_MISC_ERROR, &quot;Missing required fields&quot;));</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>][<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 18 was not executed"> # </span><span class="branchNoExec" title="Branch 19 was not executed"> # </span>][<span class="branchNoExec" title="Branch 22 was not executed"> # </span><span class="branchNoExec" title="Branch 23 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>][<span class="branchNoExec" title="Branch 28 was not executed"> # </span><span class="branchNoExec" title="Branch 29 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 30 was not executed"> # </span><span class="branchNoExec" title="Branch 31 was not executed"> # </span>][<span class="branchNoExec" title="Branch 34 was not executed"> # </span><span class="branchNoExec" title="Branch 35 was not executed"> # </span>]
<span class="lineNum">         </span>  [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="1298"><span class="lineNum">    1298 </span>                :            :     }</a>
<a name="1299"><span class="lineNum">    1299 </span>[<span class="branchCov" title="Branch 0 was taken 22 times"> + </span><span class="branchCov" title="Branch 1 was taken 73 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 22 times"> + </span><span class="branchCov" title="Branch 3 was taken 73 times"> + </span>]:<span class="lineCov">        190 :     if (warnings.size()) result.pushKV(&quot;warnings&quot;, warnings);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 8 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>][<span class="branchNoCov" title="Branch 13 was not taken"> - </span><span class="branchCov" title="Branch 14 was taken 22 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="1300"><span class="lineNum">    1300 </span>                :<span class="lineCov">         95 :     return result;</span></a>
<a name="1301"><span class="lineNum">    1301 </span>                :            : }</a>
<a name="1302"><span class="lineNum">    1302 </span>                :            : </a>
<a name="1303"><span class="lineNum">    1303 </span>                :<span class="lineCov">        195 : static int64_t GetImportTimestamp(const UniValue&amp; data, int64_t now)</span></a>
<a name="1304"><span class="lineNum">    1304 </span>                :            : {</a>
<a name="1305"><span class="lineNum">    1305 </span>[<span class="branchCov" title="Branch 3 was taken 195 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>][<span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 195 times"> + </span>]:<span class="lineCov">        390 :     if (data.exists(&quot;timestamp&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 194 times"> + </span><span class="branchCov" title="Branch 8 was taken 1 time"> + </span>][<span class="branchCov" title="Branch 9 was taken 194 times"> + </span><span class="branchCov" title="Branch 10 was taken 1 time"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 11 was not executed"> # </span><span class="branchNoExec" title="Branch 12 was not executed"> # </span>]
<a name="1306"><span class="lineNum">    1306 </span>[<span class="branchCov" title="Branch 3 was taken 194 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>][<span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 194 times"> + </span>]:<span class="lineCov">        388 :         const UniValue&amp; timestamp = data[&quot;timestamp&quot;];</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 79 times"> + </span><span class="branchCov" title="Branch 8 was taken 115 times"> + </span>][<span class="branchNoExec" title="Branch 9 was not executed"> # </span><span class="branchNoExec" title="Branch 10 was not executed"> # </span>]
<a name="1307"><span class="lineNum">    1307 </span>[<span class="branchCov" title="Branch 0 was taken 79 times"> + </span><span class="branchCov" title="Branch 1 was taken 115 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 79 times"> + </span><span class="branchCov" title="Branch 3 was taken 115 times"> + </span>]:<span class="lineCov">        388 :         if (timestamp.isNum()) {</span></a>
<a name="1308"><span class="lineNum">    1308 </span>                :<span class="lineCov">         79 :             return timestamp.get_int64();</span></a>
<a name="1309"><span class="lineNum">    1309 </span>[<span class="branchCov" title="Branch 0 was taken 115 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 115 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        230 :         } else if (timestamp.isStr() &amp;&amp; timestamp.get_str() == &quot;now&quot;) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 6 was taken 1 time"> + </span><span class="branchCov" title="Branch 7 was taken 114 times"> + </span>]
<a name="1310"><span class="lineNum">    1310 </span>                :            :             return now;</a>
<a name="1311"><span class="lineNum">    1311 </span>                :            :         }</a>
<a name="1312"><span class="lineNum">    1312 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          2 :         throw JSONRPCError(RPC_TYPE_ERROR, strprintf(&quot;Expected number or \&quot;now\&quot; timestamp value for key. got type %s&quot;, uvTypeName(timestamp.type())));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 11 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<a name="1313"><span class="lineNum">    1313 </span>                :            :     }</a>
<a name="1314"><span class="lineNum">    1314 </span>  [<span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          3 :     throw JSONRPCError(RPC_TYPE_ERROR, &quot;Missing required timestamp field for key&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1315"><span class="lineNum">    1315 </span>                :            : }</a>
<a name="1316"><span class="lineNum">    1316 </span>                :            : </a>
<a name="1317"><span class="lineNum">    1317 </span>                :<span class="lineCov">         97 : UniValue importmulti(const JSONRPCRequest&amp; mainRequest)</span></a>
<a name="1318"><span class="lineNum">    1318 </span>                :            : {</a>
<a name="1319"><span class="lineNum">    1319 </span>[<span class="branchCov" title="Branch 1 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        286 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(mainRequest);</span></a>
<a name="1320"><span class="lineNum">    1320 </span>        [<span class="branchCov" title="Branch 1 was taken 97 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         97 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="1321"><span class="lineNum">    1321 </span>[<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 97 times"> + </span>][<span class="branchCov" title="Branch 1 was taken 97 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         97 :     if (!EnsureWalletIsAvailable(pwallet, mainRequest.fHelp)) {</span></a>
<a name="1322"><span class="lineNum">    1322 </span>        [<span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span>]:<span class="lineNoCov">          0 :         return NullUniValue;</span></a>
<a name="1323"><span class="lineNum">    1323 </span>                :            :     }</a>
<a name="1324"><span class="lineNum">    1324 </span>                :            : </a>
<a name="1325"><span class="lineNum">    1325 </span>[<span class="branchCov" title="Branch 0 was taken 94 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         97 :     if (mainRequest.fHelp || mainRequest.params.size() &lt; 1 || mainRequest.params.size() &gt; 2)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 4 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 94 times"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 94 times"> + </span>]
<a name="1326"><span class="lineNum">    1326 </span>                :<span class="lineCov">          3 :         throw std::runtime_error(</span></a>
<a name="1327"><span class="lineNum">    1327 </span>[<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]:<span class="lineCov">        159 :             RPCHelpMan{&quot;importmulti&quot;,</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 22 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span>][<span class="branchCov" title="Branch 25 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 28 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span>][<span class="branchCov" title="Branch 31 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 34 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>][<span class="branchCov" title="Branch 37 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 40 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>][<span class="branchCov" title="Branch 43 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 44 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 46 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span>][<span class="branchCov" title="Branch 49 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 50 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 52 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span>][<span class="branchCov" title="Branch 55 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 56 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 58 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span>][<span class="branchCov" title="Branch 61 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 62 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 64 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span>][<span class="branchCov" title="Branch 67 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 68 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 70 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span>][<span class="branchCov" title="Branch 73 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 74 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 76 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span>][<span class="branchCov" title="Branch 79 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 80 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 82 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span>][<span class="branchCov" title="Branch 85 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 86 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 88 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span>][<span class="branchCov" title="Branch 91 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 92 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 94 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span>][<span class="branchCov" title="Branch 97 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 98 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 100 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span>][<span class="branchCov" title="Branch 103 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 104 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 106 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span>][<span class="branchCov" title="Branch 109 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 110 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 112 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span>][<span class="branchCov" title="Branch 115 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 116 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 118 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 119 was not taken"> - </span>][<span class="branchCov" title="Branch 121 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 122 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 124 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 125 was not taken"> - </span>][<span class="branchCov" title="Branch 127 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 128 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 130 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 131 was not taken"> - </span>][<span class="branchCov" title="Branch 133 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 134 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 136 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 137 was not taken"> - </span>][<span class="branchCov" title="Branch 139 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 140 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 142 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 143 was not taken"> - </span>][<span class="branchCov" title="Branch 145 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 146 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 148 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 149 was not taken"> - </span>][<span class="branchCov" title="Branch 151 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 152 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 154 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 155 was not taken"> - </span>][<span class="branchCov" title="Branch 157 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 158 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 160 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 161 was not taken"> - </span>][<span class="branchCov" title="Branch 163 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 164 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 166 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 167 was not taken"> - </span>][<span class="branchCov" title="Branch 169 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 170 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 172 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 173 was not taken"> - </span>][<span class="branchCov" title="Branch 175 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 176 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 178 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 179 was not taken"> - </span>][<span class="branchCov" title="Branch 181 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 182 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 184 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 185 was not taken"> - </span>][<span class="branchCov" title="Branch 187 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 188 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 190 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 191 was not taken"> - </span>][<span class="branchCov" title="Branch 193 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 194 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 196 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 197 was not taken"> - </span>][<span class="branchCov" title="Branch 199 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 200 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 202 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 203 was not taken"> - </span>][<span class="branchCov" title="Branch 205 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 206 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 208 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 209 was not taken"> - </span>][<span class="branchCov" title="Branch 211 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 212 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 214 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 215 was not taken"> - </span>][<span class="branchCov" title="Branch 217 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 218 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 220 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 221 was not taken"> - </span>][<span class="branchCov" title="Branch 223 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 224 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 226 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 227 was not taken"> - </span>][<span class="branchCov" title="Branch 229 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 230 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 232 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 233 was not taken"> - </span>][<span class="branchCov" title="Branch 235 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 236 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 238 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 239 was not taken"> - </span>][<span class="branchCov" title="Branch 241 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 242 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 244 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 245 was not taken"> - </span>][<span class="branchCov" title="Branch 247 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 248 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 250 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 251 was not taken"> - </span>][<span class="branchCov" title="Branch 253 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 254 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 256 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 257 was not taken"> - </span>][<span class="branchCov" title="Branch 259 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 260 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 262 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 263 was not taken"> - </span>][<span class="branchCov" title="Branch 265 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 266 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 268 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 269 was not taken"> - </span>][<span class="branchCov" title="Branch 271 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 272 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 274 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 275 was not taken"> - </span>][<span class="branchCov" title="Branch 277 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 278 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 280 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 281 was not taken"> - </span>][<span class="branchCov" title="Branch 283 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 284 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 286 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 287 was not taken"> - </span>][<span class="branchCov" title="Branch 289 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 290 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 292 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 293 was not taken"> - </span>][<span class="branchCov" title="Branch 295 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 296 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 298 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 299 was not taken"> - </span>][<span class="branchCov" title="Branch 301 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 302 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 304 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 305 was not taken"> - </span>][<span class="branchCov" title="Branch 307 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 308 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 310 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 311 was not taken"> - </span>][<span class="branchCov" title="Branch 313 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 314 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 316 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 317 was not taken"> - </span>][<span class="branchCov" title="Branch 319 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 320 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 322 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 323 was not taken"> - </span>][<span class="branchCov" title="Branch 325 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 326 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 328 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 329 was not taken"> - </span>][<span class="branchCov" title="Branch 331 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 332 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 334 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 335 was not taken"> - </span>][<span class="branchCov" title="Branch 337 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 338 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 340 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 341 was not taken"> - </span>][<span class="branchCov" title="Branch 343 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 344 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 346 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 347 was not taken"> - </span>][<span class="branchCov" title="Branch 349 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 350 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 352 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 353 was not taken"> - </span>][<span class="branchCov" title="Branch 355 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 356 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 358 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 359 was not taken"> - </span>][<span class="branchCov" title="Branch 361 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 362 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 364 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 365 was not taken"> - </span>][<span class="branchCov" title="Branch 367 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 368 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 370 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 371 was not taken"> - </span>][<span class="branchCov" title="Branch 373 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 374 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 376 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 377 was not taken"> - </span>][<span class="branchCov" title="Branch 379 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 380 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 382 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 383 was not taken"> - </span>][<span class="branchCov" title="Branch 385 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 386 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 388 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 389 was not taken"> - </span>][<span class="branchCov" title="Branch 391 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 392 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 394 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 395 was not taken"> - </span>][<span class="branchCov" title="Branch 397 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 398 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 400 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 401 was not taken"> - </span>][<span class="branchCov" title="Branch 403 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 404 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 406 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 407 was not taken"> - </span>][<span class="branchCov" title="Branch 409 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 410 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 412 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 413 was not taken"> - </span>][<span class="branchCov" title="Branch 415 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 416 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 418 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 419 was not taken"> - </span>][<span class="branchCov" title="Branch 421 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 422 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 424 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 425 was not taken"> - </span>][<span class="branchCov" title="Branch 427 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 428 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 430 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 431 was not taken"> - </span>][<span class="branchCov" title="Branch 433 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 434 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 436 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 437 was not taken"> - </span>][<span class="branchCov" title="Branch 439 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 440 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 442 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 443 was not taken"> - </span>][<span class="branchCov" title="Branch 445 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 446 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 448 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 449 was not taken"> - </span>][<span class="branchCov" title="Branch 451 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 452 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 454 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 455 was not taken"> - </span>][<span class="branchCov" title="Branch 457 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 458 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 460 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 461 was not taken"> - </span>][<span class="branchCov" title="Branch 463 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 464 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 466 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 467 was not taken"> - </span>][<span class="branchCov" title="Branch 469 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 470 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 472 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 473 was not taken"> - </span>][<span class="branchCov" title="Branch 475 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 476 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 478 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 479 was not taken"> - </span>][<span class="branchCov" title="Branch 481 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 482 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 484 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 485 was not taken"> - </span>][<span class="branchCov" title="Branch 487 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 488 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 490 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 491 was not taken"> - </span>][<span class="branchCov" title="Branch 493 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 494 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 496 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 497 was not taken"> - </span>][<span class="branchCov" title="Branch 499 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 500 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 502 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 503 was not taken"> - </span>][<span class="branchCov" title="Branch 505 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 506 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 508 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 509 was not taken"> - </span>][<span class="branchCov" title="Branch 511 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 512 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 514 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 515 was not taken"> - </span>][<span class="branchCov" title="Branch 517 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 518 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 520 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 521 was not taken"> - </span>][<span class="branchCov" title="Branch 523 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 524 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 526 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 527 was not taken"> - </span>][<span class="branchCov" title="Branch 529 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 530 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 532 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 533 was not taken"> - </span>][<span class="branchCov" title="Branch 535 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 536 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 538 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 539 was not taken"> - </span>][<span class="branchCov" title="Branch 541 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 542 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 544 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 545 was not taken"> - </span>][<span class="branchCov" title="Branch 547 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 548 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 550 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 551 was not taken"> - </span>][<span class="branchCov" title="Branch 553 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 554 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 556 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 557 was not taken"> - </span>]
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 559 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 560 was not taken"> - </span><span class="branchCov" title="Branch 562 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 563 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 565 was taken 6 times"> + </span><span class="branchCov" title="Branch 566 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 568 was not taken"> - </span><span class="branchCov" title="Branch 569 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 573 was taken 3 times"> + </span><span class="branchCov" title="Branch 574 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 576 was not taken"> - </span><span class="branchCov" title="Branch 577 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 578 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 579 was not taken"> - </span>][<span class="branchCov" title="Branch 580 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 581 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 584 was not taken"> - </span><span class="branchCov" title="Branch 585 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 586 was not taken"> - </span><span class="branchCov" title="Branch 587 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 588 was not taken"> - </span><span class="branchCov" title="Branch 589 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 592 was not taken"> - </span><span class="branchCov" title="Branch 593 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 596 was not taken"> - </span><span class="branchCov" title="Branch 597 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 601 was taken 3 times"> + </span><span class="branchCov" title="Branch 602 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 604 was not taken"> - </span><span class="branchCov" title="Branch 605 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 609 was taken 36 times"> + </span><span class="branchCov" title="Branch 610 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 612 was not taken"> - </span><span class="branchCov" title="Branch 613 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 614 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 615 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 616 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 617 was not taken"> - </span>][<span class="branchNoCov" title="Branch 620 was not taken"> - </span><span class="branchCov" title="Branch 621 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 624 was not taken"> - </span><span class="branchCov" title="Branch 625 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 626 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 627 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 628 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 629 was not taken"> - </span>][<span class="branchNoCov" title="Branch 632 was not taken"> - </span><span class="branchCov" title="Branch 633 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 636 was not taken"> - </span><span class="branchCov" title="Branch 637 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 638 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 639 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 640 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 641 was not taken"> - </span>][<span class="branchNoCov" title="Branch 644 was not taken"> - </span><span class="branchCov" title="Branch 645 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 648 was not taken"> - </span><span class="branchCov" title="Branch 649 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 650 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 651 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 652 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 653 was not taken"> - </span>][<span class="branchNoCov" title="Branch 656 was not taken"> - </span><span class="branchCov" title="Branch 657 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 660 was not taken"> - </span><span class="branchCov" title="Branch 661 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 662 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 663 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 664 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 665 was not taken"> - </span>][<span class="branchNoCov" title="Branch 668 was not taken"> - </span><span class="branchCov" title="Branch 669 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 672 was not taken"> - </span><span class="branchCov" title="Branch 673 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 677 was taken 3 times"> + </span><span class="branchCov" title="Branch 678 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 680 was not taken"> - </span><span class="branchCov" title="Branch 681 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 682 was not taken"> - </span><span class="branchCov" title="Branch 683 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 684 was not taken"> - </span><span class="branchCov" title="Branch 685 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 688 was not taken"> - </span><span class="branchCov" title="Branch 689 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 690 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 691 was not taken"> - </span>][<span class="branchCov" title="Branch 692 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 693 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 696 was not taken"> - </span><span class="branchCov" title="Branch 697 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 700 was not taken"> - </span><span class="branchCov" title="Branch 701 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 705 was taken 3 times"> + </span><span class="branchCov" title="Branch 706 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 708 was not taken"> - </span><span class="branchCov" title="Branch 709 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 710 was not taken"> - </span><span class="branchCov" title="Branch 711 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 712 was not taken"> - </span><span class="branchCov" title="Branch 713 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 716 was not taken"> - </span><span class="branchCov" title="Branch 717 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 718 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 719 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 720 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 721 was not taken"> - </span>][<span class="branchNoCov" title="Branch 724 was not taken"> - </span><span class="branchCov" title="Branch 725 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 728 was not taken"> - </span><span class="branchCov" title="Branch 729 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 730 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 731 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 732 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 733 was not taken"> - </span>][<span class="branchNoCov" title="Branch 736 was not taken"> - </span><span class="branchCov" title="Branch 737 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 740 was not taken"> - </span><span class="branchCov" title="Branch 741 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 742 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 743 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 744 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 745 was not taken"> - </span>][<span class="branchNoCov" title="Branch 748 was not taken"> - </span><span class="branchCov" title="Branch 749 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 753 was taken 6 times"> + </span><span class="branchCov" title="Branch 754 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 755 was not taken"> - </span><span class="branchCov" title="Branch 756 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 757 was not taken"> - </span><span class="branchCov" title="Branch 758 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 759 was not taken"> - </span><span class="branchCov" title="Branch 760 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 761 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 762 was not taken"> - </span>][<span class="branchCov" title="Branch 763 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 764 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 767 was not taken"> - </span><span class="branchCov" title="Branch 768 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 772 was taken 6 times"> + </span><span class="branchCov" title="Branch 773 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 774 was not taken"> - </span><span class="branchCov" title="Branch 775 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 776 was not taken"> - </span><span class="branchCov" title="Branch 777 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 778 was not taken"> - </span><span class="branchCov" title="Branch 779 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 780 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 781 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 782 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 783 was not taken"> - </span>][<span class="branchNoCov" title="Branch 786 was not taken"> - </span><span class="branchCov" title="Branch 787 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 790 was not taken"> - </span><span class="branchCov" title="Branch 791 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 792 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 793 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 794 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 795 was not taken"> - </span>][<span class="branchNoCov" title="Branch 798 was not taken"> - </span><span class="branchCov" title="Branch 799 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 800 was not taken"> - </span><span class="branchCov" title="Branch 801 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 802 was not taken"> - </span><span class="branchCov" title="Branch 803 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 806 was not taken"> - </span><span class="branchCov" title="Branch 807 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 808 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 809 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 810 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 811 was not taken"> - </span>][<span class="branchNoCov" title="Branch 814 was not taken"> - </span><span class="branchCov" title="Branch 815 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 816 was not taken"> - </span><span class="branchCov" title="Branch 817 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 818 was not taken"> - </span><span class="branchCov" title="Branch 819 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 820 was not taken"> - </span><span class="branchCov" title="Branch 821 was taken 3 times"> + </span>][<span class="branchNoCov" title="Branch 822 was not taken"> - </span><span class="branchCov" title="Branch 823 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 826 was not executed"> # </span><span class="branchNoExec" title="Branch 827 was not executed"> # </span>][<span class="branchNoExec" title="Branch 829 was not executed"> # </span><span class="branchNoExec" title="Branch 830 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 833 was not executed"> # </span><span class="branchNoExec" title="Branch 834 was not executed"> # </span>][<span class="branchNoExec" title="Branch 836 was not executed"> # </span><span class="branchNoExec" title="Branch 837 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 838 was not executed"> # </span><span class="branchNoExec" title="Branch 839 was not executed"> # </span>][<span class="branchNoExec" title="Branch 840 was not executed"> # </span><span class="branchNoExec" title="Branch 841 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 844 was not executed"> # </span><span class="branchNoExec" title="Branch 845 was not executed"> # </span>][<span class="branchNoExec" title="Branch 846 was not executed"> # </span><span class="branchNoExec" title="Branch 847 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 848 was not executed"> # </span><span class="branchNoExec" title="Branch 849 was not executed"> # </span>][<span class="branchNoExec" title="Branch 852 was not executed"> # </span><span class="branchNoExec" title="Branch 853 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 855 was not executed"> # </span><span class="branchNoExec" title="Branch 856 was not executed"> # </span>][<span class="branchNoExec" title="Branch 859 was not executed"> # </span><span class="branchNoExec" title="Branch 860 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 862 was not executed"> # </span><span class="branchNoExec" title="Branch 863 was not executed"> # </span>][<span class="branchNoExec" title="Branch 866 was not executed"> # </span><span class="branchNoExec" title="Branch 867 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 869 was not executed"> # </span><span class="branchNoExec" title="Branch 870 was not executed"> # </span>][<span class="branchNoExec" title="Branch 871 was not executed"> # </span><span class="branchNoExec" title="Branch 872 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 873 was not executed"> # </span><span class="branchNoExec" title="Branch 874 was not executed"> # </span>][<span class="branchNoExec" title="Branch 877 was not executed"> # </span><span class="branchNoExec" title="Branch 878 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 880 was not executed"> # </span><span class="branchNoExec" title="Branch 881 was not executed"> # </span>][<span class="branchNoExec" title="Branch 882 was not executed"> # </span><span class="branchNoExec" title="Branch 883 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 884 was not executed"> # </span><span class="branchNoExec" title="Branch 885 was not executed"> # </span>][<span class="branchNoExec" title="Branch 888 was not executed"> # </span><span class="branchNoExec" title="Branch 889 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 891 was not executed"> # </span><span class="branchNoExec" title="Branch 892 was not executed"> # </span>][<span class="branchNoExec" title="Branch 893 was not executed"> # </span><span class="branchNoExec" title="Branch 894 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 895 was not executed"> # </span><span class="branchNoExec" title="Branch 896 was not executed"> # </span>][<span class="branchNoExec" title="Branch 899 was not executed"> # </span><span class="branchNoExec" title="Branch 900 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 902 was not executed"> # </span><span class="branchNoExec" title="Branch 903 was not executed"> # </span>][<span class="branchNoExec" title="Branch 904 was not executed"> # </span><span class="branchNoExec" title="Branch 905 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 906 was not executed"> # </span><span class="branchNoExec" title="Branch 907 was not executed"> # </span>][<span class="branchNoExec" title="Branch 910 was not executed"> # </span><span class="branchNoExec" title="Branch 911 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 913 was not executed"> # </span><span class="branchNoExec" title="Branch 914 was not executed"> # </span>][<span class="branchNoExec" title="Branch 915 was not executed"> # </span><span class="branchNoExec" title="Branch 916 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 917 was not executed"> # </span><span class="branchNoExec" title="Branch 918 was not executed"> # </span>][<span class="branchNoExec" title="Branch 921 was not executed"> # </span><span class="branchNoExec" title="Branch 922 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 924 was not executed"> # </span><span class="branchNoExec" title="Branch 925 was not executed"> # </span>][<span class="branchNoExec" title="Branch 928 was not executed"> # </span><span class="branchNoExec" title="Branch 929 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 931 was not executed"> # </span><span class="branchNoExec" title="Branch 932 was not executed"> # </span>][<span class="branchNoExec" title="Branch 933 was not executed"> # </span><span class="branchNoExec" title="Branch 934 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 935 was not executed"> # </span><span class="branchNoExec" title="Branch 936 was not executed"> # </span>][<span class="branchNoExec" title="Branch 939 was not executed"> # </span><span class="branchNoExec" title="Branch 940 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 941 was not executed"> # </span><span class="branchNoExec" title="Branch 942 was not executed"> # </span>][<span class="branchNoExec" title="Branch 943 was not executed"> # </span><span class="branchNoExec" title="Branch 944 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 947 was not executed"> # </span><span class="branchNoExec" title="Branch 948 was not executed"> # </span>][<span class="branchNoExec" title="Branch 950 was not executed"> # </span><span class="branchNoExec" title="Branch 951 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 954 was not executed"> # </span><span class="branchNoExec" title="Branch 955 was not executed"> # </span>][<span class="branchNoExec" title="Branch 957 was not executed"> # </span><span class="branchNoExec" title="Branch 958 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 959 was not executed"> # </span><span class="branchNoExec" title="Branch 960 was not executed"> # </span>][<span class="branchNoExec" title="Branch 961 was not executed"> # </span><span class="branchNoExec" title="Branch 962 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 965 was not executed"> # </span><span class="branchNoExec" title="Branch 966 was not executed"> # </span>][<span class="branchNoExec" title="Branch 967 was not executed"> # </span><span class="branchNoExec" title="Branch 968 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 969 was not executed"> # </span><span class="branchNoExec" title="Branch 970 was not executed"> # </span>][<span class="branchNoExec" title="Branch 973 was not executed"> # </span><span class="branchNoExec" title="Branch 974 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 976 was not executed"> # </span><span class="branchNoExec" title="Branch 977 was not executed"> # </span>][<span class="branchNoExec" title="Branch 978 was not executed"> # </span><span class="branchNoExec" title="Branch 979 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 980 was not executed"> # </span><span class="branchNoExec" title="Branch 981 was not executed"> # </span>][<span class="branchNoExec" title="Branch 984 was not executed"> # </span><span class="branchNoExec" title="Branch 985 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 987 was not executed"> # </span><span class="branchNoExec" title="Branch 988 was not executed"> # </span>][<span class="branchNoExec" title="Branch 989 was not executed"> # </span><span class="branchNoExec" title="Branch 990 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 991 was not executed"> # </span><span class="branchNoExec" title="Branch 992 was not executed"> # </span>][<span class="branchNoExec" title="Branch 995 was not executed"> # </span><span class="branchNoExec" title="Branch 996 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 998 was not executed"> # </span><span class="branchNoExec" title="Branch 999 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1000 was not executed"> # </span><span class="branchNoExec" title="Branch 1001 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1002 was not executed"> # </span><span class="branchNoExec" title="Branch 1003 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1004 was not executed"> # </span><span class="branchNoExec" title="Branch 1005 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1006 was not executed"> # </span><span class="branchNoExec" title="Branch 1007 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1010 was not executed"> # </span><span class="branchNoExec" title="Branch 1011 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1013 was not executed"> # </span><span class="branchNoExec" title="Branch 1014 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1015 was not executed"> # </span><span class="branchNoExec" title="Branch 1016 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1017 was not executed"> # </span><span class="branchNoExec" title="Branch 1018 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1019 was not executed"> # </span><span class="branchNoExec" title="Branch 1020 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1021 was not executed"> # </span><span class="branchNoExec" title="Branch 1022 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1025 was not executed"> # </span><span class="branchNoExec" title="Branch 1026 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1028 was not executed"> # </span><span class="branchNoExec" title="Branch 1029 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1030 was not executed"> # </span><span class="branchNoExec" title="Branch 1031 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1032 was not executed"> # </span><span class="branchNoExec" title="Branch 1033 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1036 was not executed"> # </span><span class="branchNoExec" title="Branch 1037 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1038 was not executed"> # </span><span class="branchNoExec" title="Branch 1039 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1040 was not executed"> # </span><span class="branchNoExec" title="Branch 1041 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1044 was not executed"> # </span><span class="branchNoExec" title="Branch 1045 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1046 was not executed"> # </span><span class="branchNoExec" title="Branch 1047 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1048 was not executed"> # </span><span class="branchNoExec" title="Branch 1049 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1052 was not executed"> # </span><span class="branchNoExec" title="Branch 1053 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1054 was not executed"> # </span><span class="branchNoExec" title="Branch 1055 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1056 was not executed"> # </span><span class="branchNoExec" title="Branch 1057 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 1058 was not executed"> # </span><span class="branchNoExec" title="Branch 1059 was not executed"> # </span>][<span class="branchNoExec" title="Branch 1060 was not executed"> # </span><span class="branchNoExec" title="Branch 1061 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]
<a name="1328"><span class="lineNum">    1328 </span>                :            :                 &quot;\nImport addresses/scripts (with private or public keys, redeem script (P2SH)), optionally rescanning the blockchain from the earliest creation time of the imported scripts. Requires a new wallet backup.\n&quot;</a>
<a name="1329"><span class="lineNum">    1329 </span>                :            :                 &quot;If an address/script is imported without all of the private keys required to spend from that address, it will be watchonly. The 'watchonly' option must be set to true in this case or a warning will be returned.\n&quot;</a>
<a name="1330"><span class="lineNum">    1330 </span>                :            :                 &quot;Conversely, if all the private keys are provided and the address/script is spendable, the watchonly option must be set to false, or a warning will be returned.\n&quot;</a>
<a name="1331"><span class="lineNum">    1331 </span>                :            :             &quot;\nNote: This call can take over an hour to complete if rescan is true, during that time, other rpc calls\n&quot;</a>
<a name="1332"><span class="lineNum">    1332 </span>                :            :             &quot;may report that the imported keys, addresses or scripts exist but related transactions are still missing.\n&quot;</a>
<a name="1333"><span class="lineNum">    1333 </span>                :            :             &quot;Note: Use \&quot;getwalletinfo\&quot; to query the scanning progress.\n&quot;,</a>
<a name="1334"><span class="lineNum">    1334 </span>                :            :                 {</a>
<a name="1335"><span class="lineNum">    1335 </span>                :            :                     {&quot;requests&quot;, RPCArg::Type::ARR, RPCArg::Optional::NO, &quot;Data to be imported&quot;,</a>
<a name="1336"><span class="lineNum">    1336 </span>                :            :                         {</a>
<a name="1337"><span class="lineNum">    1337 </span>                :            :                             {&quot;&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, &quot;&quot;,</a>
<a name="1338"><span class="lineNum">    1338 </span>                :            :                                 {</a>
<a name="1339"><span class="lineNum">    1339 </span>                :            :                                     {&quot;desc&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED, &quot;Descriptor to import. If using descriptor, do not also provide address/scriptPubKey, scripts, or pubkeys&quot;},</a>
<a name="1340"><span class="lineNum">    1340 </span>                :            :                                     {&quot;scriptPubKey&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;Type of scriptPubKey (string for script, json for address). Should not be provided if using a descriptor&quot;,</a>
<a name="1341"><span class="lineNum">    1341 </span>                :            :                                         /* oneline_description */ &quot;&quot;, {&quot;\&quot;&lt;script&gt;\&quot; | { \&quot;address\&quot;:\&quot;&lt;address&gt;\&quot; }&quot;, &quot;string / json&quot;}</a>
<a name="1342"><span class="lineNum">    1342 </span>                :            :                                     },</a>
<a name="1343"><span class="lineNum">    1343 </span>                :            :                                     {&quot;timestamp&quot;, RPCArg::Type::NUM, RPCArg::Optional::NO, &quot;Creation time of the key in seconds since epoch (Jan 1 1970 GMT),\n&quot;</a>
<a name="1344"><span class="lineNum">    1344 </span>                :            :         &quot;                                                              or the string \&quot;now\&quot; to substitute the current synced blockchain time. The timestamp of the oldest\n&quot;</a>
<a name="1345"><span class="lineNum">    1345 </span>                :            :         &quot;                                                              key will determine how far back blockchain rescans need to begin for missing wallet transactions.\n&quot;</a>
<a name="1346"><span class="lineNum">    1346 </span>                :            :         &quot;                                                              \&quot;now\&quot; can be specified to bypass scanning, for keys which are known to never have been used, and\n&quot;</a>
<a name="1347"><span class="lineNum">    1347 </span>                :            :         &quot;                                                              0 can be specified to scan the entire blockchain. Blocks up to 2 hours before the earliest key\n&quot;</a>
<a name="1348"><span class="lineNum">    1348 </span>                :            :         &quot;                                                              creation time of all keys being imported by the importmulti call will be scanned.&quot;,</a>
<a name="1349"><span class="lineNum">    1349 </span>                :            :                                         /* oneline_description */ &quot;&quot;, {&quot;timestamp | \&quot;now\&quot;&quot;, &quot;integer / string&quot;}</a>
<a name="1350"><span class="lineNum">    1350 </span>                :            :                                     },</a>
<a name="1351"><span class="lineNum">    1351 </span>                :            :                                     {&quot;redeemscript&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED, &quot;Allowed only if the scriptPubKey is a P2SH or P2SH-P2WSH address/scriptPubKey&quot;},</a>
<a name="1352"><span class="lineNum">    1352 </span>                :            :                                     {&quot;witnessscript&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED, &quot;Allowed only if the scriptPubKey is a P2SH-P2WSH or P2WSH address/scriptPubKey&quot;},</a>
<a name="1353"><span class="lineNum">    1353 </span>                :            :                                     {&quot;pubkeys&quot;, RPCArg::Type::ARR, /* default */ &quot;empty array&quot;, &quot;Array of strings giving pubkeys to import. They must occur in P2PKH or P2WPKH scripts. They are not required when the private key is also provided (see the \&quot;keys\&quot; argument).&quot;,</a>
<a name="1354"><span class="lineNum">    1354 </span>                :            :                                         {</a>
<a name="1355"><span class="lineNum">    1355 </span>                :            :                                             {&quot;pubKey&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED, &quot;&quot;},</a>
<a name="1356"><span class="lineNum">    1356 </span>                :            :                                         }</a>
<a name="1357"><span class="lineNum">    1357 </span>                :            :                                     },</a>
<a name="1358"><span class="lineNum">    1358 </span>                :            :                                     {&quot;keys&quot;, RPCArg::Type::ARR, /* default */ &quot;empty array&quot;, &quot;Array of strings giving private keys to import. The corresponding public keys must occur in the output or redeemscript.&quot;,</a>
<a name="1359"><span class="lineNum">    1359 </span>                :            :                                         {</a>
<a name="1360"><span class="lineNum">    1360 </span>                :            :                                             {&quot;key&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED, &quot;&quot;},</a>
<a name="1361"><span class="lineNum">    1361 </span>                :            :                                         }</a>
<a name="1362"><span class="lineNum">    1362 </span>                :            :                                     },</a>
<a name="1363"><span class="lineNum">    1363 </span>                :            :                                     {&quot;range&quot;, RPCArg::Type::RANGE, RPCArg::Optional::OMITTED, &quot;If a ranged descriptor is used, this specifies the end or the range (in the form [begin,end]) to import&quot;},</a>
<a name="1364"><span class="lineNum">    1364 </span>                :            :                                     {&quot;internal&quot;, RPCArg::Type::BOOL, /* default */ &quot;false&quot;, &quot;Stating whether matching outputs should be treated as not incoming payments (also known as change)&quot;},</a>
<a name="1365"><span class="lineNum">    1365 </span>                :            :                                     {&quot;watchonly&quot;, RPCArg::Type::BOOL, /* default */ &quot;false&quot;, &quot;Stating whether matching outputs should be considered watchonly.&quot;},</a>
<a name="1366"><span class="lineNum">    1366 </span>                :            :                                     {&quot;label&quot;, RPCArg::Type::STR, /* default */ &quot;''&quot;, &quot;Label to assign to the address, only allowed with internal=false&quot;},</a>
<a name="1367"><span class="lineNum">    1367 </span>                :            :                                     {&quot;keypool&quot;, RPCArg::Type::BOOL, /* default */ &quot;false&quot;, &quot;Stating whether imported public keys should be added to the keypool for when users request new addresses. Only allowed when wallet private keys are disabled&quot;},</a>
<a name="1368"><span class="lineNum">    1368 </span>                :            :                                 },</a>
<a name="1369"><span class="lineNum">    1369 </span>                :            :                             },</a>
<a name="1370"><span class="lineNum">    1370 </span>                :            :                         },</a>
<a name="1371"><span class="lineNum">    1371 </span>                :            :                         &quot;\&quot;requests\&quot;&quot;},</a>
<a name="1372"><span class="lineNum">    1372 </span>                :            :                     {&quot;options&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;&quot;,</a>
<a name="1373"><span class="lineNum">    1373 </span>                :            :                         {</a>
<a name="1374"><span class="lineNum">    1374 </span>                :            :                             {&quot;rescan&quot;, RPCArg::Type::BOOL, /* default */ &quot;true&quot;, &quot;Stating if should rescan the blockchain after all imports&quot;},</a>
<a name="1375"><span class="lineNum">    1375 </span>                :            :                         },</a>
<a name="1376"><span class="lineNum">    1376 </span>                :            :                         &quot;\&quot;options\&quot;&quot;},</a>
<a name="1377"><span class="lineNum">    1377 </span>                :            :                 },</a>
<a name="1378"><span class="lineNum">    1378 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          9 :                 RPCResult{</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 8 was not taken"> - </span><span class="branchCov" title="Branch 9 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>]
<a name="1379"><span class="lineNum">    1379 </span>                :            :             &quot;\nResponse is an array with the same size as the input that has the execution result :\n&quot;</a>
<a name="1380"><span class="lineNum">    1380 </span>                :            :             &quot;  [{\&quot;success\&quot;: true}, {\&quot;success\&quot;: true, \&quot;warnings\&quot;: [\&quot;Ignoring irrelevant private key\&quot;]}, {\&quot;success\&quot;: false, \&quot;error\&quot;: {\&quot;code\&quot;: -1, \&quot;message\&quot;: \&quot;Internal Server Error\&quot;}}, ...]\n&quot;</a>
<a name="1381"><span class="lineNum">    1381 </span>                :            :                 },</a>
<a name="1382"><span class="lineNum">    1382 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">          9 :                 RPCExamples{</span></a>
<span class="lineNum">         </span>  [<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="1383"><span class="lineNum">    1383 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         12 :                     HelpExampleCli(&quot;importmulti&quot;, &quot;'[{ \&quot;scriptPubKey\&quot;: { \&quot;address\&quot;: \&quot;&lt;my address&gt;\&quot; }, \&quot;timestamp\&quot;:1455191478 }, &quot;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 17 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 21 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>][<span class="branchNoExec" title="Branch 23 was not executed"> # </span><span class="branchNoExec" title="Branch 24 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>][<span class="branchNoExec" title="Branch 27 was not executed"> # </span><span class="branchNoExec" title="Branch 28 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 29 was not executed"> # </span><span class="branchNoExec" title="Branch 30 was not executed"> # </span>][<span class="branchNoExec" title="Branch 31 was not executed"> # </span><span class="branchNoExec" title="Branch 32 was not executed"> # </span>]
<a name="1384"><span class="lineNum">    1384 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoCov" title="Branch 3 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 3 times"> + </span>]:<span class="lineCov">          6 :                                           &quot;{ \&quot;scriptPubKey\&quot;: { \&quot;address\&quot;: \&quot;&lt;my 2nd address&gt;\&quot; }, \&quot;label\&quot;: \&quot;example 2\&quot;, \&quot;timestamp\&quot;: 1455191480 }]'&quot;) +</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3 times"> + </span>][<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="1385"><span class="lineNum">    1385 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         18 :                     HelpExampleCli(&quot;importmulti&quot;, &quot;'[{ \&quot;scriptPubKey\&quot;: { \&quot;address\&quot;: \&quot;&lt;my address&gt;\&quot; }, \&quot;timestamp\&quot;:1455191478 }]' '{ \&quot;rescan\&quot;: false}'&quot;)</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 15 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 3 times"> + </span>][<span class="branchCov" title="Branch 19 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 21 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span>][<span class="branchNoExec" title="Branch 25 was not executed"> # </span><span class="branchNoExec" title="Branch 26 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 27 was not executed"> # </span><span class="branchNoExec" title="Branch 28 was not executed"> # </span>][<span class="branchNoExec" title="Branch 29 was not executed"> # </span><span class="branchNoExec" title="Branch 30 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 31 was not executed"> # </span><span class="branchNoExec" title="Branch 32 was not executed"> # </span>]
<a name="1386"><span class="lineNum">    1386 </span>                :            :                 },</a>
<a name="1387"><span class="lineNum">    1387 </span>[<span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         75 :             }.ToString()</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 12 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span>][<span class="branchCov" title="Branch 14 was taken 3 times"> + </span><span class="branchCov" title="Branch 15 was taken 3 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>][<span class="branchNoExec" title="Branch 24 was not executed"> # </span><span class="branchNoExec" title="Branch 25 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 26 was not executed"> # </span><span class="branchNoExec" title="Branch 27 was not executed"> # </span>]
<a name="1388"><span class="lineNum">    1388 </span>[<span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>][<span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]:<span class="lineCov">          9 :         );</span></a>
<a name="1389"><span class="lineNum">    1389 </span>                :            : </a>
<a name="1390"><span class="lineNum">    1390 </span>                :            : </a>
<a name="1391"><span class="lineNum">    1391 </span>[<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        376 :     RPCTypeCheck(mainRequest.params, {UniValue::VARR, UniValue::VOBJ});</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 13 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>][<span class="branchCov" title="Branch 17 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span>]
<a name="1392"><span class="lineNum">    1392 </span>                :            : </a>
<a name="1393"><span class="lineNum">    1393 </span>        [<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         94 :     const UniValue&amp; requests = mainRequest.params[0];</span></a>
<a name="1394"><span class="lineNum">    1394 </span>                :            : </a>
<a name="1395"><span class="lineNum">    1395 </span>                :            :     //Default options</a>
<a name="1396"><span class="lineNum">    1396 </span>                :<span class="lineCov">         94 :     bool fRescan = true;</span></a>
<a name="1397"><span class="lineNum">    1397 </span>                :            : </a>
<a name="1398"><span class="lineNum">    1398 </span>[<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 36 times"> + </span><span class="branchCov" title="Branch 4 was taken 58 times"> + </span>]:<span class="lineCov">         94 :     if (!mainRequest.params[1].isNull()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 36 times"> + </span><span class="branchCov" title="Branch 6 was taken 58 times"> + </span>]
<a name="1399"><span class="lineNum">    1399 </span>        [<span class="branchCov" title="Branch 1 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         36 :         const UniValue&amp; options = mainRequest.params[1];</span></a>
<a name="1400"><span class="lineNum">    1400 </span>                :            : </a>
<a name="1401"><span class="lineNum">    1401 </span>[<span class="branchCov" title="Branch 1 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         72 :         if (options.exists(&quot;rescan&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 36 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>][<span class="branchCov" title="Branch 13 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 15 was not executed"> # </span><span class="branchNoExec" title="Branch 16 was not executed"> # </span>]
<a name="1402"><span class="lineNum">    1402 </span>[<span class="branchCov" title="Branch 1 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         72 :             fRescan = options[&quot;rescan&quot;].get_bool();</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 36 times"> + </span>][<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1403"><span class="lineNum">    1403 </span>                :            :         }</a>
<a name="1404"><span class="lineNum">    1404 </span>                :            :     }</a>
<a name="1405"><span class="lineNum">    1405 </span>                :            : </a>
<a name="1406"><span class="lineNum">    1406 </span>        [<span class="branchCov" title="Branch 0 was taken 82 times"> + </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>]:<span class="lineCov">        188 :     WalletRescanReserver reserver(pwallet);</span></a>
<a name="1407"><span class="lineNum">    1407 </span>[<span class="branchCov" title="Branch 0 was taken 82 times"> + </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         94 :     if (fRescan &amp;&amp; !reserver.reserve()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="1408"><span class="lineNum">    1408 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Wallet is currently rescanning. Abort existing rescan or wait.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1409"><span class="lineNum">    1409 </span>                :            :     }</a>
<a name="1410"><span class="lineNum">    1410 </span>                :            : </a>
<a name="1411"><span class="lineNum">    1411 </span>                :<span class="lineCov">         94 :     int64_t now = 0;</span></a>
<a name="1412"><span class="lineNum">    1412 </span>                :<span class="lineCov">         94 :     bool fRunScan = false;</span></a>
<a name="1413"><span class="lineNum">    1413 </span>                :<span class="lineCov">         94 :     int64_t nLowestTimestamp = 0;</span></a>
<a name="1414"><span class="lineNum">    1414 </span>[<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        282 :     UniValue response(UniValue::VARR);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="1415"><span class="lineNum">    1415 </span>                :<span class="lineCov">         94 :     {</span></a>
<a name="1416"><span class="lineNum">    1416 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 94 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         98 :         auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>]
<a name="1417"><span class="lineNum">    1417 </span>[<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        282 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 7 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="1418"><span class="lineNum">    1418 </span>        [<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         94 :         EnsureWalletIsUnlocked(pwallet);</span></a>
<a name="1419"><span class="lineNum">    1419 </span>                :            : </a>
<a name="1420"><span class="lineNum">    1420 </span>                :            :         // Verify all timestamps are present before importing any keys.</a>
<a name="1421"><span class="lineNum">    1421 </span>[<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        188 :         const Optional&lt;int&gt; tip_height = locked_chain-&gt;getHeight();</span></a>
<a name="1422"><span class="lineNum">    1422 </span>[<span class="branchCov" title="Branch 0 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        188 :         now = tip_height ? locked_chain-&gt;getBlockMedianTimePast(*tip_height) : 0;</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchCov" title="Branch 8 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 11 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>]
<a name="1423"><span class="lineNum">    1423 </span>[<span class="branchCov" title="Branch 1 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 97 times"> + </span><span class="branchCov" title="Branch 4 was taken 92 times"> + </span>]:<span class="lineCov">        189 :         for (const UniValue&amp; data : requests.getValues()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 97 times"> + </span><span class="branchCov" title="Branch 6 was taken 92 times"> + </span>]
<a name="1424"><span class="lineNum">    1424 </span>        [<span class="branchCov" title="Branch 1 was taken 95 times"> + </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span>]:<span class="lineCov">         97 :             GetImportTimestamp(data, now);</span></a>
<a name="1425"><span class="lineNum">    1425 </span>                :            :         }</a>
<a name="1426"><span class="lineNum">    1426 </span>                :            : </a>
<a name="1427"><span class="lineNum">    1427 </span>                :<span class="lineCov">         92 :         const int64_t minimumTimestamp = 1;</span></a>
<a name="1428"><span class="lineNum">    1428 </span>                :            : </a>
<a name="1429"><span class="lineNum">    1429 </span>[<span class="branchCov" title="Branch 0 was taken 80 times"> + </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 80 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         92 :         if (fRescan &amp;&amp; tip_height) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 4 was taken 80 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1430"><span class="lineNum">    1430 </span>[<span class="branchCov" title="Branch 1 was taken 80 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 80 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        240 :             nLowestTimestamp = locked_chain-&gt;getBlockTime(*tip_height);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 80 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="1431"><span class="lineNum">    1431 </span>                :            :         } else {</a>
<a name="1432"><span class="lineNum">    1432 </span>                :            :             fRescan = false;</a>
<a name="1433"><span class="lineNum">    1433 </span>                :            :         }</a>
<a name="1434"><span class="lineNum">    1434 </span>                :            : </a>
<a name="1435"><span class="lineNum">    1435 </span>[<span class="branchCov" title="Branch 1 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 95 times"> + </span><span class="branchCov" title="Branch 4 was taken 92 times"> + </span>]:<span class="lineCov">        187 :         for (const UniValue&amp; data : requests.getValues()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 95 times"> + </span><span class="branchCov" title="Branch 6 was taken 92 times"> + </span>]
<a name="1436"><span class="lineNum">    1436 </span>[<span class="branchCov" title="Branch 1 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1 time"> + </span><span class="branchCov" title="Branch 4 was taken 94 times"> + </span>]:<span class="lineCov">         95 :             const int64_t timestamp = std::max(GetImportTimestamp(data, now), minimumTimestamp);</span></a>
<a name="1437"><span class="lineNum">    1437 </span>        [<span class="branchCov" title="Branch 1 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        178 :             const UniValue result = ProcessImport(pwallet, data, timestamp);</span></a>
<a name="1438"><span class="lineNum">    1438 </span>        [<span class="branchCov" title="Branch 1 was taken 95 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         95 :             response.push_back(result);</span></a>
<a name="1439"><span class="lineNum">    1439 </span>                :            : </a>
<a name="1440"><span class="lineNum">    1440 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 83 times"> + </span>]:<span class="lineCov">         95 :             if (!fRescan) {</span></a>
<a name="1441"><span class="lineNum">    1441 </span>                :<span class="lineCov">         12 :                 continue;</span></a>
<a name="1442"><span class="lineNum">    1442 </span>                :            :             }</a>
<a name="1443"><span class="lineNum">    1443 </span>                :            : </a>
<a name="1444"><span class="lineNum">    1444 </span>                :            :             // If at least one request was successful then allow rescan.</a>
<a name="1445"><span class="lineNum">    1445 </span>[<span class="branchCov" title="Branch 1 was taken 83 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 83 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        166 :             if (result[&quot;success&quot;].get_bool()) {</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 83 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 83 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 83 times"> + </span>][<span class="branchCov" title="Branch 14 was taken 65 times"> + </span><span class="branchCov" title="Branch 15 was taken 18 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 16 was taken 65 times"> + </span><span class="branchCov" title="Branch 17 was taken 18 times"> + </span>][<span class="branchNoExec" title="Branch 18 was not executed"> # </span><span class="branchNoExec" title="Branch 19 was not executed"> # </span>]
<a name="1446"><span class="lineNum">    1446 </span>                :<span class="lineCov">         65 :                 fRunScan = true;</span></a>
<a name="1447"><span class="lineNum">    1447 </span>                :            :             }</a>
<a name="1448"><span class="lineNum">    1448 </span>                :            : </a>
<a name="1449"><span class="lineNum">    1449 </span>                :            :             // Get the lowest timestamp.</a>
<a name="1450"><span class="lineNum">    1450 </span>        [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchCov" title="Branch 1 was taken 31 times"> + </span>]:<span class="lineCov">         83 :             if (timestamp &lt; nLowestTimestamp) {</span></a>
<a name="1451"><span class="lineNum">    1451 </span>                :<span class="lineCov">         52 :                 nLowestTimestamp = timestamp;</span></a>
<a name="1452"><span class="lineNum">    1452 </span>                :            :             }</a>
<a name="1453"><span class="lineNum">    1453 </span>                :            :         }</a>
<a name="1454"><span class="lineNum">    1454 </span>                :            :     }</a>
<a name="1455"><span class="lineNum">    1455 </span>[<span class="branchCov" title="Branch 0 was taken 62 times"> + </span><span class="branchCov" title="Branch 1 was taken 30 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         92 :     if (fRescan &amp;&amp; fRunScan &amp;&amp; requests.size()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 4 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1456"><span class="lineNum">    1456 </span>        [<span class="branchCov" title="Branch 1 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         62 :         int64_t scannedTime = pwallet-&gt;RescanFromTime(nLowestTimestamp, reserver, true /* update */);</span></a>
<a name="1457"><span class="lineNum">    1457 </span>                :<span class="lineCov">         62 :         {</span></a>
<a name="1458"><span class="lineNum">    1458 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 62 times"> + </span>][<span class="branchCov" title="Branch 3 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">         62 :             auto locked_chain = pwallet-&gt;chain().lock();</span></a>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]
<a name="1459"><span class="lineNum">    1459 </span>[<span class="branchCov" title="Branch 1 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">        186 :             LOCK(pwallet-&gt;cs_wallet);</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<a name="1460"><span class="lineNum">    1460 </span>[<span class="branchCov" title="Branch 1 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        124 :             pwallet-&gt;ReacceptWalletTransactions(*locked_chain);</span></a>
<a name="1461"><span class="lineNum">    1461 </span>                :            :         }</a>
<a name="1462"><span class="lineNum">    1462 </span>                :            : </a>
<a name="1463"><span class="lineNum">    1463 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 62 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 62 times"> + </span>]:<span class="lineCov">        124 :         if (pwallet-&gt;IsAbortingRescan()) {</span></a>
<a name="1464"><span class="lineNum">    1464 </span>  [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_MISC_ERROR, &quot;Rescan aborted by user.&quot;);</span></a>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 8 was not executed"> # </span><span class="branchNoExec" title="Branch 9 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 14 was not executed"> # </span><span class="branchNoExec" title="Branch 15 was not executed"> # </span>]
<a name="1465"><span class="lineNum">    1465 </span>                :            :         }</a>
<a name="1466"><span class="lineNum">    1466 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 61 times"> + </span>]:<span class="lineCov">         62 :         if (scannedTime &gt; nLowestTimestamp) {</span></a>
<a name="1467"><span class="lineNum">    1467 </span>[<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          2 :             std::vector&lt;UniValue&gt; results = response.getValues();</span></a>
<a name="1468"><span class="lineNum">    1468 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :             response.clear();</span></a>
<a name="1469"><span class="lineNum">    1469 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :             response.setArray();</span></a>
<a name="1470"><span class="lineNum">    1470 </span>                :<span class="lineCov">          1 :             size_t i = 0;</span></a>
<a name="1471"><span class="lineNum">    1471 </span>[<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 2 times"> + </span><span class="branchCov" title="Branch 4 was taken 1 time"> + </span>]:<span class="lineCov">          5 :             for (const UniValue&amp; request : requests.getValues()) {</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 5 was taken 2 times"> + </span><span class="branchCov" title="Branch 6 was taken 1 time"> + </span>]
<a name="1472"><span class="lineNum">    1472 </span>                :            :                 // If key creation date is within the successfully scanned</a>
<a name="1473"><span class="lineNum">    1473 </span>                :            :                 // range, or if the import result already has an error set, let</a>
<a name="1474"><span class="lineNum">    1474 </span>                :            :                 // the result stand unmodified. Otherwise replace the result</a>
<a name="1475"><span class="lineNum">    1475 </span>                :            :                 // with an error message.</a>
<a name="1476"><span class="lineNum">    1476 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 3 was taken 1 time"> + </span><span class="branchCov" title="Branch 4 was taken 1 time"> + </span>]:<span class="lineCov">          3 :                 if (scannedTime &lt;= GetImportTimestamp(request, now) || results.at(i).exists(&quot;error&quot;)) {</span></a>
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1 time"> + </span>][<span class="branchCov" title="Branch 8 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 11 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span>][<span class="branchCov" title="Branch 14 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchCov" title="Branch 17 was taken 1 time"> + </span>][<span class="branchCov" title="Branch 18 was taken 1 time"> + </span><span class="branchCov" title="Branch 19 was taken 1 time"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchCov" title="Branch 21 was taken 1 time"> + </span>][<span class="branchCov" title="Branch 22 was taken 1 time"> + </span><span class="branchCov" title="Branch 23 was taken 1 time"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 24 was not executed"> # </span><span class="branchNoExec" title="Branch 25 was not executed"> # </span>][<span class="branchNoExec" title="Branch 26 was not executed"> # </span><span class="branchNoExec" title="Branch 27 was not executed"> # </span>]
<a name="1477"><span class="lineNum">    1477 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>][<span class="branchCov" title="Branch 3 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span>]:<span class="lineCov">          1 :                     response.push_back(results.at(i));</span></a>
<a name="1478"><span class="lineNum">    1478 </span>                :            :                 } else {</a>
<a name="1479"><span class="lineNum">    1479 </span>[<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          3 :                     UniValue result = UniValue(UniValue::VOBJ);</span></a>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 7 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>]
<a name="1480"><span class="lineNum">    1480 </span>[<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          1 :                     result.pushKV(&quot;success&quot;, UniValue(false));</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 1 time"> + </span>][<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<a name="1481"><span class="lineNum">    1481 </span>[<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">          2 :                     result.pushKV(</span></a>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1 time"> + </span>]
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>]
<a name="1482"><span class="lineNum">    1482 </span>                :            :                         &quot;error&quot;,</a>
<a name="1483"><span class="lineNum">    1483 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          2 :                         JSONRPCError(</span></a>
<a name="1484"><span class="lineNum">    1484 </span>                :            :                             RPC_MISC_ERROR,</a>
<a name="1485"><span class="lineNum">    1485 </span>[<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>][<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          1 :                             strprintf(&quot;Rescan failed for key with creation timestamp %d. There was an error reading a &quot;</span></a>
<a name="1486"><span class="lineNum">    1486 </span>                :            :                                       &quot;block from time %d, which is after or within %d seconds of key creation, and &quot;</a>
<a name="1487"><span class="lineNum">    1487 </span>                :            :                                       &quot;could contain transactions pertaining to the key. As a result, transactions &quot;</a>
<a name="1488"><span class="lineNum">    1488 </span>                :            :                                       &quot;and coins using this key may not appear in the wallet. This error could be &quot;</a>
<a name="1489"><span class="lineNum">    1489 </span>                :            :                                       &quot;caused by pruning or data corruption (see bitcoind log for details) and could &quot;</a>
<a name="1490"><span class="lineNum">    1490 </span>                :            :                                       &quot;be dealt with by downloading and rescanning the relevant blocks (see -reindex &quot;</a>
<a name="1491"><span class="lineNum">    1491 </span>                :            :                                       &quot;and -rescan options).&quot;,</a>
<a name="1492"><span class="lineNum">    1492 </span>[<span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>][<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :                                 GetImportTimestamp(request, now), scannedTime - TIMESTAMP_WINDOW - 1, TIMESTAMP_WINDOW)));</span></a>
<a name="1493"><span class="lineNum">    1493 </span>        [<span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">          1 :                     response.push_back(std::move(result));</span></a>
<a name="1494"><span class="lineNum">    1494 </span>                :            :                 }</a>
<a name="1495"><span class="lineNum">    1495 </span>                :<span class="lineCov">          2 :                 ++i;</span></a>
<a name="1496"><span class="lineNum">    1496 </span>                :            :             }</a>
<a name="1497"><span class="lineNum">    1497 </span>                :            :         }</a>
<a name="1498"><span class="lineNum">    1498 </span>                :            :     }</a>
<a name="1499"><span class="lineNum">    1499 </span>                :            : </a>
<a name="1500"><span class="lineNum">    1500 </span>        [<span class="branchCov" title="Branch 1 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">         92 :     return response;</span></a>
<a name="1501"><span class="lineNum">    1501 </span>                :            : }</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.14</a></td></tr>
  </table>
  <br>

</body>
</html>
